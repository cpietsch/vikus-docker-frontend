import{S as De,i as Pe,s as Ne,e as r,t as D,k,c as o,a as d,h as P,d as l,m as I,b as s,f as et,g as W,H as e,j as ee,W as X,O as Z,X as Y,E as re,T as Ae,w as je,x as Ue,y as Le,q as Be,o as ze,B as Oe,Y as zt}from"../../chunks/index-ce9f2381.js";import{b as ve,p as pt,d as Re,c as mt,a as Vt}from"../../chunks/api-c29a56c8.js";import{g as Ot}from"../../chunks/navigation-0e6511d1.js";import{b as Rt}from"../../chunks/paths-396f020f.js";import"../../chunks/singletons-d1fb5791.js";function jt(n){let t,a,b,f,i=n[0].completed+"",p,S,g=n[0].size+"",c,E,m,v,N=parseInt(n[0].progress*100)+"",y,x,h,_,T;return{c(){t=r("div"),a=r("div"),b=r("div"),f=r("span"),p=D(i),S=D("/"),c=D(g),E=k(),m=r("div"),v=r("span"),y=D(N),x=D("%"),h=k(),_=r("div"),T=r("div"),this.h()},l(w){t=o(w,"DIV",{class:!0});var A=d(t);a=o(A,"DIV",{class:!0});var V=d(a);b=o(V,"DIV",{});var F=d(b);f=o(F,"SPAN",{class:!0});var z=d(f);p=P(z,i),S=P(z,"/"),c=P(z,g),z.forEach(l),F.forEach(l),E=I(V),m=o(V,"DIV",{class:!0});var U=d(m);v=o(U,"SPAN",{class:!0});var j=d(v);y=P(j,N),x=P(j,"%"),j.forEach(l),U.forEach(l),V.forEach(l),h=I(A),_=o(A,"DIV",{class:!0});var B=d(_);T=o(B,"DIV",{style:!0,class:!0}),d(T).forEach(l),B.forEach(l),A.forEach(l),this.h()},h(){s(f,"class","text-xs font-semibold inline-block py-1 px-2 uppercase rounded-full text-green-600 bg-green-200"),s(v,"class","text-xs font-semibold inline-block text-green-600"),s(m,"class","text-right"),s(a,"class","flex mb-2 items-center justify-between"),et(T,"width",parseInt(n[0].progress*100)+"%"),s(T,"class","shadow-none flex flex-col text-center whitespace-nowrap text-white justify-center bg-green-500"),s(_,"class","overflow-hidden h-2 mb-4 text-xs flex rounded bg-green-200"),s(t,"class","relative mt-2")},m(w,A){W(w,t,A),e(t,a),e(a,b),e(b,f),e(f,p),e(f,S),e(f,c),e(a,E),e(a,m),e(m,v),e(v,y),e(v,x),e(t,h),e(t,_),e(_,T)},p(w,A){A&1&&i!==(i=w[0].completed+"")&&ee(p,i),A&1&&g!==(g=w[0].size+"")&&ee(c,g),A&1&&N!==(N=parseInt(w[0].progress*100)+"")&&ee(y,N),A&1&&et(T,"width",parseInt(w[0].progress*100)+"%")},d(w){w&&l(t)}}}function Ft(n){let t,a,b,f,i,p,S,g,c,E,m,v,N,y,x,h,_,T,w,A,V,F,z,U,j,B,H,M,C,q=n[0]&&jt(n);return{c(){t=r("div"),a=r("h1"),b=D("Collection"),f=k(),i=r("label"),p=r("span"),S=D("Manifests"),g=k(),c=r("span"),E=D(Ut),m=k(),v=r("label"),N=r("span"),y=D("Worker"),x=k(),h=r("input"),_=k(),T=r("label"),w=r("span"),A=D("Crawl depth"),V=k(),F=r("input"),z=k(),q&&q.c(),U=k(),j=r("button"),B=D("Run"),this.h()},l(O){t=o(O,"DIV",{class:!0});var R=d(t);a=o(R,"H1",{class:!0});var J=d(a);b=P(J,"Collection"),J.forEach(l),f=I(R),i=o(R,"LABEL",{class:!0});var te=d(i);p=o(te,"SPAN",{class:!0});var $=d(p);S=P($,"Manifests"),$.forEach(l),g=I(te),c=o(te,"SPAN",{});var se=d(c);E=P(se,Ut),se.forEach(l),te.forEach(l),m=I(R),v=o(R,"LABEL",{class:!0});var ae=d(v);N=o(ae,"SPAN",{class:!0});var ke=d(N);y=P(ke,"Worker"),ke.forEach(l),x=I(ae),h=o(ae,"INPUT",{type:!0,min:!0,max:!0,class:!0}),ae.forEach(l),_=I(R),T=o(R,"LABEL",{class:!0});var le=d(T);w=o(le,"SPAN",{class:!0});var ne=d(w);A=P(ne,"Crawl depth"),ne.forEach(l),V=I(le),F=o(le,"INPUT",{type:!0,min:!0,max:!0,class:!0}),le.forEach(l),z=I(R),q&&q.l(R),U=I(R),j=o(R,"BUTTON",{class:!0});var ie=d(j);B=P(ie,"Run"),ie.forEach(l),R.forEach(l),this.h()},h(){s(a,"class","mb-6"),s(p,"class","w-32"),s(i,"class","flex items-center pb-2 mb-2 text-sm space-x-12 md:space-x-24 justify-between border-b border-gray-200 dark:border-slate-600"),s(N,"class","w-32"),s(h,"type","number"),s(h,"min","1"),s(h,"max","1000"),s(h,"class","rounded-lg flex-auto p-2 mr-1 border-2 border-gray-300"),h.required=!0,s(v,"class","flex items-center pb-2 mb-2 text-sm space-x-12 md:space-x-24 justify-between border-b border-gray-200 dark:border-slate-600"),s(w,"class","w-32"),s(F,"type","number"),s(F,"min","0"),s(F,"max","1000"),s(F,"class","rounded-lg flex-auto p-2 mr-1 border-2 border-gray-300"),F.required=!0,s(T,"class","flex items-center pb-2 mb-2 text-sm space-x-12 md:space-x-24 justify-between border-b border-gray-200 dark:border-slate-600"),s(j,"class","py-2 px-3 w-40 self-end bg-cyan-500 text-white text-sm font-semibold rounded-md shadow-lg hover:shadow-cyan-500/50 focus:outline-none"),s(t,"class",H="flex shadow-xl rounded-xl p-8 bg-white dark:bg-slate-800 flex-col mt-4 "+(n[3]&&"grayscale pointer-events-none"))},m(O,R){W(O,t,R),e(t,a),e(a,b),e(t,f),e(t,i),e(i,p),e(p,S),e(i,g),e(i,c),e(c,E),e(t,m),e(t,v),e(v,N),e(N,y),e(v,x),e(v,h),X(h,n[2]),e(t,_),e(t,T),e(T,w),e(w,A),e(T,V),e(T,F),X(F,n[1]),e(t,z),q&&q.m(t,null),e(t,U),e(t,j),e(j,B),M||(C=[Z(h,"input",n[6]),Z(F,"input",n[7]),Z(j,"click",n[4])],M=!0)},p(O,[R]){R&4&&Y(h.value)!==O[2]&&X(h,O[2]),R&2&&Y(F.value)!==O[1]&&X(F,O[1]),O[0]?q?q.p(O,R):(q=jt(O),q.c(),q.m(t,U)):q&&(q.d(1),q=null),R&8&&H!==(H="flex shadow-xl rounded-xl p-8 bg-white dark:bg-slate-800 flex-col mt-4 "+(O[3]&&"grayscale pointer-events-none"))&&s(t,"class",H)},i:re,o:re,d(O){O&&l(t),q&&q.d(),M=!1,Ae(C)}}}let Ut=0;function Mt(n,t,a){let{instance:b}=t,{progress:f={queue:0,progress:0,completed:0,size:0}}=t,i=0,p=4,S=!1;const g=async()=>{a(3,S=!0);const v=await(await ve("POST","instances/crawlCollection",null,{instance_id:b.id,worker:p,depth:i})).json();console.log(v),a(3,S=!1)};function c(){p=Y(this.value),a(2,p)}function E(){i=Y(this.value),a(1,i)}return n.$$set=m=>{"instance"in m&&a(5,b=m.instance),"progress"in m&&a(0,f=m.progress)},[f,i,p,S,g,b,c,E]}class Ct extends De{constructor(t){super(),Pe(this,t,Mt,Ft,Ne,{instance:5,progress:0})}}function Lt(n){let t,a,b,f,i=n[0].completed+"",p,S,g=n[0].size+"",c,E,m,v,N=parseInt(n[0].progress*100)+"",y,x,h,_,T;return{c(){t=r("div"),a=r("div"),b=r("div"),f=r("span"),p=D(i),S=D("/"),c=D(g),E=k(),m=r("div"),v=r("span"),y=D(N),x=D("%"),h=k(),_=r("div"),T=r("div"),this.h()},l(w){t=o(w,"DIV",{class:!0});var A=d(t);a=o(A,"DIV",{class:!0});var V=d(a);b=o(V,"DIV",{});var F=d(b);f=o(F,"SPAN",{class:!0});var z=d(f);p=P(z,i),S=P(z,"/"),c=P(z,g),z.forEach(l),F.forEach(l),E=I(V),m=o(V,"DIV",{class:!0});var U=d(m);v=o(U,"SPAN",{class:!0});var j=d(v);y=P(j,N),x=P(j,"%"),j.forEach(l),U.forEach(l),V.forEach(l),h=I(A),_=o(A,"DIV",{class:!0});var B=d(_);T=o(B,"DIV",{style:!0,class:!0}),d(T).forEach(l),B.forEach(l),A.forEach(l),this.h()},h(){s(f,"class","text-xs font-semibold inline-block py-1 px-2 uppercase rounded-full text-green-600 bg-green-200"),s(v,"class","text-xs font-semibold inline-block text-green-600"),s(m,"class","text-right"),s(a,"class","flex mb-2 items-center justify-between"),et(T,"width",parseInt(n[0].progress*100)+"%"),s(T,"class","shadow-none flex flex-col text-center whitespace-nowrap text-white justify-center bg-green-500"),s(_,"class","overflow-hidden h-2 mb-4 text-xs flex rounded bg-green-200"),s(t,"class","relative mt-2")},m(w,A){W(w,t,A),e(t,a),e(a,b),e(b,f),e(f,p),e(f,S),e(f,c),e(a,E),e(a,m),e(m,v),e(v,y),e(v,x),e(t,h),e(t,_),e(_,T)},p(w,A){A&1&&i!==(i=w[0].completed+"")&&ee(p,i),A&1&&g!==(g=w[0].size+"")&&ee(c,g),A&1&&N!==(N=parseInt(w[0].progress*100)+"")&&ee(y,N),A&1&&et(T,"width",parseInt(w[0].progress*100)+"%")},d(w){w&&l(t)}}}function qt(n){let t,a,b,f,i,p,S,g,c,E,m,v,N,y,x,h,_,T,w,A,V,F,z,U=n[0]&&Lt(n);return{c(){t=r("div"),a=r("h1"),b=D("Images"),f=k(),i=r("label"),p=r("span"),S=D("Images"),g=k(),c=r("span"),E=D(Bt),m=k(),v=r("label"),N=r("span"),y=D("Worker"),x=k(),h=r("input"),_=k(),U&&U.c(),T=k(),w=r("button"),A=D("Run"),this.h()},l(j){t=o(j,"DIV",{class:!0});var B=d(t);a=o(B,"H1",{class:!0});var H=d(a);b=P(H,"Images"),H.forEach(l),f=I(B),i=o(B,"LABEL",{class:!0});var M=d(i);p=o(M,"SPAN",{class:!0});var C=d(p);S=P(C,"Images"),C.forEach(l),g=I(M),c=o(M,"SPAN",{});var q=d(c);E=P(q,Bt),q.forEach(l),M.forEach(l),m=I(B),v=o(B,"LABEL",{class:!0});var O=d(v);N=o(O,"SPAN",{class:!0});var R=d(N);y=P(R,"Worker"),R.forEach(l),x=I(O),h=o(O,"INPUT",{type:!0,min:!0,max:!0,class:!0}),O.forEach(l),_=I(B),U&&U.l(B),T=I(B),w=o(B,"BUTTON",{class:!0});var J=d(w);A=P(J,"Run"),J.forEach(l),B.forEach(l),this.h()},h(){s(a,"class","mb-6"),s(p,"class","w-32"),s(i,"class","flex items-center pb-2 mb-2 text-sm space-x-12 md:space-x-24 justify-between border-b border-gray-200 dark:border-slate-600"),s(N,"class","w-32"),s(h,"type","number"),s(h,"min","1"),s(h,"max","1000"),s(h,"class","rounded-lg flex-auto p-2 mr-1 border-2 border-gray-300"),h.required=!0,s(v,"class","flex items-center pb-2 mb-2 text-sm space-x-12 md:space-x-24 justify-between border-b border-gray-200 dark:border-slate-600"),s(w,"class","py-2 px-3 w-40 self-end bg-cyan-500 text-white text-sm font-semibold rounded-md shadow-lg hover:shadow-cyan-500/50 focus:outline-none"),s(t,"class",V="flex shadow-xl rounded-xl p-8 bg-white dark:bg-slate-800 flex-col mt-4 "+(n[2]&&"grayscale pointer-events-none"))},m(j,B){W(j,t,B),e(t,a),e(a,b),e(t,f),e(t,i),e(i,p),e(p,S),e(i,g),e(i,c),e(c,E),e(t,m),e(t,v),e(v,N),e(N,y),e(v,x),e(v,h),X(h,n[1]),e(t,_),U&&U.m(t,null),e(t,T),e(t,w),e(w,A),F||(z=[Z(h,"input",n[5]),Z(w,"click",n[3])],F=!0)},p(j,[B]){B&2&&Y(h.value)!==j[1]&&X(h,j[1]),j[0]?U?U.p(j,B):(U=Lt(j),U.c(),U.m(t,T)):U&&(U.d(1),U=null),B&4&&V!==(V="flex shadow-xl rounded-xl p-8 bg-white dark:bg-slate-800 flex-col mt-4 "+(j[2]&&"grayscale pointer-events-none"))&&s(t,"class",V)},i:re,o:re,d(j){j&&l(t),U&&U.d(),F=!1,Ae(z)}}}let Bt=0;function Ht(n,t,a){let{instance:b}=t,{progress:f={queue:0,progress:0,completed:0,size:0}}=t,i=4,p=!1;const S=async()=>{a(2,p=!0);const E=await(await ve("POST","instances/crawlImages",null,{instance_id:b.id,worker:i})).json();console.log(E),a(2,p=!1)};function g(){i=Y(this.value),a(1,i)}return n.$$set=c=>{"instance"in c&&a(4,b=c.instance),"progress"in c&&a(0,f=c.progress)},[f,i,p,S,b,g]}class Wt extends De{constructor(t){super(),Pe(this,t,Ht,qt,Ne,{instance:4,progress:0})}}function Zt(n){let t,a,b,f,i,p,S,g,c,E,m,v,N,y,x,h,_,T,w,A,V,F,z,U,j,B,H;return{c(){t=r("div"),a=r("h1"),b=D("UMAP"),f=k(),i=r("label"),p=r("span"),S=D("Neighbours"),g=k(),c=r("input"),E=k(),m=r("label"),v=r("span"),N=D("Min Distance"),y=k(),x=r("input"),h=k(),_=r("label"),T=r("span"),w=D("Raster Fairy"),A=k(),V=r("input"),F=k(),z=r("button"),U=D("Run"),this.h()},l(M){t=o(M,"DIV",{class:!0});var C=d(t);a=o(C,"H1",{class:!0});var q=d(a);b=P(q,"UMAP"),q.forEach(l),f=I(C),i=o(C,"LABEL",{class:!0});var O=d(i);p=o(O,"SPAN",{class:!0});var R=d(p);S=P(R,"Neighbours"),R.forEach(l),g=I(O),c=o(O,"INPUT",{type:!0,min:!0,max:!0,name:!0,id:!0,class:!0}),O.forEach(l),E=I(C),m=o(C,"LABEL",{class:!0});var J=d(m);v=o(J,"SPAN",{class:!0});var te=d(v);N=P(te,"Min Distance"),te.forEach(l),y=I(J),x=o(J,"INPUT",{type:!0,min:!0,max:!0,step:!0,name:!0,id:!0,class:!0}),J.forEach(l),h=I(C),_=o(C,"LABEL",{class:!0});var $=d(_);T=o($,"SPAN",{class:!0});var se=d(T);w=P(se,"Raster Fairy"),se.forEach(l),A=I($),V=o($,"INPUT",{type:!0,name:!0,id:!0,class:!0}),$.forEach(l),F=I(C),z=o(C,"BUTTON",{class:!0});var ae=d(z);U=P(ae,"Run"),ae.forEach(l),C.forEach(l),this.h()},h(){s(a,"class","mb-4"),s(p,"class","w-32"),s(c,"type","number"),s(c,"min","1"),s(c,"max","200"),s(c,"name","neighbours"),s(c,"id","neighbours"),s(c,"class","rounded-lg flex-auto p-2 mr-1 border-2 border-gray-300"),c.required=!0,s(i,"class","flex items-center pb-2 mb-2 text-sm space-x-12 md:space-x-24 justify-between border-b border-gray-200 dark:border-slate-600"),s(v,"class","w-32"),s(x,"type","number"),s(x,"min","0"),s(x,"max","1"),s(x,"step","0.01"),s(x,"name","neighbours"),s(x,"id","neighbours"),s(x,"class","rounded-lg flex-auto p-2 mr-1 border-2 border-gray-300"),x.required=!0,s(m,"class","flex items-center pb-2 mb-2 text-sm space-x-12 md:space-x-24 justify-between border-b border-gray-200 dark:border-slate-600"),s(T,"class","w-32"),s(V,"type","checkbox"),s(V,"name","rasterFairy"),s(V,"id","rasterFairy"),s(V,"class","rounded-lg flex-auto p-2 mr-1 border-2 border-gray-300"),s(_,"class","flex items-center pb-2 mb-2 text-sm space-x-12 md:space-x-24 justify-between border-b border-gray-200 dark:border-slate-600"),s(z,"class","py-2 px-3 w-40 self-end bg-cyan-500 text-white text-sm font-semibold rounded-md shadow-lg hover:shadow-cyan-500/50 focus:outline-none"),s(t,"class",j="flex shadow-xl rounded-xl p-8 bg-white dark:bg-slate-800 flex-col mt-4 "+(n[3]&&"grayscale pointer-events-none"))},m(M,C){W(M,t,C),e(t,a),e(a,b),e(t,f),e(t,i),e(i,p),e(p,S),e(i,g),e(i,c),X(c,n[0]),e(t,E),e(t,m),e(m,v),e(v,N),e(m,y),e(m,x),X(x,n[1]),e(t,h),e(t,_),e(_,T),e(T,w),e(_,A),e(_,V),V.checked=n[2],e(t,F),e(t,z),e(z,U),B||(H=[Z(c,"input",n[6]),Z(x,"input",n[7]),Z(V,"change",n[8]),Z(z,"click",n[4])],B=!0)},p(M,[C]){C&1&&Y(c.value)!==M[0]&&X(c,M[0]),C&2&&Y(x.value)!==M[1]&&X(x,M[1]),C&4&&(V.checked=M[2]),C&8&&j!==(j="flex shadow-xl rounded-xl p-8 bg-white dark:bg-slate-800 flex-col mt-4 "+(M[3]&&"grayscale pointer-events-none"))&&s(t,"class",j)},i:re,o:re,d(M){M&&l(t),B=!1,Ae(H)}}}function $t(n,t,a){let{instance:b}=t,f=15,i=.2,p=!1,S=!1;const g=async()=>{a(3,S=!0);const N=await(await ve("POST","instances/makeUmap",null,{instance_id:b.id,n_neighbors:f,min_distance:i,raster_fairy:p})).json();console.log(N),a(3,S=!1)};function c(){f=Y(this.value),a(0,f)}function E(){i=Y(this.value),a(1,i)}function m(){p=this.checked,a(2,p)}return n.$$set=v=>{"instance"in v&&a(5,b=v.instance)},[f,i,p,S,g,b,c,E,m]}class Jt extends De{constructor(t){super(),Pe(this,t,$t,Zt,Ne,{instance:5})}}function Xt(n){let t,a,b,f,i,p,S,g,c,E,m,v,N,y,x;return{c(){t=r("div"),a=r("h1"),b=D("Feature Extraction"),f=k(),i=r("label"),p=r("span"),S=D("batchSize"),g=k(),c=r("input"),E=k(),m=r("button"),v=D("Run"),this.h()},l(h){t=o(h,"DIV",{class:!0});var _=d(t);a=o(_,"H1",{class:!0});var T=d(a);b=P(T,"Feature Extraction"),T.forEach(l),f=I(_),i=o(_,"LABEL",{class:!0});var w=d(i);p=o(w,"SPAN",{class:!0});var A=d(p);S=P(A,"batchSize"),A.forEach(l),g=I(w),c=o(w,"INPUT",{type:!0,min:!0,max:!0,name:!0,id:!0,class:!0}),w.forEach(l),E=I(_),m=o(_,"BUTTON",{class:!0});var V=d(m);v=P(V,"Run"),V.forEach(l),_.forEach(l),this.h()},h(){s(a,"class","mb-4"),s(p,"class","w-32"),s(c,"type","number"),s(c,"min","1"),s(c,"max","1024"),s(c,"name","batchSize"),s(c,"id","batchSize"),s(c,"class","rounded-lg flex-auto p-2 mr-1 border-2 border-gray-300"),c.required=!0,s(i,"class","flex items-center pb-2 mb-2 text-sm space-x-12 md:space-x-24 justify-between border-b border-gray-200 dark:border-slate-600"),s(m,"class","py-2 px-3 w-40 self-end bg-cyan-500 text-white text-sm font-semibold rounded-md shadow-lg hover:shadow-cyan-500/50 focus:outline-none"),s(t,"class",N="flex shadow-xl rounded-xl p-8 bg-white dark:bg-slate-800 flex-col mt-4 "+(n[1]&&"grayscale pointer-events-none"))},m(h,_){W(h,t,_),e(t,a),e(a,b),e(t,f),e(t,i),e(i,p),e(p,S),e(i,g),e(i,c),X(c,n[0]),e(t,E),e(t,m),e(m,v),y||(x=[Z(c,"input",n[4]),Z(m,"click",n[2])],y=!0)},p(h,[_]){_&1&&Y(c.value)!==h[0]&&X(c,h[0]),_&2&&N!==(N="flex shadow-xl rounded-xl p-8 bg-white dark:bg-slate-800 flex-col mt-4 "+(h[1]&&"grayscale pointer-events-none"))&&s(t,"class",N)},i:re,o:re,d(h){h&&l(t),y=!1,Ae(x)}}}function Yt(n,t,a){let{instance:b}=t,f=64,i=!1;const p=async()=>{a(1,i=!0);const c=await(await ve("POST","instances/makeFeatures",null,{instance_id:b.id,batchSize:f})).json();console.log(c),a(1,i=!1)};function S(){f=Y(this.value),a(0,f)}return n.$$set=g=>{"instance"in g&&a(3,b=g.instance)},[f,i,p,b,S]}class Gt extends De{constructor(t){super(),Pe(this,t,Yt,Xt,Ne,{instance:3})}}function Kt(n){let t,a,b,f,i,p,S,g,c,E,m,v,N,y,x;return{c(){t=r("div"),a=r("h1"),b=D("Spritesheets"),f=k(),i=r("label"),p=r("span"),S=D("spriteSize"),g=k(),c=r("input"),E=k(),m=r("button"),v=D("Run"),this.h()},l(h){t=o(h,"DIV",{class:!0});var _=d(t);a=o(_,"H1",{class:!0});var T=d(a);b=P(T,"Spritesheets"),T.forEach(l),f=I(_),i=o(_,"LABEL",{class:!0});var w=d(i);p=o(w,"SPAN",{class:!0});var A=d(p);S=P(A,"spriteSize"),A.forEach(l),g=I(w),c=o(w,"INPUT",{type:!0,min:!0,max:!0,name:!0,id:!0,class:!0}),w.forEach(l),E=I(_),m=o(_,"BUTTON",{class:!0});var V=d(m);v=P(V,"Run"),V.forEach(l),_.forEach(l),this.h()},h(){s(a,"class","mb-6"),s(p,"class","w-32"),s(c,"type","number"),s(c,"min","1"),s(c,"max","512"),s(c,"name","spriteSize"),s(c,"id","spriteSize"),s(c,"class","rounded-lg flex-auto p-2 mr-1 border-2 border-gray-300"),c.required=!0,s(i,"class","grayscale pointer-events-none flex items-center pb-2 mb-2 text-sm space-x-12 md:space-x-24 justify-between border-b border-gray-200 dark:border-slate-600"),s(m,"class","py-2 px-3 w-40 self-end bg-cyan-500 text-white text-sm font-semibold rounded-md shadow-lg hover:shadow-cyan-500/50 focus:outline-none"),s(t,"class",N="flex shadow-xl rounded-xl p-8 bg-white dark:bg-slate-800 flex-col mt-4 "+(n[1]&&"grayscale pointer-events-none"))},m(h,_){W(h,t,_),e(t,a),e(a,b),e(t,f),e(t,i),e(i,p),e(p,S),e(i,g),e(i,c),X(c,n[0]),e(t,E),e(t,m),e(m,v),y||(x=[Z(c,"input",n[4]),Z(m,"click",n[2])],y=!0)},p(h,[_]){_&1&&Y(c.value)!==h[0]&&X(c,h[0]),_&2&&N!==(N="flex shadow-xl rounded-xl p-8 bg-white dark:bg-slate-800 flex-col mt-4 "+(h[1]&&"grayscale pointer-events-none"))&&s(t,"class",N)},i:re,o:re,d(h){h&&l(t),y=!1,Ae(x)}}}function Qt(n,t,a){let{instance:b}=t,f=128,i=!1;const p=async()=>{a(1,i=!0);const c=await(await ve("POST","instances/makeSpritesheets",null,{instance_id:b.id})).json();console.log(c),a(1,i=!1)};function S(){f=Y(this.value),a(0,f)}return n.$$set=g=>{"instance"in g&&a(3,b=g.instance)},[f,i,p,b,S]}class es extends De{constructor(t){super(),Pe(this,t,Qt,Kt,Ne,{instance:3})}}function ts(n){let t,a,b=n[0].label+"",f,i,p,S=n[0].status+"",g,c,E,m,v,N,y,x,h=n[0].iiif_url+"",_,T,w,A,V,F,z,U=n[0].id+"",j,B,H,M,C,q,O,R=new Date(n[0].created*1e3)+"",J,te,$,se,ae,ke,le,ne,ie=n[1]?"Connected":"Disconnected",Fe,Me,tt,ce,Te,st,at,Ie,oe,lt,Ce,qe,ge,G,_e,nt,rt,we,ot,it,xe,ct,dt,Ee,ut,He,We,de,Ze,ue,$e,fe,Je,pe,Xe,me,K,ft,bt;return de=new Ct({props:{progress:n[3],instance:n[0]}}),ue=new Wt({props:{progress:n[4],instance:n[0]}}),fe=new es({props:{instance:n[0]}}),pe=new Gt({props:{instance:n[0]}}),me=new Jt({props:{instance:n[0]}}),{c(){t=r("div"),a=r("h1"),f=D(b),i=k(),p=r("span"),g=D(S),c=k(),E=r("div"),m=r("div"),v=r("p"),N=D("Manifest URL"),y=k(),x=r("div"),_=D(h),T=k(),w=r("div"),A=r("p"),V=D("Id"),F=k(),z=r("div"),j=D(U),B=k(),H=r("div"),M=r("p"),C=D("Created"),q=k(),O=r("div"),J=D(R),te=k(),$=r("div"),se=r("p"),ae=D("Socket"),ke=k(),le=r("div"),ne=r("span"),Fe=D(ie),tt=k(),ce=r("div"),Te=r("p"),st=D("Vikus Viewer"),at=k(),Ie=r("div"),oe=r("a"),lt=D("Open"),qe=k(),ge=r("div"),G=r("div"),_e=r("button"),nt=D("Run All"),rt=k(),we=r("button"),ot=D("Download Zip"),it=k(),xe=r("button"),ct=D("Make Metadata"),dt=k(),Ee=r("button"),ut=D("Delete"),We=k(),je(de.$$.fragment),Ze=k(),je(ue.$$.fragment),$e=k(),je(fe.$$.fragment),Je=k(),je(pe.$$.fragment),Xe=k(),je(me.$$.fragment),this.h()},l(u){t=o(u,"DIV",{class:!0});var L=d(t);a=o(L,"H1",{});var be=d(a);f=P(be,b),i=I(be),p=o(be,"SPAN",{class:!0});var Se=d(p);g=P(Se,S),Se.forEach(l),be.forEach(l),L.forEach(l),c=I(u),E=o(u,"DIV",{class:!0});var Q=d(E);m=o(Q,"DIV",{class:!0});var ye=d(m);v=o(ye,"P",{});var Ve=d(v);N=P(Ve,"Manifest URL"),Ve.forEach(l),y=I(ye),x=o(ye,"DIV",{class:!0});var ht=d(x);_=P(ht,h),ht.forEach(l),ye.forEach(l),T=I(Q),w=o(Q,"DIV",{class:!0});var Ye=d(w);A=o(Ye,"P",{});var vt=d(A);V=P(vt,"Id"),vt.forEach(l),F=I(Ye),z=o(Ye,"DIV",{class:!0});var gt=d(z);j=P(gt,U),gt.forEach(l),Ye.forEach(l),B=I(Q),H=o(Q,"DIV",{class:!0});var Ge=d(H);M=o(Ge,"P",{});var _t=d(M);C=P(_t,"Created"),_t.forEach(l),q=I(Ge),O=o(Ge,"DIV",{class:!0});var wt=d(O);J=P(wt,R),wt.forEach(l),Ge.forEach(l),te=I(Q),$=o(Q,"DIV",{class:!0});var Ke=d($);se=o(Ke,"P",{});var xt=d(se);ae=P(xt,"Socket"),xt.forEach(l),ke=I(Ke),le=o(Ke,"DIV",{class:!0});var Et=d(le);ne=o(Et,"SPAN",{class:!0});var yt=d(ne);Fe=P(yt,ie),yt.forEach(l),Et.forEach(l),Ke.forEach(l),tt=I(Q),ce=o(Q,"DIV",{class:!0});var Qe=d(ce);Te=o(Qe,"P",{});var kt=d(Te);st=P(kt,"Vikus Viewer"),kt.forEach(l),at=I(Qe),Ie=o(Qe,"DIV",{class:!0});var It=d(Ie);oe=o(It,"A",{target:!0,class:!0,href:!0});var St=d(oe);lt=P(St,"Open"),St.forEach(l),It.forEach(l),Qe.forEach(l),Q.forEach(l),qe=I(u),ge=o(u,"DIV",{class:!0});var Dt=d(ge);G=o(Dt,"DIV",{class:!0});var he=d(G);_e=o(he,"BUTTON",{class:!0});var Pt=d(_e);nt=P(Pt,"Run All"),Pt.forEach(l),rt=I(he),we=o(he,"BUTTON",{class:!0});var Nt=d(we);ot=P(Nt,"Download Zip"),Nt.forEach(l),it=I(he),xe=o(he,"BUTTON",{class:!0});var At=d(xe);ct=P(At,"Make Metadata"),At.forEach(l),dt=I(he),Ee=o(he,"BUTTON",{class:!0});var Tt=d(Ee);ut=P(Tt,"Delete"),Tt.forEach(l),he.forEach(l),Dt.forEach(l),We=I(u),Ue(de.$$.fragment,u),Ze=I(u),Ue(ue.$$.fragment,u),$e=I(u),Ue(fe.$$.fragment,u),Je=I(u),Ue(pe.$$.fragment,u),Xe=I(u),Ue(me.$$.fragment,u),this.h()},h(){s(p,"class","px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-green-100 text-green-800"),s(t,"class","relative "),s(x,"class","flex items-end text-xs"),s(m,"class","flex items-center pb-2 mb-2 text-sm space-x-12 md:space-x-24 justify-between border-b border-gray-200 dark:border-slate-600"),s(z,"class","flex items-end text-xs"),s(w,"class","flex items-center pb-2 mb-2 text-sm space-x-12 md:space-x-24 justify-between border-b border-gray-200 dark:border-slate-600"),s(O,"class","flex items-end text-xs"),s(H,"class","flex items-center pb-2 mb-2 text-sm space-x-12 md:space-x-24 justify-between border-b border-gray-200 dark:border-slate-600"),s(ne,"class",Me="px-2 inline-flex text-xs leading-5 font-semibold rounded-full "+(n[1]?"bg-green-100":"bg-red-100")+" text-"+(n[1]?"green-800":"red-800")),s(le,"class","flex items-end text-xs"),s($,"class","flex items-center pb-2 mb-2 text-sm space-x-12 md:space-x-24 justify-between border-b border-gray-200 dark:border-slate-600"),s(oe,"target","_blank"),s(oe,"class","font-semibold rounded-full px-2 bg-blue-100"),s(oe,"href",Ce=pt+"://"+Re+":"+mt+"/viewer/?config=../data/"+n[0].id+"/config.json"),s(Ie,"class","flex items-end text-xs"),s(ce,"class","flex items-center pb-2 mb-2 text-sm space-x-12 md:space-x-24 justify-between border-b border-gray-200 dark:border-slate-600"),s(E,"class","flex shadow-xl rounded-xl p-8 bg-white dark:bg-slate-800 flex-col mt-7"),s(_e,"class","py-2 px-3 w-40 bg-cyan-500 text-white text-sm font-semibold rounded-md shadow-lg hover:shadow-cyan-500/50 focus:outline-none"),s(we,"class","py-2 px-3 w-40 bg-cyan-500 text-white text-sm font-semibold rounded-md shadow-lg hover:shadow-cyan-500/50 focus:outline-none"),s(xe,"class","py-2 px-3 w-40 bg-cyan-500 text-white text-sm font-semibold rounded-md shadow-lg hover:shadow-cyan-500/50 focus:outline-none"),s(Ee,"class","py-2 px-3 w-32 bg-red-500 text-white text-sm font-semibold rounded-md shadow-lg hover:shadow-red-500/50 focus:outline-none"),s(G,"class",He="grid gap-4 grid-cols-4 "+(n[2]&&"grayscale pointer-events-none")),s(ge,"class","disabled:opacity-75 shadow-xl rounded-xl p-8 bg-white dark:bg-slate-800 mt-7")},m(u,L){W(u,t,L),e(t,a),e(a,f),e(a,i),e(a,p),e(p,g),W(u,c,L),W(u,E,L),e(E,m),e(m,v),e(v,N),e(m,y),e(m,x),e(x,_),e(E,T),e(E,w),e(w,A),e(A,V),e(w,F),e(w,z),e(z,j),e(E,B),e(E,H),e(H,M),e(M,C),e(H,q),e(H,O),e(O,J),e(E,te),e(E,$),e($,se),e(se,ae),e($,ke),e($,le),e(le,ne),e(ne,Fe),e(E,tt),e(E,ce),e(ce,Te),e(Te,st),e(ce,at),e(ce,Ie),e(Ie,oe),e(oe,lt),W(u,qe,L),W(u,ge,L),e(ge,G),e(G,_e),e(_e,nt),e(G,rt),e(G,we),e(we,ot),e(G,it),e(G,xe),e(xe,ct),e(G,dt),e(G,Ee),e(Ee,ut),W(u,We,L),Le(de,u,L),W(u,Ze,L),Le(ue,u,L),W(u,$e,L),Le(fe,u,L),W(u,Je,L),Le(pe,u,L),W(u,Xe,L),Le(me,u,L),K=!0,ft||(bt=[Z(_e,"click",n[5]),Z(we,"click",n[6]),Z(xe,"click",n[9]),Z(Ee,"click",n[8])],ft=!0)},p(u,[L]){(!K||L&1)&&b!==(b=u[0].label+"")&&ee(f,b),(!K||L&1)&&S!==(S=u[0].status+"")&&ee(g,S),(!K||L&1)&&h!==(h=u[0].iiif_url+"")&&ee(_,h),(!K||L&1)&&U!==(U=u[0].id+"")&&ee(j,U),(!K||L&1)&&R!==(R=new Date(u[0].created*1e3)+"")&&ee(J,R),(!K||L&2)&&ie!==(ie=u[1]?"Connected":"Disconnected")&&ee(Fe,ie),(!K||L&2&&Me!==(Me="px-2 inline-flex text-xs leading-5 font-semibold rounded-full "+(u[1]?"bg-green-100":"bg-red-100")+" text-"+(u[1]?"green-800":"red-800")))&&s(ne,"class",Me),(!K||L&1&&Ce!==(Ce=pt+"://"+Re+":"+mt+"/viewer/?config=../data/"+u[0].id+"/config.json"))&&s(oe,"href",Ce),(!K||L&4&&He!==(He="grid gap-4 grid-cols-4 "+(u[2]&&"grayscale pointer-events-none")))&&s(G,"class",He);const be={};L&8&&(be.progress=u[3]),L&1&&(be.instance=u[0]),de.$set(be);const Se={};L&16&&(Se.progress=u[4]),L&1&&(Se.instance=u[0]),ue.$set(Se);const Q={};L&1&&(Q.instance=u[0]),fe.$set(Q);const ye={};L&1&&(ye.instance=u[0]),pe.$set(ye);const Ve={};L&1&&(Ve.instance=u[0]),me.$set(Ve)},i(u){K||(Be(de.$$.fragment,u),Be(ue.$$.fragment,u),Be(fe.$$.fragment,u),Be(pe.$$.fragment,u),Be(me.$$.fragment,u),K=!0)},o(u){ze(de.$$.fragment,u),ze(ue.$$.fragment,u),ze(fe.$$.fragment,u),ze(pe.$$.fragment,u),ze(me.$$.fragment,u),K=!1},d(u){u&&l(t),u&&l(c),u&&l(E),u&&l(qe),u&&l(ge),u&&l(We),Oe(de,u),u&&l(Ze),Oe(ue,u),u&&l($e),Oe(fe,u),u&&l(Je),Oe(pe,u),u&&l(Xe),Oe(me,u),ft=!1,Ae(bt)}}}const ss={id:"test",label:"Test Instance",iiif_url:"http://localhost:5000/instances/test",status:"ok"};async function cs({params:n,fetch:t,session:a,stuff:b}){try{const f=await ve("get",`instances/${n.id}`);return{status:f.status,props:{instance:f.ok&&await f.json()}}}catch(f){return{status:f.status,props:{error:f.message,instance:ss}}}}function as(n,t,a){let{instance:b}=t,f=!1,i=!1,p=null,S=null;const g=new WebSocket(`ws://${Re}:${Vt}/instances/${b.id}/ws`);g.onopen=y=>{console.log("eventSource.onopen",y),a(1,f=!0)},g.onerror=y=>{console.log("eventSource.onerror",y),a(1,f=!1)},g.onclose=y=>{console.log("eventSource.onclose",y),a(1,f=!1)},g.onmessage=y=>{const x=JSON.parse(y.data);x.type!="ping"&&console.log(x),x.task&&x.task==="crawlCollection"&&a(3,p=x),x.task&&x.task==="crawlImages"&&a(4,S=x)},setInterval(()=>{f||(g.close(),g.open(`ws://${Re}:${Vt}/instances/${b.id}/ws`))},1e3),zt(()=>{console.log("It's destroyed"),g.close()});const c=async()=>{await m("run")},E=async()=>{await m("makeZip");const y=`${pt}://${Re}:${mt}/data/${b.id}/project.zip`;var x=document.createElement("a");x.href=y,x.setAttribute("download","project.zip"),x.click()},m=async y=>{a(2,i=!0);const h=await(await ve("POST",`instances/${y}`,null,{instance_id:b.id})).json();return console.log(h),a(2,i=!1),h},v=async()=>{g.close();const y=await ve("DELETE",`instances/${b.id}`);await y.json(),y.ok&&Ot(Rt)},N=()=>m("makeMetadata");return n.$$set=y=>{"instance"in y&&a(0,b=y.instance)},n.$$.update=()=>{n.$$.dirty&1&&console.log(b)},[b,f,i,p,S,c,E,m,v,N]}class ds extends De{constructor(t){super(),Pe(this,t,as,ts,Ne,{instance:0})}}export{ds as default,cs as load};
