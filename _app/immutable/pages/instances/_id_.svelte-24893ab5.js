import{S as wt,i as kt,s as Et,F as ht,G as _t,a as m,d as c,b as n,g as O,H as l,L as ts,e as h,k as D,c as _,m as y,Q as xt,M as ss,N as ls,O as as,q as re,o as pe,U as ns,t as V,h as P,V as Rt,j as W,w as Ze,x as qe,y as Je,W as rs,X as vt,B as Ke,f as Ft,l as Wt,p as os,K as is,Y as cs,n as fs}from"../../chunks/index-f7dd684f.js";import{b as je,p as Pe,d as Ee,c as Se,a as ds}from"../../chunks/api-a1f7356f.js";import{l as us,a as ps}from"../../chunks/store-6b6edcdb.js";import{g as ms}from"../../chunks/navigation-0e6511d1.js";import{b as bt}from"../../chunks/paths-396f020f.js";import"../../chunks/index-746091fb.js";import"../../chunks/singletons-d1fb5791.js";function Gt(s){let e,t,a;return{c(){e=ht("svg"),t=ht("circle"),a=ht("path"),this.h()},l(o){e=_t(o,"svg",{class:!0,xmlns:!0,fill:!0,viewBox:!0});var d=m(e);t=_t(d,"circle",{class:!0,cx:!0,cy:!0,r:!0,stroke:!0,"stroke-width":!0}),m(t).forEach(c),a=_t(d,"path",{class:!0,fill:!0,d:!0}),m(a).forEach(c),d.forEach(c),this.h()},h(){n(t,"class","opacity-25"),n(t,"cx","12"),n(t,"cy","12"),n(t,"r","10"),n(t,"stroke","currentColor"),n(t,"stroke-width","4"),n(a,"class","opacity-75"),n(a,"fill","currentColor"),n(a,"d","M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"),n(e,"class","animate-spin -ml-1 mr-3 h-5 w-5 text-white"),n(e,"xmlns","http://www.w3.org/2000/svg"),n(e,"fill","none"),n(e,"viewBox","0 0 24 24")},m(o,d){O(o,e,d),l(e,t),l(e,a)},d(o){o&&c(e)}}}function hs(s){let e,t,a,o,d,p,u=s[0]&&Gt();const b=s[2].default,f=ts(b,s,s[1],null);return{c(){e=h("button"),u&&u.c(),t=D(),f&&f.c(),this.h()},l(i){e=_(i,"BUTTON",{type:!0,class:!0});var v=m(e);u&&u.l(v),t=y(v),f&&f.l(v),v.forEach(c),this.h()},h(){n(e,"type","submit"),e.disabled=s[0],n(e,"class",a="inline-flex items-center py-2 px-3 self-end bg-cyan-500 text-white text-sm font-semibold rounded-md shadow-lg hover:shadow-cyan-500/50 focus:outline-none "+(s[0]&&"opacity-50 cursor-not-allowed"))},m(i,v){O(i,e,v),u&&u.m(e,null),l(e,t),f&&f.m(e,null),o=!0,d||(p=xt(e,"click",s[3]),d=!0)},p(i,[v]){i[0]?u||(u=Gt(),u.c(),u.m(e,t)):u&&(u.d(1),u=null),f&&f.p&&(!o||v&2)&&ss(f,b,i,i[1],o?as(b,i[1],v,null):ls(i[1]),null),(!o||v&1)&&(e.disabled=i[0]),(!o||v&1&&a!==(a="inline-flex items-center py-2 px-3 self-end bg-cyan-500 text-white text-sm font-semibold rounded-md shadow-lg hover:shadow-cyan-500/50 focus:outline-none "+(i[0]&&"opacity-50 cursor-not-allowed")))&&n(e,"class",a)},i(i){o||(re(f,i),o=!0)},o(i){pe(f,i),o=!1},d(i){i&&c(e),u&&u.d(),f&&f.d(i),d=!1,p()}}}function _s(s,e,t){let{$$slots:a={},$$scope:o}=e,{loading:d=!1}=e;function p(u){ns.call(this,s,u)}return s.$$set=u=>{"loading"in u&&t(0,d=u.loading),"$$scope"in u&&t(1,o=u.$$scope)},[d,o,a,p]}class gt extends wt{constructor(e){super(),kt(this,e,_s,hs,Et,{loading:0})}}function Zt(s,e,t){const a=s.slice();return a[6]=e[t],a}function bs(s){let e,t,a,o,d;return{c(){e=h("input"),this.h()},l(p){e=_(p,"INPUT",{name:!0,id:!0,class:!0,type:!0,step:!0}),this.h()},h(){n(e,"name",t=s[6].name),n(e,"id",a=s[6].name),n(e,"class","rounded-lg p-2 mr-1 border-2 border-gray-300"),n(e,"type",o=s[4](s[6])),e.value=d=s[3](s[6]),n(e,"step","any")},m(p,u){O(p,e,u)},p(p,u){u&1&&t!==(t=p[6].name)&&n(e,"name",t),u&1&&a!==(a=p[6].name)&&n(e,"id",a),u&1&&o!==(o=p[4](p[6]))&&n(e,"type",o),u&1&&d!==(d=p[3](p[6]))&&e.value!==d&&(e.value=d)},d(p){p&&c(e)}}}function vs(s){let e,t,a,o,d,p,u;return{c(){e=h("input"),o=D(),d=h("input"),this.h()},l(b){e=_(b,"INPUT",{type:!0,name:!0,id:!0}),o=y(b),d=_(b,"INPUT",{type:!0,name:!0,id:!0,class:!0}),this.h()},h(){n(e,"type","hidden"),n(e,"name",t=s[6].name),n(e,"id",a=s[6].name),e.value="false",n(d,"type","checkbox"),n(d,"name",p=s[6].name),n(d,"id",u=s[6].name),n(d,"class","rounded-lg p-2 mr-1 border-2 border-gray-300"),d.value="true"},m(b,f){O(b,e,f),O(b,o,f),O(b,d,f)},p(b,f){f&1&&t!==(t=b[6].name)&&n(e,"name",t),f&1&&a!==(a=b[6].name)&&n(e,"id",a),f&1&&p!==(p=b[6].name)&&n(d,"name",p),f&1&&u!==(u=b[6].name)&&n(d,"id",u)},d(b){b&&c(e),b&&c(o),b&&c(d)}}}function qt(s){let e,t,a=s[6].description+"",o,d,p;function u(i,v){return i[6].schema.type==="boolean"?vs:bs}let b=u(s),f=b(s);return{c(){e=h("label"),t=h("span"),o=V(a),d=D(),f.c(),this.h()},l(i){e=_(i,"LABEL",{class:!0,for:!0});var v=m(e);t=_(v,"SPAN",{class:!0});var S=m(t);o=P(S,a),S.forEach(c),d=y(v),f.l(v),v.forEach(c),this.h()},h(){n(t,"class","flex-auto"),n(e,"class","flex items-center pb-2 mb-2 text-sm space-x-12 md:space-x-24 justify-between border-b border-gray-200 dark:border-slate-600"),n(e,"for",p=s[6].name),Rt(e,"hidden",s[6].name==="instance_id")},m(i,v){O(i,e,v),l(e,t),l(t,o),l(e,d),f.m(e,null)},p(i,v){v&1&&a!==(a=i[6].description+"")&&W(o,a),b===(b=u(i))&&f?f.p(i,v):(f.d(1),f=b(i),f&&(f.c(),f.m(e,null))),v&1&&p!==(p=i[6].name)&&n(e,"for",p),v&1&&Rt(e,"hidden",i[6].name==="instance_id")},d(i){i&&c(e),f.d()}}}function gs(s){let e;return{c(){e=V("Run")},l(t){e=P(t,"Run")},m(t,a){O(t,e,a)},d(t){t&&c(e)}}}function ws(s){let e,t,a=s[0].name+"",o,d,p,u=s[0].description+"",b,f,i,v,S,U,M,k,E=s[0].parameters,x=[];for(let w=0;w<E.length;w+=1)x[w]=qt(Zt(s,E,w));return S=new gt({props:{loading:s[1],$$slots:{default:[gs]},$$scope:{ctx:s}}}),{c(){e=h("div"),t=h("h1"),o=V(a),d=D(),p=h("p"),b=V(u),f=D(),i=h("form");for(let w=0;w<x.length;w+=1)x[w].c();v=D(),Ze(S.$$.fragment),this.h()},l(w){e=_(w,"DIV",{class:!0});var $=m(e);t=_($,"H1",{class:!0});var T=m(t);o=P(T,a),T.forEach(c),d=y($),p=_($,"P",{class:!0});var j=m(p);b=P(j,u),j.forEach(c),f=y($),i=_($,"FORM",{});var B=m(i);for(let N=0;N<x.length;N+=1)x[N].l(B);v=y(B),qe(S.$$.fragment,B),B.forEach(c),$.forEach(c),this.h()},h(){n(t,"class","mb-2"),n(p,"class","text-sm mb-4"),n(e,"class","flex shadow-xl rounded-xl p-8 bg-white dark:bg-slate-800 flex-col mt-4 ")},m(w,$){O(w,e,$),l(e,t),l(t,o),l(e,d),l(e,p),l(p,b),l(e,f),l(e,i);for(let T=0;T<x.length;T+=1)x[T].m(i,null);l(i,v),Je(S,i,null),U=!0,M||(k=xt(i,"submit",rs(s[2])),M=!0)},p(w,[$]){if((!U||$&1)&&a!==(a=w[0].name+"")&&W(o,a),(!U||$&1)&&u!==(u=w[0].description+"")&&W(b,u),$&25){E=w[0].parameters;let j;for(j=0;j<E.length;j+=1){const B=Zt(w,E,j);x[j]?x[j].p(B,$):(x[j]=qt(B),x[j].c(),x[j].m(i,v))}for(;j<x.length;j+=1)x[j].d(1);x.length=E.length}const T={};$&2&&(T.loading=w[1]),$&512&&(T.$$scope={dirty:$,ctx:w}),S.$set(T)},i(w){U||(re(S.$$.fragment,w),U=!0)},o(w){pe(S.$$.fragment,w),U=!1},d(w){w&&c(e),vt(x,w),Ke(S),M=!1,k()}}}function ks(s,e,t){let{instance:a}=e,{path:o}=e;console.log(o);let d=!1;const p=async f=>{t(1,d=!0);const i=new FormData(f.target),v={};for(let M of i){const[k,E]=M;v[k]=E}const U=await(await je(o.method,o.path,null,v)).json();console.log(U),t(1,d=!1)},u=f=>f.name==="instance_id"?a.id:f.schema.default,b=f=>{const i=f.schema.type;return i==="number"||i==="integer"?"number":i==="boolean"?"checkbox":"text"};return s.$$set=f=>{"instance"in f&&t(5,a=f.instance),"path"in f&&t(0,o=f.path)},[o,d,p,u,b,a]}class Es extends wt{constructor(e){super(),kt(this,e,ks,ws,Et,{instance:5,path:0})}}function Jt(s,e,t){const a=s.slice();return a[12]=e[t],a}function Kt(s,e,t){const a=s.slice();return a[15]=e[t],a}function Qt(s){let e,t=s[15]+"",a,o,d;return{c(){e=h("span"),a=V(t),o=D(),this.h()},l(p){e=_(p,"SPAN",{class:!0});var u=m(e);a=P(u,t),o=y(u),u.forEach(c),this.h()},h(){n(e,"class",d="px-2 inline-flex text-xs leading-5 font-semibold rounded-full "+(s[0][s[15]]?"bg-green-100":"bg-red-100")+" text-"+(s[0][s[15]]?"green-800":"red-800"))},m(p,u){O(p,e,u),l(e,a),l(e,o)},p(p,u){u&1&&d!==(d="px-2 inline-flex text-xs leading-5 font-semibold rounded-full "+(p[0][p[15]]?"bg-green-100":"bg-red-100")+" text-"+(p[0][p[15]]?"green-800":"red-800"))&&n(e,"class",d)},d(p){p&&c(e)}}}function xs(s){let e;return{c(){e=V("Generate Instance")},l(t){e=P(t,"Generate Instance")},m(t,a){O(t,e,a)},d(t){t&&c(e)}}}function Is(s){let e;return{c(){e=V("Download ZIP")},l(t){e=P(t,"Download ZIP")},m(t,a){O(t,e,a)},d(t){t&&c(e)}}}function Xt(s){let e,t,a,o,d=s[3].task+"",p,u,b,f=s[3].completed+"",i,v,S=s[3].size+"",U,M,k,E,x=parseInt(s[3].progress*100)+"",w,$,T,j,B;return{c(){e=h("div"),t=h("div"),a=h("div"),o=h("span"),p=V(d),u=D(),b=h("span"),i=V(f),v=V("/"),U=V(S),M=D(),k=h("div"),E=h("span"),w=V(x),$=V("%"),T=D(),j=h("div"),B=h("div"),this.h()},l(N){e=_(N,"DIV",{class:!0});var C=m(e);t=_(C,"DIV",{class:!0});var q=m(t);a=_(q,"DIV",{});var ee=m(a);o=_(ee,"SPAN",{class:!0});var G=m(o);p=P(G,d),G.forEach(c),u=y(ee),b=_(ee,"SPAN",{class:!0});var Z=m(b);i=P(Z,f),v=P(Z,"/"),U=P(Z,S),Z.forEach(c),ee.forEach(c),M=y(q),k=_(q,"DIV",{class:!0});var me=m(k);E=_(me,"SPAN",{class:!0});var oe=m(E);w=P(oe,x),$=P(oe,"%"),oe.forEach(c),me.forEach(c),q.forEach(c),T=y(C),j=_(C,"DIV",{class:!0});var J=m(j);B=_(J,"DIV",{style:!0,class:!0}),m(B).forEach(c),J.forEach(c),C.forEach(c),this.h()},h(){n(o,"class","text-xs font-semibold inline-block py-1 px-2 uppercase rounded-full text-green-600 bg-green-200"),n(b,"class","text-xs font-semibold inline-block py-1 px-2 uppercase rounded-full text-green-600 bg-green-200"),n(E,"class","text-xs font-semibold inline-block text-green-600"),n(k,"class","text-right"),n(t,"class","flex mb-2 items-center justify-between"),Ft(B,"width",parseInt(s[3].progress*100)+"%"),n(B,"class","shadow-none flex flex-col text-center whitespace-nowrap text-white justify-center bg-green-500"),n(j,"class","overflow-hidden h-2 mb-2 text-xs flex rounded bg-green-200"),n(e,"class","sticky top-0 flex shadow-xl rounded-xl p-4 bg-slate-100 dark:bg-slate-800 flex-col mt-3")},m(N,C){O(N,e,C),l(e,t),l(t,a),l(a,o),l(o,p),l(a,u),l(a,b),l(b,i),l(b,v),l(b,U),l(t,M),l(t,k),l(k,E),l(E,w),l(E,$),l(e,T),l(e,j),l(j,B)},p(N,C){C&8&&d!==(d=N[3].task+"")&&W(p,d),C&8&&f!==(f=N[3].completed+"")&&W(i,f),C&8&&S!==(S=N[3].size+"")&&W(U,S),C&8&&x!==(x=parseInt(N[3].progress*100)+"")&&W(w,x),C&8&&Ft(B,"width",parseInt(N[3].progress*100)+"%")},d(N){N&&c(e)}}}function Yt(s){let e,t;return e=new Es({props:{instance:s[0],path:s[12]}}),{c(){Ze(e.$$.fragment)},l(a){qe(e.$$.fragment,a)},m(a,o){Je(e,a,o),t=!0},p(a,o){const d={};o&1&&(d.instance=a[0]),o&16&&(d.path=a[12]),e.$set(d)},i(a){t||(re(e.$$.fragment,a),t=!0)},o(a){pe(e.$$.fragment,a),t=!1},d(a){Ke(e,a)}}}function Ds(s){let e,t,a,o,d,p,u=s[0].label+"",b,f,i,v,S,U,M,k,E=s[0].iiif_url+"",x,w,$,T,j,B,N,C=s[0].id+"",q,ee,G,Z,me,oe,J,xe=new Date(s[0].created*1e3)+"",ze,Qe,te,Ie,Xe,Ye,he,ie,De=s[1]?"Connected":"Disconnected",Ne,Ae,et,se,ye,tt,st,_e,K,lt,Oe,at,le,$e,nt,rt,be,Q,ot,Te,it,ae,Ve,ct,ft,ce,dt,ne,X,ut,Y,Ue,ve,fe,pt,Be,ge,F,mt,It,we=s[5],L=[];for(let r=0;r<we.length;r+=1)L[r]=Qt(Kt(s,we,r));X=new gt({props:{loading:s[2].all,$$slots:{default:[xs]},$$scope:{ctx:s}}}),X.$on("click",s[6]),Y=new gt({props:{loading:s[2].zip,$$slots:{default:[Is]},$$scope:{ctx:s}}}),Y.$on("click",s[7]);let H=s[3]&&Xt(s),de=s[4],z=[];for(let r=0;r<de.length;r+=1)z[r]=Yt(Jt(s,de,r));const es=r=>pe(z[r],1,1,()=>{z[r]=null});return{c(){e=h("div"),t=h("div"),a=h("button"),o=V("Delete"),d=D(),p=h("h1"),b=V(u),f=D(),i=h("div"),v=h("div"),S=h("p"),U=V("Manifest URL"),M=D(),k=h("div"),x=V(E),w=D(),$=h("div"),T=h("p"),j=V("Id"),B=D(),N=h("div"),q=V(C),ee=D(),G=h("div"),Z=h("p"),me=V("Created"),oe=D(),J=h("div"),ze=V(xe),Qe=D(),te=h("div"),Ie=h("p"),Xe=V("Socket"),Ye=D(),he=h("div"),ie=h("span"),Ne=V(De),et=D(),se=h("div"),ye=h("p"),tt=V("Vikus Viewer"),st=D(),_e=h("div"),K=h("a"),lt=V("Open"),at=D(),le=h("div"),$e=h("p"),nt=V("Data Dir"),rt=D(),be=h("div"),Q=h("a"),ot=V("Open"),it=D(),ae=h("div"),Ve=h("p"),ct=V("Status"),ft=D(),ce=h("div");for(let r=0;r<L.length;r+=1)L[r].c();dt=D(),ne=h("div"),Ze(X.$$.fragment),ut=D(),Ze(Y.$$.fragment),Ue=D(),H&&H.c(),ve=D(),fe=h("h2"),pt=V("Advanced Settings"),Be=D();for(let r=0;r<z.length;r+=1)z[r].c();ge=Wt(),this.h()},l(r){e=_(r,"DIV",{class:!0});var g=m(e);t=_(g,"DIV",{class:!0});var R=m(t);a=_(R,"BUTTON",{class:!0});var ke=m(a);o=P(ke,"Delete"),ke.forEach(c),R.forEach(c),d=y(g),p=_(g,"H1",{});var I=m(p);b=P(I,u),I.forEach(c),g.forEach(c),f=y(r),i=_(r,"DIV",{class:!0});var A=m(i);v=_(A,"DIV",{class:!0});var Ce=m(v);S=_(Ce,"P",{});var Dt=m(S);U=P(Dt,"Manifest URL"),Dt.forEach(c),M=y(Ce),k=_(Ce,"DIV",{class:!0});var yt=m(k);x=P(yt,E),yt.forEach(c),Ce.forEach(c),w=y(A),$=_(A,"DIV",{class:!0});var Le=m($);T=_(Le,"P",{});var $t=m(T);j=P($t,"Id"),$t.forEach(c),B=y(Le),N=_(Le,"DIV",{class:!0});var Vt=m(N);q=P(Vt,C),Vt.forEach(c),Le.forEach(c),ee=y(A),G=_(A,"DIV",{class:!0});var He=m(G);Z=_(He,"P",{});var Pt=m(Z);me=P(Pt,"Created"),Pt.forEach(c),oe=y(He),J=_(He,"DIV",{class:!0});var St=m(J);ze=P(St,xe),St.forEach(c),He.forEach(c),Qe=y(A),te=_(A,"DIV",{class:!0});var Me=m(te);Ie=_(Me,"P",{});var jt=m(Ie);Xe=P(jt,"Socket"),jt.forEach(c),Ye=y(Me),he=_(Me,"DIV",{class:!0});var zt=m(he);ie=_(zt,"SPAN",{class:!0});var Nt=m(ie);Ne=P(Nt,De),Nt.forEach(c),zt.forEach(c),Me.forEach(c),et=y(A),se=_(A,"DIV",{class:!0});var Re=m(se);ye=_(Re,"P",{});var At=m(ye);tt=P(At,"Vikus Viewer"),At.forEach(c),st=y(Re),_e=_(Re,"DIV",{class:!0});var Ot=m(_e);K=_(Ot,"A",{target:!0,class:!0,href:!0});var Tt=m(K);lt=P(Tt,"Open"),Tt.forEach(c),Ot.forEach(c),Re.forEach(c),at=y(A),le=_(A,"DIV",{class:!0});var Fe=m(le);$e=_(Fe,"P",{});var Ut=m($e);nt=P(Ut,"Data Dir"),Ut.forEach(c),rt=y(Fe),be=_(Fe,"DIV",{class:!0});var Bt=m(be);Q=_(Bt,"A",{target:!0,class:!0,href:!0});var Ct=m(Q);ot=P(Ct,"Open"),Ct.forEach(c),Bt.forEach(c),Fe.forEach(c),it=y(A),ae=_(A,"DIV",{class:!0});var We=m(ae);Ve=_(We,"P",{});var Lt=m(Ve);ct=P(Lt,"Status"),Lt.forEach(c),ft=y(We),ce=_(We,"DIV",{class:!0});var Ht=m(ce);for(let ue=0;ue<L.length;ue+=1)L[ue].l(Ht);Ht.forEach(c),We.forEach(c),dt=y(A),ne=_(A,"DIV",{class:!0});var Ge=m(ne);qe(X.$$.fragment,Ge),ut=y(Ge),qe(Y.$$.fragment,Ge),Ge.forEach(c),A.forEach(c),Ue=y(r),H&&H.l(r),ve=y(r),fe=_(r,"H2",{class:!0});var Mt=m(fe);pt=P(Mt,"Advanced Settings"),Mt.forEach(c),Be=y(r);for(let ue=0;ue<z.length;ue+=1)z[ue].l(r);ge=Wt(),this.h()},h(){n(a,"class","p-1 pl-2 pr-2 bg-red-700 text-white text-sm font-semibold rounded-md shadow-lg hover:shadow-red-500/50 focus:outline-none"),n(t,"class","absolute top-0 right-0"),n(e,"class","relative "),n(k,"class","flex items-end text-xs"),n(v,"class","flex items-center pb-2 mb-2 text-sm space-x-12 md:space-x-24 justify-between border-b border-gray-200 dark:border-slate-600"),n(N,"class","flex items-end text-xs"),n($,"class","flex items-center pb-2 mb-2 text-sm space-x-12 md:space-x-24 justify-between border-b border-gray-200 dark:border-slate-600"),n(J,"class","flex items-end text-xs"),n(G,"class","flex items-center pb-2 mb-2 text-sm space-x-12 md:space-x-24 justify-between border-b border-gray-200 dark:border-slate-600"),n(ie,"class",Ae="px-2 inline-flex text-xs leading-5 font-semibold rounded-full "+(s[1]?"bg-green-100":"bg-red-100")+" text-"+(s[1]?"green-800":"red-800")),n(he,"class","flex items-end text-xs"),n(te,"class","flex items-center pb-2 mb-2 text-sm space-x-12 md:space-x-24 justify-between border-b border-gray-200 dark:border-slate-600"),n(K,"target","_blank"),n(K,"class","font-semibold rounded-full px-2 bg-blue-100"),n(K,"href",Oe=Pe+"://"+Ee+":"+Se+"/viewer/?config=../data/"+s[0].id+"/config.json"),n(_e,"class","flex items-end text-xs"),n(se,"class","flex items-center pb-2 mb-2 text-sm space-x-12 md:space-x-24 justify-between border-b border-gray-200 dark:border-slate-600"),n(Q,"target","_blank"),n(Q,"class","font-semibold rounded-full px-2 bg-blue-100"),n(Q,"href",Te=Pe+"://"+Ee+":"+Se+"/data/"+s[0].id),n(be,"class","flex items-end text-xs"),n(le,"class","flex items-center pb-2 mb-2 text-sm space-x-12 md:space-x-24 justify-between border-b border-gray-200 dark:border-slate-600"),n(ce,"class","flex items-end text-xs"),n(ae,"class","flex items-center pb-2 mb-2 text-sm space-x-12 md:space-x-24 justify-between border-b border-gray-200 dark:border-slate-600"),n(ne,"class","flex justify-between mt-8"),n(i,"class","flex shadow-xl rounded-xl p-8 bg-white dark:bg-slate-800 flex-col mt-7 mb-4"),n(fe,"class","mt-8 mb-6")},m(r,g){O(r,e,g),l(e,t),l(t,a),l(a,o),l(e,d),l(e,p),l(p,b),O(r,f,g),O(r,i,g),l(i,v),l(v,S),l(S,U),l(v,M),l(v,k),l(k,x),l(i,w),l(i,$),l($,T),l(T,j),l($,B),l($,N),l(N,q),l(i,ee),l(i,G),l(G,Z),l(Z,me),l(G,oe),l(G,J),l(J,ze),l(i,Qe),l(i,te),l(te,Ie),l(Ie,Xe),l(te,Ye),l(te,he),l(he,ie),l(ie,Ne),l(i,et),l(i,se),l(se,ye),l(ye,tt),l(se,st),l(se,_e),l(_e,K),l(K,lt),l(i,at),l(i,le),l(le,$e),l($e,nt),l(le,rt),l(le,be),l(be,Q),l(Q,ot),l(i,it),l(i,ae),l(ae,Ve),l(Ve,ct),l(ae,ft),l(ae,ce);for(let R=0;R<L.length;R+=1)L[R].m(ce,null);l(i,dt),l(i,ne),Je(X,ne,null),l(ne,ut),Je(Y,ne,null),O(r,Ue,g),H&&H.m(r,g),O(r,ve,g),O(r,fe,g),l(fe,pt),O(r,Be,g);for(let R=0;R<z.length;R+=1)z[R].m(r,g);O(r,ge,g),F=!0,mt||(It=xt(a,"click",s[8]),mt=!0)},p(r,[g]){if((!F||g&1)&&u!==(u=r[0].label+"")&&W(b,u),(!F||g&1)&&E!==(E=r[0].iiif_url+"")&&W(x,E),(!F||g&1)&&C!==(C=r[0].id+"")&&W(q,C),(!F||g&1)&&xe!==(xe=new Date(r[0].created*1e3)+"")&&W(ze,xe),(!F||g&2)&&De!==(De=r[1]?"Connected":"Disconnected")&&W(Ne,De),(!F||g&2&&Ae!==(Ae="px-2 inline-flex text-xs leading-5 font-semibold rounded-full "+(r[1]?"bg-green-100":"bg-red-100")+" text-"+(r[1]?"green-800":"red-800")))&&n(ie,"class",Ae),(!F||g&1&&Oe!==(Oe=Pe+"://"+Ee+":"+Se+"/viewer/?config=../data/"+r[0].id+"/config.json"))&&n(K,"href",Oe),(!F||g&1&&Te!==(Te=Pe+"://"+Ee+":"+Se+"/data/"+r[0].id))&&n(Q,"href",Te),g&33){we=r[5];let I;for(I=0;I<we.length;I+=1){const A=Kt(r,we,I);L[I]?L[I].p(A,g):(L[I]=Qt(A),L[I].c(),L[I].m(ce,null))}for(;I<L.length;I+=1)L[I].d(1);L.length=we.length}const R={};g&4&&(R.loading=r[2].all),g&262144&&(R.$$scope={dirty:g,ctx:r}),X.$set(R);const ke={};if(g&4&&(ke.loading=r[2].zip),g&262144&&(ke.$$scope={dirty:g,ctx:r}),Y.$set(ke),r[3]?H?H.p(r,g):(H=Xt(r),H.c(),H.m(ve.parentNode,ve)):H&&(H.d(1),H=null),g&17){de=r[4];let I;for(I=0;I<de.length;I+=1){const A=Jt(r,de,I);z[I]?(z[I].p(A,g),re(z[I],1)):(z[I]=Yt(A),z[I].c(),re(z[I],1),z[I].m(ge.parentNode,ge))}for(fs(),I=de.length;I<z.length;I+=1)es(I);os()}},i(r){if(!F){re(X.$$.fragment,r),re(Y.$$.fragment,r);for(let g=0;g<de.length;g+=1)re(z[g]);F=!0}},o(r){pe(X.$$.fragment,r),pe(Y.$$.fragment,r),z=z.filter(Boolean);for(let g=0;g<z.length;g+=1)pe(z[g]);F=!1},d(r){r&&c(e),r&&c(f),r&&c(i),vt(L,r),Ke(X),Ke(Y),r&&c(Ue),H&&H.d(r),r&&c(ve),r&&c(fe),r&&c(Be),vt(z,r),r&&c(ge),mt=!1,It()}}}const ys={id:"test",label:"Disconnected Instance",iiif_url:"http://localhost:5000/instances/test",status:"ok"};async function Os({params:s,fetch:e,session:t,stuff:a}){try{const o=await je("get",`/instances/${s.id}`);return{status:o.status,props:{instance:o.ok&&await o.json()}}}catch(o){return{status:o.status,props:{error:o.message,instance:ys}}}}function $s(s,e,t){let a;is(s,ps,k=>t(4,a=k));let{instance:o}=e,d=!1,p={all:!1,zip:!1},u=!1,b=["collection","images","features","similarity","metadata","spritesheets","zip"],f=null;function i(){console.log("connection to websocket"),f&&f.close(),f=new WebSocket(`ws://${Ee}:${ds}/instances/${o.id}/ws`),f.onopen=k=>{console.log("eventSource.onopen",k),t(1,d=!0)},f.onerror=k=>{console.log("eventSource.onerror",k),t(1,d=!1)},f.onclose=k=>{console.log("eventSource.onclose",k),t(1,d=!1)},f.onmessage=k=>{const E=JSON.parse(k.data);E.type!="ping"&&console.log(E),E.task&&t(3,u=E)}}const v=setInterval(()=>{d||i()},2e3);cs(()=>{console.log("It's destroyed"),t(1,d=!1),f.close(),clearInterval(v)});const S=async()=>{t(2,p={all:!0,zip:!1});const E=await(await je("POST","/instances/generate",null,{instance_id:o.id})).json();console.log(E),t(2,p={all:!1,zip:!1})},U=async()=>{t(2,p={all:!1,zip:!0}),await(await je("POST","/instances/steps/zip",null,{instance_id:o.id})).json();const E=`${Pe}://${Ee}:${Se}/data/${o.id}/project.zip`;var x=document.createElement("a");x.href=E,x.setAttribute("download","project.zip"),x.click(),t(2,p={all:!1,zip:!1})},M=async()=>{f.close(),(await(await je("DELETE",`/instances/${o.id}`)).json()).status=="deleted"&&(us(),ms(bt?bt:"/"))};return console.log("base",bt),s.$$set=k=>{"instance"in k&&t(0,o=k.instance)},s.$$.update=()=>{s.$$.dirty&1&&(console.log(o),t(3,u=!1),t(1,d=!1),i())},[o,d,p,u,a,b,S,U,M]}class Ts extends wt{constructor(e){super(),kt(this,e,$s,Ds,Et,{instance:0})}}export{Ts as default,Os as load};
