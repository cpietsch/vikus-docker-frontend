import{S as ke,i as Ie,s as Se,e as i,t as N,k as S,c,a as u,h as T,d as n,m as D,b as s,f as $e,g as H,H as e,j as G,W as Z,O as W,X as $,E as ae,T as De,w as Ne,x as Te,y as Ae,q as Ve,o as je,B as Ue,Y as xt}from"../../chunks/index-ce9f2381.js";import{b as be,d as ht,a as Et,p as yt}from"../../chunks/api-a139c5d6.js";import{g as kt}from"../../chunks/navigation-0e6511d1.js";import"../../chunks/singletons-d1fb5791.js";function vt(o){let t,a,b,f,l=o[0].completed+"",p,k,x=o[0].size+"",r,E,m,g,P=parseInt(o[0].progress*100)+"",y,w,h,_,A;return{c(){t=i("div"),a=i("div"),b=i("div"),f=i("span"),p=N(l),k=N("/"),r=N(x),E=S(),m=i("div"),g=i("span"),y=N(P),w=N("%"),h=S(),_=i("div"),A=i("div"),this.h()},l(v){t=c(v,"DIV",{class:!0});var I=u(t);a=c(I,"DIV",{class:!0});var O=u(a);b=c(O,"DIV",{});var V=u(b);f=c(V,"SPAN",{class:!0});var j=u(f);p=T(j,l),k=T(j,"/"),r=T(j,x),j.forEach(n),V.forEach(n),E=D(O),m=c(O,"DIV",{class:!0});var L=u(m);g=c(L,"SPAN",{class:!0});var U=u(g);y=T(U,P),w=T(U,"%"),U.forEach(n),L.forEach(n),O.forEach(n),h=D(I),_=c(I,"DIV",{class:!0});var z=u(_);A=c(z,"DIV",{style:!0,class:!0}),u(A).forEach(n),z.forEach(n),I.forEach(n),this.h()},h(){s(f,"class","text-xs font-semibold inline-block py-1 px-2 uppercase rounded-full text-green-600 bg-green-200"),s(g,"class","text-xs font-semibold inline-block text-green-600"),s(m,"class","text-right"),s(a,"class","flex mb-2 items-center justify-between"),$e(A,"width",parseInt(o[0].progress*100)+"%"),s(A,"class","shadow-none flex flex-col text-center whitespace-nowrap text-white justify-center bg-green-500"),s(_,"class","overflow-hidden h-2 mb-4 text-xs flex rounded bg-green-200"),s(t,"class","relative mt-2")},m(v,I){H(v,t,I),e(t,a),e(a,b),e(b,f),e(f,p),e(f,k),e(f,r),e(a,E),e(a,m),e(m,g),e(g,y),e(g,w),e(t,h),e(t,_),e(_,A)},p(v,I){I&1&&l!==(l=v[0].completed+"")&&G(p,l),I&1&&x!==(x=v[0].size+"")&&G(r,x),I&1&&P!==(P=parseInt(v[0].progress*100)+"")&&G(y,P),I&1&&$e(A,"width",parseInt(v[0].progress*100)+"%")},d(v){v&&n(t)}}}function It(o){let t,a,b,f,l,p,k,x,r,E,m,g,P,y,w,h,_,A,v,I,O,V,j,L,U,z,q,F,X,C=o[0]&&vt(o);return{c(){t=i("div"),a=i("h1"),b=N("Collection"),f=S(),l=i("label"),p=i("span"),k=N("Manifests"),x=S(),r=i("span"),E=N(gt),m=S(),g=i("label"),P=i("span"),y=N("Worker"),w=S(),h=i("input"),_=S(),A=i("label"),v=i("span"),I=N("Crawl depth"),O=S(),V=i("input"),j=S(),C&&C.c(),L=S(),U=i("button"),z=N("Run"),this.h()},l(M){t=c(M,"DIV",{class:!0});var R=u(t);a=c(R,"H1",{class:!0});var te=u(a);b=T(te,"Collection"),te.forEach(n),f=D(R),l=c(R,"LABEL",{class:!0});var ne=u(l);p=c(ne,"SPAN",{class:!0});var K=u(p);k=T(K,"Manifests"),K.forEach(n),x=D(ne),r=c(ne,"SPAN",{});var le=u(r);E=T(le,gt),le.forEach(n),ne.forEach(n),m=D(R),g=c(R,"LABEL",{class:!0});var re=u(g);P=c(re,"SPAN",{class:!0});var Ee=u(P);y=T(Ee,"Worker"),Ee.forEach(n),w=D(re),h=c(re,"INPUT",{type:!0,min:!0,max:!0,class:!0}),re.forEach(n),_=D(R),A=c(R,"LABEL",{class:!0});var Q=u(A);v=c(Q,"SPAN",{class:!0});var se=u(v);I=T(se,"Crawl depth"),se.forEach(n),O=D(Q),V=c(Q,"INPUT",{type:!0,min:!0,max:!0,class:!0}),Q.forEach(n),j=D(R),C&&C.l(R),L=D(R),U=c(R,"BUTTON",{class:!0});var oe=u(U);z=T(oe,"Run"),oe.forEach(n),R.forEach(n),this.h()},h(){s(a,"class","mb-6"),s(p,"class","w-32"),s(l,"class","flex items-center pb-2 mb-2 text-sm space-x-12 md:space-x-24 justify-between border-b border-gray-200 dark:border-slate-600"),s(P,"class","w-32"),s(h,"type","number"),s(h,"min","1"),s(h,"max","1000"),s(h,"class","rounded-lg flex-auto p-2 mr-1 border-2 border-gray-300"),h.required=!0,s(g,"class","flex items-center pb-2 mb-2 text-sm space-x-12 md:space-x-24 justify-between border-b border-gray-200 dark:border-slate-600"),s(v,"class","w-32"),s(V,"type","number"),s(V,"min","0"),s(V,"max","1000"),s(V,"class","rounded-lg flex-auto p-2 mr-1 border-2 border-gray-300"),V.required=!0,s(A,"class","flex items-center pb-2 mb-2 text-sm space-x-12 md:space-x-24 justify-between border-b border-gray-200 dark:border-slate-600"),s(U,"class","py-2 px-3 w-40 self-end bg-cyan-500 text-white text-sm font-semibold rounded-md shadow-lg hover:shadow-cyan-500/50 focus:outline-none"),s(t,"class",q="flex shadow-xl rounded-xl p-8 bg-white dark:bg-slate-800 flex-col mt-4 "+(o[3]&&"grayscale pointer-events-none"))},m(M,R){H(M,t,R),e(t,a),e(a,b),e(t,f),e(t,l),e(l,p),e(p,k),e(l,x),e(l,r),e(r,E),e(t,m),e(t,g),e(g,P),e(P,y),e(g,w),e(g,h),Z(h,o[2]),e(t,_),e(t,A),e(A,v),e(v,I),e(A,O),e(A,V),Z(V,o[1]),e(t,j),C&&C.m(t,null),e(t,L),e(t,U),e(U,z),F||(X=[W(h,"input",o[6]),W(V,"input",o[7]),W(U,"click",o[4])],F=!0)},p(M,[R]){R&4&&$(h.value)!==M[2]&&Z(h,M[2]),R&2&&$(V.value)!==M[1]&&Z(V,M[1]),M[0]?C?C.p(M,R):(C=vt(M),C.c(),C.m(t,L)):C&&(C.d(1),C=null),R&8&&q!==(q="flex shadow-xl rounded-xl p-8 bg-white dark:bg-slate-800 flex-col mt-4 "+(M[3]&&"grayscale pointer-events-none"))&&s(t,"class",q)},i:ae,o:ae,d(M){M&&n(t),C&&C.d(),F=!1,De(X)}}}let gt=0;function St(o,t,a){let{instance:b}=t,{progress:f={queue:0,progress:0,completed:0,size:0}}=t,l=0,p=4,k=!1;const x=async()=>{a(3,k=!0);const g=await(await be("POST","instances/crawlCollection",null,{instance_id:b.id,worker:p,depth:l})).json();console.log(g),a(3,k=!1)};function r(){p=$(this.value),a(2,p)}function E(){l=$(this.value),a(1,l)}return o.$$set=m=>{"instance"in m&&a(5,b=m.instance),"progress"in m&&a(0,f=m.progress)},[f,l,p,k,x,b,r,E]}class Dt extends ke{constructor(t){super(),Ie(this,t,St,It,Se,{instance:5,progress:0})}}function _t(o){let t,a,b,f,l=o[0].completed+"",p,k,x=o[0].size+"",r,E,m,g,P=parseInt(o[0].progress*100)+"",y,w,h,_,A;return{c(){t=i("div"),a=i("div"),b=i("div"),f=i("span"),p=N(l),k=N("/"),r=N(x),E=S(),m=i("div"),g=i("span"),y=N(P),w=N("%"),h=S(),_=i("div"),A=i("div"),this.h()},l(v){t=c(v,"DIV",{class:!0});var I=u(t);a=c(I,"DIV",{class:!0});var O=u(a);b=c(O,"DIV",{});var V=u(b);f=c(V,"SPAN",{class:!0});var j=u(f);p=T(j,l),k=T(j,"/"),r=T(j,x),j.forEach(n),V.forEach(n),E=D(O),m=c(O,"DIV",{class:!0});var L=u(m);g=c(L,"SPAN",{class:!0});var U=u(g);y=T(U,P),w=T(U,"%"),U.forEach(n),L.forEach(n),O.forEach(n),h=D(I),_=c(I,"DIV",{class:!0});var z=u(_);A=c(z,"DIV",{style:!0,class:!0}),u(A).forEach(n),z.forEach(n),I.forEach(n),this.h()},h(){s(f,"class","text-xs font-semibold inline-block py-1 px-2 uppercase rounded-full text-green-600 bg-green-200"),s(g,"class","text-xs font-semibold inline-block text-green-600"),s(m,"class","text-right"),s(a,"class","flex mb-2 items-center justify-between"),$e(A,"width",parseInt(o[0].progress*100)+"%"),s(A,"class","shadow-none flex flex-col text-center whitespace-nowrap text-white justify-center bg-green-500"),s(_,"class","overflow-hidden h-2 mb-4 text-xs flex rounded bg-green-200"),s(t,"class","relative mt-2")},m(v,I){H(v,t,I),e(t,a),e(a,b),e(b,f),e(f,p),e(f,k),e(f,r),e(a,E),e(a,m),e(m,g),e(g,y),e(g,w),e(t,h),e(t,_),e(_,A)},p(v,I){I&1&&l!==(l=v[0].completed+"")&&G(p,l),I&1&&x!==(x=v[0].size+"")&&G(r,x),I&1&&P!==(P=parseInt(v[0].progress*100)+"")&&G(y,P),I&1&&$e(A,"width",parseInt(v[0].progress*100)+"%")},d(v){v&&n(t)}}}function Pt(o){let t,a,b,f,l,p,k,x,r,E,m,g,P,y,w,h,_,A,v,I,O,V,j,L=o[0]&&_t(o);return{c(){t=i("div"),a=i("h1"),b=N("Images"),f=S(),l=i("label"),p=i("span"),k=N("Images"),x=S(),r=i("span"),E=N(wt),m=S(),g=i("label"),P=i("span"),y=N("Worker"),w=S(),h=i("input"),_=S(),L&&L.c(),A=S(),v=i("button"),I=N("Run"),this.h()},l(U){t=c(U,"DIV",{class:!0});var z=u(t);a=c(z,"H1",{class:!0});var q=u(a);b=T(q,"Images"),q.forEach(n),f=D(z),l=c(z,"LABEL",{class:!0});var F=u(l);p=c(F,"SPAN",{class:!0});var X=u(p);k=T(X,"Images"),X.forEach(n),x=D(F),r=c(F,"SPAN",{});var C=u(r);E=T(C,wt),C.forEach(n),F.forEach(n),m=D(z),g=c(z,"LABEL",{class:!0});var M=u(g);P=c(M,"SPAN",{class:!0});var R=u(P);y=T(R,"Worker"),R.forEach(n),w=D(M),h=c(M,"INPUT",{type:!0,min:!0,max:!0,class:!0}),M.forEach(n),_=D(z),L&&L.l(z),A=D(z),v=c(z,"BUTTON",{class:!0});var te=u(v);I=T(te,"Run"),te.forEach(n),z.forEach(n),this.h()},h(){s(a,"class","mb-6"),s(p,"class","w-32"),s(l,"class","flex items-center pb-2 mb-2 text-sm space-x-12 md:space-x-24 justify-between border-b border-gray-200 dark:border-slate-600"),s(P,"class","w-32"),s(h,"type","number"),s(h,"min","1"),s(h,"max","1000"),s(h,"class","rounded-lg flex-auto p-2 mr-1 border-2 border-gray-300"),h.required=!0,s(g,"class","flex items-center pb-2 mb-2 text-sm space-x-12 md:space-x-24 justify-between border-b border-gray-200 dark:border-slate-600"),s(v,"class","py-2 px-3 w-40 self-end bg-cyan-500 text-white text-sm font-semibold rounded-md shadow-lg hover:shadow-cyan-500/50 focus:outline-none"),s(t,"class",O="flex shadow-xl rounded-xl p-8 bg-white dark:bg-slate-800 flex-col mt-4 "+(o[2]&&"grayscale pointer-events-none"))},m(U,z){H(U,t,z),e(t,a),e(a,b),e(t,f),e(t,l),e(l,p),e(p,k),e(l,x),e(l,r),e(r,E),e(t,m),e(t,g),e(g,P),e(P,y),e(g,w),e(g,h),Z(h,o[1]),e(t,_),L&&L.m(t,null),e(t,A),e(t,v),e(v,I),V||(j=[W(h,"input",o[5]),W(v,"click",o[3])],V=!0)},p(U,[z]){z&2&&$(h.value)!==U[1]&&Z(h,U[1]),U[0]?L?L.p(U,z):(L=_t(U),L.c(),L.m(t,A)):L&&(L.d(1),L=null),z&4&&O!==(O="flex shadow-xl rounded-xl p-8 bg-white dark:bg-slate-800 flex-col mt-4 "+(U[2]&&"grayscale pointer-events-none"))&&s(t,"class",O)},i:ae,o:ae,d(U){U&&n(t),L&&L.d(),V=!1,De(j)}}}let wt=0;function Nt(o,t,a){let{instance:b}=t,{progress:f={queue:0,progress:0,completed:0,size:0}}=t,l=4,p=!1;const k=async()=>{a(2,p=!0);const E=await(await be("POST","instances/crawlImages",null,{instance_id:b.id,worker:l})).json();console.log(E),a(2,p=!1)};function x(){l=$(this.value),a(1,l)}return o.$$set=r=>{"instance"in r&&a(4,b=r.instance),"progress"in r&&a(0,f=r.progress)},[f,l,p,k,b,x]}class Tt extends ke{constructor(t){super(),Ie(this,t,Nt,Pt,Se,{instance:4,progress:0})}}function At(o){let t,a,b,f,l,p,k,x,r,E,m,g,P,y,w,h,_,A,v,I,O;return{c(){t=i("div"),a=i("h1"),b=N("UMAP"),f=S(),l=i("label"),p=i("span"),k=N("Neighbours"),x=S(),r=i("input"),E=S(),m=i("label"),g=i("span"),P=N("Min Distance"),y=S(),w=i("input"),h=S(),_=i("button"),A=N("Run"),this.h()},l(V){t=c(V,"DIV",{class:!0});var j=u(t);a=c(j,"H1",{class:!0});var L=u(a);b=T(L,"UMAP"),L.forEach(n),f=D(j),l=c(j,"LABEL",{class:!0});var U=u(l);p=c(U,"SPAN",{class:!0});var z=u(p);k=T(z,"Neighbours"),z.forEach(n),x=D(U),r=c(U,"INPUT",{type:!0,min:!0,max:!0,name:!0,id:!0,class:!0}),U.forEach(n),E=D(j),m=c(j,"LABEL",{class:!0});var q=u(m);g=c(q,"SPAN",{class:!0});var F=u(g);P=T(F,"Min Distance"),F.forEach(n),y=D(q),w=c(q,"INPUT",{type:!0,min:!0,max:!0,name:!0,id:!0,class:!0}),q.forEach(n),h=D(j),_=c(j,"BUTTON",{class:!0});var X=u(_);A=T(X,"Run"),X.forEach(n),j.forEach(n),this.h()},h(){s(a,"class","mb-4"),s(p,"class","w-32"),s(r,"type","number"),s(r,"min","1"),s(r,"max","200"),s(r,"name","neighbours"),s(r,"id","neighbours"),s(r,"class","rounded-lg flex-auto p-2 mr-1 border-2 border-gray-300"),r.required=!0,s(l,"class","flex items-center pb-2 mb-2 text-sm space-x-12 md:space-x-24 justify-between border-b border-gray-200 dark:border-slate-600"),s(g,"class","w-32"),s(w,"type","number"),s(w,"min","0"),s(w,"max","1"),s(w,"name","neighbours"),s(w,"id","neighbours"),s(w,"class","rounded-lg flex-auto p-2 mr-1 border-2 border-gray-300"),w.required=!0,s(m,"class","flex items-center pb-2 mb-2 text-sm space-x-12 md:space-x-24 justify-between border-b border-gray-200 dark:border-slate-600"),s(_,"class","py-2 px-3 w-40 self-end bg-cyan-500 text-white text-sm font-semibold rounded-md shadow-lg hover:shadow-cyan-500/50 focus:outline-none"),s(t,"class",v="flex shadow-xl rounded-xl p-8 bg-white dark:bg-slate-800 flex-col mt-4 "+(o[2]&&"grayscale pointer-events-none"))},m(V,j){H(V,t,j),e(t,a),e(a,b),e(t,f),e(t,l),e(l,p),e(p,k),e(l,x),e(l,r),Z(r,o[0]),e(t,E),e(t,m),e(m,g),e(g,P),e(m,y),e(m,w),Z(w,o[1]),e(t,h),e(t,_),e(_,A),I||(O=[W(r,"input",o[5]),W(w,"input",o[6]),W(_,"click",o[3])],I=!0)},p(V,[j]){j&1&&$(r.value)!==V[0]&&Z(r,V[0]),j&2&&$(w.value)!==V[1]&&Z(w,V[1]),j&4&&v!==(v="flex shadow-xl rounded-xl p-8 bg-white dark:bg-slate-800 flex-col mt-4 "+(V[2]&&"grayscale pointer-events-none"))&&s(t,"class",v)},i:ae,o:ae,d(V){V&&n(t),I=!1,De(O)}}}function Vt(o,t,a){let{instance:b}=t,f=15,l=.2,p=!1;const k=async()=>{a(2,p=!0);const m=await(await be("POST","instances/makeUmap",null,{instance_id:b.id,n_neighbors:f,min_distance:l})).json();console.log(m),a(2,p=!1)};function x(){f=$(this.value),a(0,f)}function r(){l=$(this.value),a(1,l)}return o.$$set=E=>{"instance"in E&&a(4,b=E.instance)},[f,l,p,k,b,x,r]}class jt extends ke{constructor(t){super(),Ie(this,t,Vt,At,Se,{instance:4})}}function Ut(o){let t,a,b,f,l,p,k,x,r,E,m,g,P,y,w;return{c(){t=i("div"),a=i("h1"),b=N("Feature Extraction"),f=S(),l=i("label"),p=i("span"),k=N("batchSize"),x=S(),r=i("input"),E=S(),m=i("button"),g=N("Run"),this.h()},l(h){t=c(h,"DIV",{class:!0});var _=u(t);a=c(_,"H1",{class:!0});var A=u(a);b=T(A,"Feature Extraction"),A.forEach(n),f=D(_),l=c(_,"LABEL",{class:!0});var v=u(l);p=c(v,"SPAN",{class:!0});var I=u(p);k=T(I,"batchSize"),I.forEach(n),x=D(v),r=c(v,"INPUT",{type:!0,min:!0,max:!0,name:!0,id:!0,class:!0}),v.forEach(n),E=D(_),m=c(_,"BUTTON",{class:!0});var O=u(m);g=T(O,"Run"),O.forEach(n),_.forEach(n),this.h()},h(){s(a,"class","mb-4"),s(p,"class","w-32"),s(r,"type","number"),s(r,"min","1"),s(r,"max","1024"),s(r,"name","batchSize"),s(r,"id","batchSize"),s(r,"class","rounded-lg flex-auto p-2 mr-1 border-2 border-gray-300"),r.required=!0,s(l,"class","flex items-center pb-2 mb-2 text-sm space-x-12 md:space-x-24 justify-between border-b border-gray-200 dark:border-slate-600"),s(m,"class","py-2 px-3 w-40 self-end bg-cyan-500 text-white text-sm font-semibold rounded-md shadow-lg hover:shadow-cyan-500/50 focus:outline-none"),s(t,"class",P="flex shadow-xl rounded-xl p-8 bg-white dark:bg-slate-800 flex-col mt-4 "+(o[1]&&"grayscale pointer-events-none"))},m(h,_){H(h,t,_),e(t,a),e(a,b),e(t,f),e(t,l),e(l,p),e(p,k),e(l,x),e(l,r),Z(r,o[0]),e(t,E),e(t,m),e(m,g),y||(w=[W(r,"input",o[4]),W(m,"click",o[2])],y=!0)},p(h,[_]){_&1&&$(r.value)!==h[0]&&Z(r,h[0]),_&2&&P!==(P="flex shadow-xl rounded-xl p-8 bg-white dark:bg-slate-800 flex-col mt-4 "+(h[1]&&"grayscale pointer-events-none"))&&s(t,"class",P)},i:ae,o:ae,d(h){h&&n(t),y=!1,De(w)}}}function Lt(o,t,a){let{instance:b}=t,f=64,l=!1;const p=async()=>{a(1,l=!0);const r=await(await be("POST","instances/makeFeatures",null,{instance_id:b.id,batchSize:f})).json();console.log(r),a(1,l=!1)};function k(){f=$(this.value),a(0,f)}return o.$$set=x=>{"instance"in x&&a(3,b=x.instance)},[f,l,p,b,k]}class Bt extends ke{constructor(t){super(),Ie(this,t,Lt,Ut,Se,{instance:3})}}function zt(o){let t,a,b,f,l,p,k,x,r,E,m,g,P,y,w;return{c(){t=i("div"),a=i("h1"),b=N("Spritesheets"),f=S(),l=i("label"),p=i("span"),k=N("spriteSize"),x=S(),r=i("input"),E=S(),m=i("button"),g=N("Run"),this.h()},l(h){t=c(h,"DIV",{class:!0});var _=u(t);a=c(_,"H1",{class:!0});var A=u(a);b=T(A,"Spritesheets"),A.forEach(n),f=D(_),l=c(_,"LABEL",{class:!0});var v=u(l);p=c(v,"SPAN",{class:!0});var I=u(p);k=T(I,"spriteSize"),I.forEach(n),x=D(v),r=c(v,"INPUT",{type:!0,min:!0,max:!0,name:!0,id:!0,class:!0}),v.forEach(n),E=D(_),m=c(_,"BUTTON",{class:!0});var O=u(m);g=T(O,"Run"),O.forEach(n),_.forEach(n),this.h()},h(){s(a,"class","mb-6"),s(p,"class","w-32"),s(r,"type","number"),s(r,"min","1"),s(r,"max","512"),s(r,"name","spriteSize"),s(r,"id","spriteSize"),s(r,"class","rounded-lg flex-auto p-2 mr-1 border-2 border-gray-300"),r.required=!0,s(l,"class","grayscale pointer-events-none flex items-center pb-2 mb-2 text-sm space-x-12 md:space-x-24 justify-between border-b border-gray-200 dark:border-slate-600"),s(m,"class","py-2 px-3 w-40 self-end bg-cyan-500 text-white text-sm font-semibold rounded-md shadow-lg hover:shadow-cyan-500/50 focus:outline-none"),s(t,"class",P="flex shadow-xl rounded-xl p-8 bg-white dark:bg-slate-800 flex-col mt-4 "+(o[1]&&"grayscale pointer-events-none"))},m(h,_){H(h,t,_),e(t,a),e(a,b),e(t,f),e(t,l),e(l,p),e(p,k),e(l,x),e(l,r),Z(r,o[0]),e(t,E),e(t,m),e(m,g),y||(w=[W(r,"input",o[4]),W(m,"click",o[2])],y=!0)},p(h,[_]){_&1&&$(r.value)!==h[0]&&Z(r,h[0]),_&2&&P!==(P="flex shadow-xl rounded-xl p-8 bg-white dark:bg-slate-800 flex-col mt-4 "+(h[1]&&"grayscale pointer-events-none"))&&s(t,"class",P)},i:ae,o:ae,d(h){h&&n(t),y=!1,De(w)}}}function Ot(o,t,a){let{instance:b}=t,f=128,l=!1;const p=async()=>{a(1,l=!0);const r=await(await be("POST","instances/makeSpritesheets",null,{instance_id:b.id})).json();console.log(r),a(1,l=!1)};function k(){f=$(this.value),a(0,f)}return o.$$set=x=>{"instance"in x&&a(3,b=x.instance)},[f,l,p,b,k]}class Rt extends ke{constructor(t){super(),Ie(this,t,Ot,zt,Se,{instance:3})}}function Mt(o){let t,a,b=o[0].label+"",f,l,p,k=o[0].status+"",x,r,E,m,g,P,y,w,h=o[0].iiif_url+"",_,A,v,I,O,V,j,L=o[0].id+"",U,z,q,F,X,C,M,R=new Date(o[0].created*1e3)+"",te,ne,K,le,re,Ee,Q,se,oe=o[1]?"Connected":"Disconnected",Le,Be,ze,he,J,ve,Je,Xe,ge,Ye,Ge,_e,Ke,Qe,we,et,Oe,Re,ie,Me,ce,Ce,de,qe,ue,Fe,fe,Y,tt,st;return ie=new Dt({props:{progress:o[3],instance:o[0]}}),ce=new Tt({props:{progress:o[4],instance:o[0]}}),de=new Rt({props:{instance:o[0]}}),ue=new Bt({props:{instance:o[0]}}),fe=new jt({props:{instance:o[0]}}),{c(){t=i("div"),a=i("h1"),f=N(b),l=S(),p=i("span"),x=N(k),r=S(),E=i("div"),m=i("div"),g=i("p"),P=N("Manifest URL"),y=S(),w=i("div"),_=N(h),A=S(),v=i("div"),I=i("p"),O=N("Id"),V=S(),j=i("div"),U=N(L),z=S(),q=i("div"),F=i("p"),X=N("Created"),C=S(),M=i("div"),te=N(R),ne=S(),K=i("div"),le=i("p"),re=N("Socket"),Ee=S(),Q=i("div"),se=i("span"),Le=N(oe),ze=S(),he=i("div"),J=i("div"),ve=i("button"),Je=N("Run All"),Xe=S(),ge=i("button"),Ye=N("Download Zip"),Ge=S(),_e=i("button"),Ke=N("Make Metadata"),Qe=S(),we=i("button"),et=N("Delete"),Re=S(),Ne(ie.$$.fragment),Me=S(),Ne(ce.$$.fragment),Ce=S(),Ne(de.$$.fragment),qe=S(),Ne(ue.$$.fragment),Fe=S(),Ne(fe.$$.fragment),this.h()},l(d){t=c(d,"DIV",{class:!0});var B=u(t);a=c(B,"H1",{});var pe=u(a);f=T(pe,b),l=D(pe),p=c(pe,"SPAN",{class:!0});var ye=u(p);x=T(ye,k),ye.forEach(n),pe.forEach(n),B.forEach(n),r=D(d),E=c(d,"DIV",{class:!0});var ee=u(E);m=c(ee,"DIV",{class:!0});var xe=u(m);g=c(xe,"P",{});var Pe=u(g);P=T(Pe,"Manifest URL"),Pe.forEach(n),y=D(xe),w=c(xe,"DIV",{class:!0});var at=u(w);_=T(at,h),at.forEach(n),xe.forEach(n),A=D(ee),v=c(ee,"DIV",{class:!0});var He=u(v);I=c(He,"P",{});var nt=u(I);O=T(nt,"Id"),nt.forEach(n),V=D(He),j=c(He,"DIV",{class:!0});var lt=u(j);U=T(lt,L),lt.forEach(n),He.forEach(n),z=D(ee),q=c(ee,"DIV",{class:!0});var We=u(q);F=c(We,"P",{});var rt=u(F);X=T(rt,"Created"),rt.forEach(n),C=D(We),M=c(We,"DIV",{class:!0});var ot=u(M);te=T(ot,R),ot.forEach(n),We.forEach(n),ne=D(ee),K=c(ee,"DIV",{class:!0});var Ze=u(K);le=c(Ze,"P",{});var it=u(le);re=T(it,"Socket"),it.forEach(n),Ee=D(Ze),Q=c(Ze,"DIV",{class:!0});var ct=u(Q);se=c(ct,"SPAN",{class:!0});var dt=u(se);Le=T(dt,oe),dt.forEach(n),ct.forEach(n),Ze.forEach(n),ee.forEach(n),ze=D(d),he=c(d,"DIV",{class:!0});var ut=u(he);J=c(ut,"DIV",{class:!0});var me=u(J);ve=c(me,"BUTTON",{class:!0});var ft=u(ve);Je=T(ft,"Run All"),ft.forEach(n),Xe=D(me),ge=c(me,"BUTTON",{class:!0});var pt=u(ge);Ye=T(pt,"Download Zip"),pt.forEach(n),Ge=D(me),_e=c(me,"BUTTON",{class:!0});var mt=u(_e);Ke=T(mt,"Make Metadata"),mt.forEach(n),Qe=D(me),we=c(me,"BUTTON",{class:!0});var bt=u(we);et=T(bt,"Delete"),bt.forEach(n),me.forEach(n),ut.forEach(n),Re=D(d),Te(ie.$$.fragment,d),Me=D(d),Te(ce.$$.fragment,d),Ce=D(d),Te(de.$$.fragment,d),qe=D(d),Te(ue.$$.fragment,d),Fe=D(d),Te(fe.$$.fragment,d),this.h()},h(){s(p,"class","px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-green-100 text-green-800"),s(t,"class","relative "),s(w,"class","flex items-end text-xs"),s(m,"class","flex items-center pb-2 mb-2 text-sm space-x-12 md:space-x-24 justify-between border-b border-gray-200 dark:border-slate-600"),s(j,"class","flex items-end text-xs"),s(v,"class","flex items-center pb-2 mb-2 text-sm space-x-12 md:space-x-24 justify-between border-b border-gray-200 dark:border-slate-600"),s(M,"class","flex items-end text-xs"),s(q,"class","flex items-center pb-2 mb-2 text-sm space-x-12 md:space-x-24 justify-between border-b border-gray-200 dark:border-slate-600"),s(se,"class",Be="px-2 inline-flex text-xs leading-5 font-semibold rounded-full "+(o[1]?"bg-green-100":"bg-red-100")+" text-"+(o[1]?"green-800":"red-800")),s(Q,"class","flex items-end text-xs"),s(K,"class","flex items-center pb-2 mb-2 text-sm space-x-12 md:space-x-24 justify-between border-b border-gray-200 dark:border-slate-600"),s(E,"class","flex shadow-xl rounded-xl p-8 bg-white dark:bg-slate-800 flex-col mt-7"),s(ve,"class","py-2 px-3 w-40 bg-cyan-500 text-white text-sm font-semibold rounded-md shadow-lg hover:shadow-cyan-500/50 focus:outline-none"),s(ge,"class","py-2 px-3 w-40 bg-cyan-500 text-white text-sm font-semibold rounded-md shadow-lg hover:shadow-cyan-500/50 focus:outline-none"),s(_e,"class","py-2 px-3 w-40 bg-cyan-500 text-white text-sm font-semibold rounded-md shadow-lg hover:shadow-cyan-500/50 focus:outline-none"),s(we,"class","py-2 px-3 w-32 bg-red-500 text-white text-sm font-semibold rounded-md shadow-lg hover:shadow-red-500/50 focus:outline-none"),s(J,"class",Oe="grid gap-4 grid-cols-4 "+(o[2]&&"grayscale pointer-events-none")),s(he,"class","disabled:opacity-75 shadow-xl rounded-xl p-8 bg-white dark:bg-slate-800 mt-7")},m(d,B){H(d,t,B),e(t,a),e(a,f),e(a,l),e(a,p),e(p,x),H(d,r,B),H(d,E,B),e(E,m),e(m,g),e(g,P),e(m,y),e(m,w),e(w,_),e(E,A),e(E,v),e(v,I),e(I,O),e(v,V),e(v,j),e(j,U),e(E,z),e(E,q),e(q,F),e(F,X),e(q,C),e(q,M),e(M,te),e(E,ne),e(E,K),e(K,le),e(le,re),e(K,Ee),e(K,Q),e(Q,se),e(se,Le),H(d,ze,B),H(d,he,B),e(he,J),e(J,ve),e(ve,Je),e(J,Xe),e(J,ge),e(ge,Ye),e(J,Ge),e(J,_e),e(_e,Ke),e(J,Qe),e(J,we),e(we,et),H(d,Re,B),Ae(ie,d,B),H(d,Me,B),Ae(ce,d,B),H(d,Ce,B),Ae(de,d,B),H(d,qe,B),Ae(ue,d,B),H(d,Fe,B),Ae(fe,d,B),Y=!0,tt||(st=[W(ve,"click",o[5]),W(ge,"click",o[6]),W(_e,"click",o[9]),W(we,"click",o[8])],tt=!0)},p(d,[B]){(!Y||B&1)&&b!==(b=d[0].label+"")&&G(f,b),(!Y||B&1)&&k!==(k=d[0].status+"")&&G(x,k),(!Y||B&1)&&h!==(h=d[0].iiif_url+"")&&G(_,h),(!Y||B&1)&&L!==(L=d[0].id+"")&&G(U,L),(!Y||B&1)&&R!==(R=new Date(d[0].created*1e3)+"")&&G(te,R),(!Y||B&2)&&oe!==(oe=d[1]?"Connected":"Disconnected")&&G(Le,oe),(!Y||B&2&&Be!==(Be="px-2 inline-flex text-xs leading-5 font-semibold rounded-full "+(d[1]?"bg-green-100":"bg-red-100")+" text-"+(d[1]?"green-800":"red-800")))&&s(se,"class",Be),(!Y||B&4&&Oe!==(Oe="grid gap-4 grid-cols-4 "+(d[2]&&"grayscale pointer-events-none")))&&s(J,"class",Oe);const pe={};B&8&&(pe.progress=d[3]),B&1&&(pe.instance=d[0]),ie.$set(pe);const ye={};B&16&&(ye.progress=d[4]),B&1&&(ye.instance=d[0]),ce.$set(ye);const ee={};B&1&&(ee.instance=d[0]),de.$set(ee);const xe={};B&1&&(xe.instance=d[0]),ue.$set(xe);const Pe={};B&1&&(Pe.instance=d[0]),fe.$set(Pe)},i(d){Y||(Ve(ie.$$.fragment,d),Ve(ce.$$.fragment,d),Ve(de.$$.fragment,d),Ve(ue.$$.fragment,d),Ve(fe.$$.fragment,d),Y=!0)},o(d){je(ie.$$.fragment,d),je(ce.$$.fragment,d),je(de.$$.fragment,d),je(ue.$$.fragment,d),je(fe.$$.fragment,d),Y=!1},d(d){d&&n(t),d&&n(r),d&&n(E),d&&n(ze),d&&n(he),d&&n(Re),Ue(ie,d),d&&n(Me),Ue(ce,d),d&&n(Ce),Ue(de,d),d&&n(qe),Ue(ue,d),d&&n(Fe),Ue(fe,d),tt=!1,De(st)}}}const Ct={id:"test",label:"Test Instance",iiif_url:"http://localhost:5000/instances/test",status:"ok"};async function $t({params:o,fetch:t,session:a,stuff:b}){try{const f=await be("get",`instances/${o.id}`);return{status:f.status,props:{instance:f.ok&&await f.json()}}}catch(f){return{status:f.status,props:{error:f.message,instance:Ct}}}}function qt(o,t,a){let{instance:b}=t,f=!1,l=!1,p=null,k=null;const x=new WebSocket(`ws://${ht}:${Et}/instances/${b.id}/ws`);x.onopen=y=>{console.log("eventSource.onopen",y),a(1,f=!0)},x.onerror=y=>{console.log("eventSource.onerror",y),a(1,f=!1)},x.onmessage=y=>{const w=JSON.parse(y.data);w.type!="ping"&&console.log(w),w.task&&w.task==="crawlCollection"&&a(3,p=w),w.task&&w.task==="crawlImages"&&a(4,k=w)},xt(()=>{console.log("It's destroyed"),x.close()});const r=async()=>{await m("run")},E=async()=>{await m("makeZip");const y=`${yt}://${ht}:8000/data/${b.id}/project.zip`;var w=document.createElement("a");w.href=y,w.setAttribute("download","project.zip"),w.click()},m=async y=>{a(2,l=!0);const h=await(await be("POST",`instances/${y}`,null,{instance_id:b.id})).json();return console.log(h),a(2,l=!1),h},g=async()=>{x.close();const y=await be("DELETE",`instances/${b.id}`);await y.json(),y.ok&&kt("/")},P=()=>m("makeMetadata");return o.$$set=y=>{"instance"in y&&a(0,b=y.instance)},o.$$.update=()=>{o.$$.dirty&1&&console.log(b)},[b,f,l,p,k,r,E,m,g,P]}class Jt extends ke{constructor(t){super(),Ie(this,t,qt,Mt,Se,{instance:0})}}export{Jt as default,$t as load};
