import{S as bt,i as vt,s as gt,G as ut,H as pt,a as m,d as f,b as o,g as C,I as l,M as Kt,e as h,k as x,c as _,m as D,R as wt,N as Qt,O as es,P as ts,q as oe,o as pe,V as ss,t as V,h as $,W as Lt,j as F,x as Ze,y as Fe,z as Ge,X as ls,Y as ht,C as We,Z as as,f as Rt,l as Ht,p as ns,L as os,_ as rs,n as is}from"../../chunks/index-74cce875.js";import{a as $e}from"../../chunks/api-2e72442c.js";import{l as cs,a as fs}from"../../chunks/store-09b84b1a.js";import{g as ds}from"../../chunks/navigation-0e6511d1.js";import{b as mt}from"../../chunks/paths-396f020f.js";import"../../chunks/index-cc58445c.js";import"../../chunks/singletons-d1fb5791.js";function Mt(s){let e,t,a;return{c(){e=ut("svg"),t=ut("circle"),a=ut("path"),this.h()},l(r){e=pt(r,"svg",{class:!0,xmlns:!0,fill:!0,viewBox:!0});var c=m(e);t=pt(c,"circle",{class:!0,cx:!0,cy:!0,r:!0,stroke:!0,"stroke-width":!0}),m(t).forEach(f),a=pt(c,"path",{class:!0,fill:!0,d:!0}),m(a).forEach(f),c.forEach(f),this.h()},h(){o(t,"class","opacity-25"),o(t,"cx","12"),o(t,"cy","12"),o(t,"r","10"),o(t,"stroke","currentColor"),o(t,"stroke-width","4"),o(a,"class","opacity-75"),o(a,"fill","currentColor"),o(a,"d","M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"),o(e,"class","animate-spin -ml-1 mr-3 h-5 w-5 text-white"),o(e,"xmlns","http://www.w3.org/2000/svg"),o(e,"fill","none"),o(e,"viewBox","0 0 24 24")},m(r,c){C(r,e,c),l(e,t),l(e,a)},d(r){r&&f(e)}}}function us(s){let e,t,a,r,c,u,d=s[0]&&Mt();const v=s[2].default,p=Kt(v,s,s[1],null);return{c(){e=h("button"),d&&d.c(),t=x(),p&&p.c(),this.h()},l(n){e=_(n,"BUTTON",{type:!0,class:!0});var b=m(e);d&&d.l(b),t=D(b),p&&p.l(b),b.forEach(f),this.h()},h(){o(e,"type","submit"),e.disabled=s[0],o(e,"class",a="inline-flex items-center py-2 px-3 self-end bg-cyan-500 text-white text-sm font-semibold rounded-md shadow-lg hover:shadow-cyan-500/50 focus:outline-none "+(s[0]&&"opacity-50 cursor-not-allowed"))},m(n,b){C(n,e,b),d&&d.m(e,null),l(e,t),p&&p.m(e,null),r=!0,c||(u=wt(e,"click",s[3]),c=!0)},p(n,[b]){n[0]?d||(d=Mt(),d.c(),d.m(e,t)):d&&(d.d(1),d=null),p&&p.p&&(!r||b&2)&&Qt(p,v,n,n[1],r?ts(v,n[1],b,null):es(n[1]),null),(!r||b&1)&&(e.disabled=n[0]),(!r||b&1&&a!==(a="inline-flex items-center py-2 px-3 self-end bg-cyan-500 text-white text-sm font-semibold rounded-md shadow-lg hover:shadow-cyan-500/50 focus:outline-none "+(n[0]&&"opacity-50 cursor-not-allowed")))&&o(e,"class",a)},i(n){r||(oe(p,n),r=!0)},o(n){pe(p,n),r=!1},d(n){n&&f(e),d&&d.d(),p&&p.d(n),c=!1,u()}}}function ps(s,e,t){let{$$slots:a={},$$scope:r}=e,{loading:c=!1}=e;function u(d){ss.call(this,s,d)}return s.$$set=d=>{"loading"in d&&t(0,c=d.loading),"$$scope"in d&&t(1,r=d.$$scope)},[c,r,a,u]}class _t extends bt{constructor(e){super(),vt(this,e,ps,us,gt,{loading:0})}}function Zt(s,e,t){const a=s.slice();return a[7]=e[t],a}function ms(s){let e,t,a,r,c;return{c(){e=h("input"),this.h()},l(u){e=_(u,"INPUT",{name:!0,id:!0,class:!0,type:!0,step:!0}),this.h()},h(){o(e,"name",t=s[7].name),o(e,"id",a=s[7].name),o(e,"class","rounded-lg p-2 mr-1 border-2 border-gray-300"),o(e,"type",r=s[4](s[7])),e.value=c=s[3](s[7]),o(e,"step","any")},m(u,d){C(u,e,d)},p(u,d){d&1&&t!==(t=u[7].name)&&o(e,"name",t),d&1&&a!==(a=u[7].name)&&o(e,"id",a),d&1&&r!==(r=u[4](u[7]))&&o(e,"type",r),d&1&&c!==(c=u[3](u[7]))&&e.value!==c&&(e.value=c)},d(u){u&&f(e)}}}function hs(s){let e,t,a,r,c,u,d;return{c(){e=h("input"),r=x(),c=h("input"),this.h()},l(v){e=_(v,"INPUT",{type:!0,name:!0,id:!0}),r=D(v),c=_(v,"INPUT",{type:!0,name:!0,id:!0,class:!0}),this.h()},h(){o(e,"type","hidden"),o(e,"name",t=s[7].name),o(e,"id",a=s[7].name),e.value="false",o(c,"type","checkbox"),o(c,"name",u=s[7].name),o(c,"id",d=s[7].name),o(c,"class","rounded-lg p-2 mr-1 border-2 border-gray-300"),c.value="true"},m(v,p){C(v,e,p),C(v,r,p),C(v,c,p)},p(v,p){p&1&&t!==(t=v[7].name)&&o(e,"name",t),p&1&&a!==(a=v[7].name)&&o(e,"id",a),p&1&&u!==(u=v[7].name)&&o(c,"name",u),p&1&&d!==(d=v[7].name)&&o(c,"id",d)},d(v){v&&f(e),v&&f(r),v&&f(c)}}}function Ft(s){let e,t,a=s[7].description+"",r,c,u;function d(n,b){return n[7].schema.type==="boolean"?hs:ms}let v=d(s),p=v(s);return{c(){e=h("label"),t=h("span"),r=V(a),c=x(),p.c(),this.h()},l(n){e=_(n,"LABEL",{class:!0,for:!0});var b=m(e);t=_(b,"SPAN",{class:!0});var P=m(t);r=$(P,a),P.forEach(f),c=D(b),p.l(b),b.forEach(f),this.h()},h(){o(t,"class","flex-auto"),o(e,"class","flex items-center pb-2 mb-2 text-sm space-x-12 md:space-x-24 justify-between border-b border-gray-200 dark:border-slate-600"),o(e,"for",u=s[7].name),Lt(e,"hidden",s[7].name==="instance_id")},m(n,b){C(n,e,b),l(e,t),l(t,r),l(e,c),p.m(e,null)},p(n,b){b&1&&a!==(a=n[7].description+"")&&F(r,a),v===(v=d(n))&&p?p.p(n,b):(p.d(1),p=v(n),p&&(p.c(),p.m(e,null))),b&1&&u!==(u=n[7].name)&&o(e,"for",u),b&1&&Lt(e,"hidden",n[7].name==="instance_id")},d(n){n&&f(e),p.d()}}}function _s(s){let e;return{c(){e=V("Run")},l(t){e=$(t,"Run")},m(t,a){C(t,e,a)},d(t){t&&f(e)}}}function bs(s){let e,t,a=s[0].name+"",r,c,u,d=s[0].description+"",v,p,n,b,P,U,M,O,E=s[0].parameters,g=[];for(let w=0;w<E.length;w+=1)g[w]=Ft(Zt(s,E,w));return P=new _t({props:{loading:s[1],$$slots:{default:[_s]},$$scope:{ctx:s}}}),{c(){e=h("div"),t=h("h1"),r=V(a),c=x(),u=h("p"),v=V(d),p=x(),n=h("form");for(let w=0;w<g.length;w+=1)g[w].c();b=x(),Ze(P.$$.fragment),this.h()},l(w){e=_(w,"DIV",{class:!0});var y=m(e);t=_(y,"H1",{class:!0});var A=m(t);r=$(A,a),A.forEach(f),c=D(y),u=_(y,"P",{class:!0});var S=m(u);v=$(S,d),S.forEach(f),p=D(y),n=_(y,"FORM",{});var T=m(n);for(let z=0;z<g.length;z+=1)g[z].l(T);b=D(T),Fe(P.$$.fragment,T),T.forEach(f),y.forEach(f),this.h()},h(){o(t,"class","mb-2"),o(u,"class","text-sm mb-4"),o(e,"class","flex shadow-xl rounded-xl p-8 bg-white dark:bg-slate-800 flex-col mt-4 ")},m(w,y){C(w,e,y),l(e,t),l(t,r),l(e,c),l(e,u),l(u,v),l(e,p),l(e,n);for(let A=0;A<g.length;A+=1)g[A]&&g[A].m(n,null);l(n,b),Ge(P,n,null),U=!0,M||(O=wt(n,"submit",ls(s[2])),M=!0)},p(w,[y]){if((!U||y&1)&&a!==(a=w[0].name+"")&&F(r,a),(!U||y&1)&&d!==(d=w[0].description+"")&&F(v,d),y&25){E=w[0].parameters;let S;for(S=0;S<E.length;S+=1){const T=Zt(w,E,S);g[S]?g[S].p(T,y):(g[S]=Ft(T),g[S].c(),g[S].m(n,b))}for(;S<g.length;S+=1)g[S].d(1);g.length=E.length}const A={};y&2&&(A.loading=w[1]),y&1024&&(A.$$scope={dirty:y,ctx:w}),P.$set(A)},i(w){U||(oe(P.$$.fragment,w),U=!0)},o(w){pe(P.$$.fragment,w),U=!1},d(w){w&&f(e),ht(g,w),We(P),M=!1,O()}}}function vs(s,e,t){const a=as();let{instance:r}=e,{path:c}=e;console.log(c);let u=!1;const d=async n=>{t(1,u=!0);const b=new FormData(n.target),P={};for(let O of b){const[E,g]=O;P[E]=g}await(await $e(c.method,c.path,null,P)).json();const M=c.path.split("/").pop();a("completed",{name:M}),t(1,u=!1)},v=n=>n.name==="instance_id"?r.id:n.schema.default,p=n=>{const b=n.schema.type;return b==="number"||b==="integer"?"number":b==="boolean"?"checkbox":"text"};return s.$$set=n=>{"instance"in n&&t(5,r=n.instance),"path"in n&&t(0,c=n.path)},[c,u,d,v,p,r]}class gs extends bt{constructor(e){super(),vt(this,e,vs,bs,gt,{instance:5,path:0})}}function Gt(s,e,t){const a=s.slice();return a[13]=e[t],a}function Wt(s,e,t){const a=s.slice();return a[16]=e[t],a}function qt(s){let e,t=s[16]+"",a,r,c;return{c(){e=h("span"),a=V(t),r=x(),this.h()},l(u){e=_(u,"SPAN",{class:!0});var d=m(e);a=$(d,t),r=D(d),d.forEach(f),this.h()},h(){o(e,"class",c="px-2 inline-flex text-xs leading-5 font-semibold rounded-full "+(s[0][s[16]]?"bg-green-100":"bg-red-100")+" text-"+(s[0][s[16]]?"green-800":"red-800"))},m(u,d){C(u,e,d),l(e,a),l(e,r)},p(u,d){d&1&&c!==(c="px-2 inline-flex text-xs leading-5 font-semibold rounded-full "+(u[0][u[16]]?"bg-green-100":"bg-red-100")+" text-"+(u[0][u[16]]?"green-800":"red-800"))&&o(e,"class",c)},d(u){u&&f(e)}}}function ws(s){let e;return{c(){e=V("Generate Instance")},l(t){e=$(t,"Generate Instance")},m(t,a){C(t,e,a)},d(t){t&&f(e)}}}function ks(s){let e;return{c(){e=V("Download ZIP")},l(t){e=$(t,"Download ZIP")},m(t,a){C(t,e,a)},d(t){t&&f(e)}}}function Jt(s){let e,t,a,r,c=s[3].task+"",u,d,v,p=s[3].completed+"",n,b,P=s[3].size+"",U,M,O,E,g=parseInt(s[3].progress*100)+"",w,y,A,S,T;return{c(){e=h("div"),t=h("div"),a=h("div"),r=h("span"),u=V(c),d=x(),v=h("span"),n=V(p),b=V("/"),U=V(P),M=x(),O=h("div"),E=h("span"),w=V(g),y=V("%"),A=x(),S=h("div"),T=h("div"),this.h()},l(z){e=_(z,"DIV",{class:!0});var B=m(e);t=_(B,"DIV",{class:!0});var q=m(t);a=_(q,"DIV",{});var ee=m(a);r=_(ee,"SPAN",{class:!0});var G=m(r);u=$(G,c),G.forEach(f),d=D(ee),v=_(ee,"SPAN",{class:!0});var W=m(v);n=$(W,p),b=$(W,"/"),U=$(W,P),W.forEach(f),ee.forEach(f),M=D(q),O=_(q,"DIV",{class:!0});var me=m(O);E=_(me,"SPAN",{class:!0});var re=m(E);w=$(re,g),y=$(re,"%"),re.forEach(f),me.forEach(f),q.forEach(f),A=D(B),S=_(B,"DIV",{class:!0});var J=m(S);T=_(J,"DIV",{style:!0,class:!0}),m(T).forEach(f),J.forEach(f),B.forEach(f),this.h()},h(){o(r,"class","text-xs font-semibold inline-block py-1 px-2 uppercase rounded-full text-green-600 bg-green-200"),o(v,"class","text-xs font-semibold inline-block py-1 px-2 uppercase rounded-full text-green-600 bg-green-200"),o(E,"class","text-xs font-semibold inline-block text-green-600"),o(O,"class","text-right"),o(t,"class","flex mb-2 items-center justify-between"),Rt(T,"width",parseInt(s[3].progress*100)+"%"),o(T,"class","shadow-none flex flex-col text-center whitespace-nowrap text-white justify-center bg-green-500"),o(S,"class","overflow-hidden h-2 mb-2 text-xs flex rounded bg-green-200"),o(e,"class","sticky top-0 flex shadow-xl rounded-xl p-4 bg-slate-100 dark:bg-slate-800 flex-col mt-3")},m(z,B){C(z,e,B),l(e,t),l(t,a),l(a,r),l(r,u),l(a,d),l(a,v),l(v,n),l(v,b),l(v,U),l(t,M),l(t,O),l(O,E),l(E,w),l(E,y),l(e,A),l(e,S),l(S,T)},p(z,B){B&8&&c!==(c=z[3].task+"")&&F(u,c),B&8&&p!==(p=z[3].completed+"")&&F(n,p),B&8&&P!==(P=z[3].size+"")&&F(U,P),B&8&&g!==(g=parseInt(z[3].progress*100)+"")&&F(w,g),B&8&&Rt(T,"width",parseInt(z[3].progress*100)+"%")},d(z){z&&f(e)}}}function Xt(s){let e,t;return e=new gs({props:{instance:s[0],path:s[13]}}),e.$on("completed",s[9]),{c(){Ze(e.$$.fragment)},l(a){Fe(e.$$.fragment,a)},m(a,r){Ge(e,a,r),t=!0},p(a,r){const c={};r&1&&(c.instance=a[0]),r&16&&(c.path=a[13]),e.$set(c)},i(a){t||(oe(e.$$.fragment,a),t=!0)},o(a){pe(e.$$.fragment,a),t=!1},d(a){We(e,a)}}}function Es(s){let e,t,a,r,c,u,d=s[0].label+"",v,p,n,b,P,U,M,O,E=s[0].iiif_url+"",g,w,y,A,S,T,z,B=s[0].id+"",q,ee,G,W,me,re,J,Ee=new Date(s[0].created*1e3)+"",Pe,qe,te,Ie,Je,Xe,he,ie,xe=s[1]?"Connected":"Disconnected",Se,je,Ye,se,De,Ke,Qe,_e,X,et,ze,tt,le,ye,st,lt,be,Y,at,Ne,nt,ae,Ve,ot,rt,ce,it,ne,K,ct,Q,Ae,ve,fe,ft,Ce,ge,Z,dt,kt,we=s[5],L=[];for(let i=0;i<we.length;i+=1)L[i]=qt(Wt(s,we,i));K=new _t({props:{loading:s[2].all,$$slots:{default:[ws]},$$scope:{ctx:s}}}),K.$on("click",s[6]),Q=new _t({props:{loading:s[2].zip,$$slots:{default:[ks]},$$scope:{ctx:s}}}),Q.$on("click",s[7]);let R=s[3]&&Jt(s),de=s[4],j=[];for(let i=0;i<de.length;i+=1)j[i]=Xt(Gt(s,de,i));const Yt=i=>pe(j[i],1,1,()=>{j[i]=null});return{c(){e=h("div"),t=h("div"),a=h("button"),r=V("Delete"),c=x(),u=h("h1"),v=V(d),p=x(),n=h("div"),b=h("div"),P=h("p"),U=V("Manifest URL"),M=x(),O=h("div"),g=V(E),w=x(),y=h("div"),A=h("p"),S=V("Id"),T=x(),z=h("div"),q=V(B),ee=x(),G=h("div"),W=h("p"),me=V("Created"),re=x(),J=h("div"),Pe=V(Ee),qe=x(),te=h("div"),Ie=h("p"),Je=V("Socket"),Xe=x(),he=h("div"),ie=h("span"),Se=V(xe),Ye=x(),se=h("div"),De=h("p"),Ke=V("Vikus Viewer"),Qe=x(),_e=h("div"),X=h("a"),et=V("Open"),tt=x(),le=h("div"),ye=h("p"),st=V("Data Dir"),lt=x(),be=h("div"),Y=h("a"),at=V("Open"),nt=x(),ae=h("div"),Ve=h("p"),ot=V("Status"),rt=x(),ce=h("div");for(let i=0;i<L.length;i+=1)L[i].c();it=x(),ne=h("div"),Ze(K.$$.fragment),ct=x(),Ze(Q.$$.fragment),Ae=x(),R&&R.c(),ve=x(),fe=h("h2"),ft=V("Advanced Settings"),Ce=x();for(let i=0;i<j.length;i+=1)j[i].c();ge=Ht(),this.h()},l(i){e=_(i,"DIV",{class:!0});var k=m(e);t=_(k,"DIV",{class:!0});var H=m(t);a=_(H,"BUTTON",{class:!0});var ke=m(a);r=$(ke,"Delete"),ke.forEach(f),H.forEach(f),c=D(k),u=_(k,"H1",{});var I=m(u);v=$(I,d),I.forEach(f),k.forEach(f),p=D(i),n=_(i,"DIV",{class:!0});var N=m(n);b=_(N,"DIV",{class:!0});var Oe=m(b);P=_(Oe,"P",{});var Et=m(P);U=$(Et,"Manifest URL"),Et.forEach(f),M=D(Oe),O=_(Oe,"DIV",{class:!0});var It=m(O);g=$(It,E),It.forEach(f),Oe.forEach(f),w=D(N),y=_(N,"DIV",{class:!0});var Te=m(y);A=_(Te,"P",{});var xt=m(A);S=$(xt,"Id"),xt.forEach(f),T=D(Te),z=_(Te,"DIV",{class:!0});var Dt=m(z);q=$(Dt,B),Dt.forEach(f),Te.forEach(f),ee=D(N),G=_(N,"DIV",{class:!0});var Ue=m(G);W=_(Ue,"P",{});var yt=m(W);me=$(yt,"Created"),yt.forEach(f),re=D(Ue),J=_(Ue,"DIV",{class:!0});var Vt=m(J);Pe=$(Vt,Ee),Vt.forEach(f),Ue.forEach(f),qe=D(N),te=_(N,"DIV",{class:!0});var Be=m(te);Ie=_(Be,"P",{});var $t=m(Ie);Je=$($t,"Socket"),$t.forEach(f),Xe=D(Be),he=_(Be,"DIV",{class:!0});var Pt=m(he);ie=_(Pt,"SPAN",{class:!0});var St=m(ie);Se=$(St,xe),St.forEach(f),Pt.forEach(f),Be.forEach(f),Ye=D(N),se=_(N,"DIV",{class:!0});var Le=m(se);De=_(Le,"P",{});var jt=m(De);Ke=$(jt,"Vikus Viewer"),jt.forEach(f),Qe=D(Le),_e=_(Le,"DIV",{class:!0});var zt=m(_e);X=_(zt,"A",{target:!0,class:!0,href:!0});var Nt=m(X);et=$(Nt,"Open"),Nt.forEach(f),zt.forEach(f),Le.forEach(f),tt=D(N),le=_(N,"DIV",{class:!0});var Re=m(le);ye=_(Re,"P",{});var At=m(ye);st=$(At,"Data Dir"),At.forEach(f),lt=D(Re),be=_(Re,"DIV",{class:!0});var Ct=m(be);Y=_(Ct,"A",{target:!0,class:!0,href:!0});var Ot=m(Y);at=$(Ot,"Open"),Ot.forEach(f),Ct.forEach(f),Re.forEach(f),nt=D(N),ae=_(N,"DIV",{class:!0});var He=m(ae);Ve=_(He,"P",{});var Tt=m(Ve);ot=$(Tt,"Status"),Tt.forEach(f),rt=D(He),ce=_(He,"DIV",{class:!0});var Ut=m(ce);for(let ue=0;ue<L.length;ue+=1)L[ue].l(Ut);Ut.forEach(f),He.forEach(f),it=D(N),ne=_(N,"DIV",{class:!0});var Me=m(ne);Fe(K.$$.fragment,Me),ct=D(Me),Fe(Q.$$.fragment,Me),Me.forEach(f),N.forEach(f),Ae=D(i),R&&R.l(i),ve=D(i),fe=_(i,"H2",{class:!0});var Bt=m(fe);ft=$(Bt,"Advanced Settings"),Bt.forEach(f),Ce=D(i);for(let ue=0;ue<j.length;ue+=1)j[ue].l(i);ge=Ht(),this.h()},h(){o(a,"class","p-1 pl-2 pr-2 bg-red-700 text-white text-sm font-semibold rounded-md shadow-lg hover:shadow-red-500/50 focus:outline-none"),o(t,"class","absolute top-0 right-0"),o(e,"class","relative "),o(O,"class","flex items-end text-xs"),o(b,"class","flex items-center pb-2 mb-2 text-sm space-x-12 md:space-x-24 justify-between border-b border-gray-200 dark:border-slate-600"),o(z,"class","flex items-end text-xs"),o(y,"class","flex items-center pb-2 mb-2 text-sm space-x-12 md:space-x-24 justify-between border-b border-gray-200 dark:border-slate-600"),o(J,"class","flex items-end text-xs"),o(G,"class","flex items-center pb-2 mb-2 text-sm space-x-12 md:space-x-24 justify-between border-b border-gray-200 dark:border-slate-600"),o(ie,"class",je="px-2 inline-flex text-xs leading-5 font-semibold rounded-full "+(s[1]?"bg-green-100":"bg-red-100")+" text-"+(s[1]?"green-800":"red-800")),o(he,"class","flex items-end text-xs"),o(te,"class","flex items-center pb-2 mb-2 text-sm space-x-12 md:space-x-24 justify-between border-b border-gray-200 dark:border-slate-600"),o(X,"target","_blank"),o(X,"class","font-semibold rounded-full px-2 bg-blue-100"),o(X,"href",ze="/viewer/?config=../data/"+s[0].id+"/config.json"),o(_e,"class","flex items-end text-xs"),o(se,"class","flex items-center pb-2 mb-2 text-sm space-x-12 md:space-x-24 justify-between border-b border-gray-200 dark:border-slate-600"),o(Y,"target","_blank"),o(Y,"class","font-semibold rounded-full px-2 bg-blue-100"),o(Y,"href",Ne="/data/"+s[0].id),o(be,"class","flex items-end text-xs"),o(le,"class","flex items-center pb-2 mb-2 text-sm space-x-12 md:space-x-24 justify-between border-b border-gray-200 dark:border-slate-600"),o(ce,"class","flex items-end text-xs"),o(ae,"class","flex items-center pb-2 mb-2 text-sm space-x-12 md:space-x-24 justify-between border-b border-gray-200 dark:border-slate-600"),o(ne,"class","flex justify-between mt-8"),o(n,"class","flex shadow-xl rounded-xl p-8 bg-white dark:bg-slate-800 flex-col mt-7 mb-4"),o(fe,"class","mt-8 mb-6")},m(i,k){C(i,e,k),l(e,t),l(t,a),l(a,r),l(e,c),l(e,u),l(u,v),C(i,p,k),C(i,n,k),l(n,b),l(b,P),l(P,U),l(b,M),l(b,O),l(O,g),l(n,w),l(n,y),l(y,A),l(A,S),l(y,T),l(y,z),l(z,q),l(n,ee),l(n,G),l(G,W),l(W,me),l(G,re),l(G,J),l(J,Pe),l(n,qe),l(n,te),l(te,Ie),l(Ie,Je),l(te,Xe),l(te,he),l(he,ie),l(ie,Se),l(n,Ye),l(n,se),l(se,De),l(De,Ke),l(se,Qe),l(se,_e),l(_e,X),l(X,et),l(n,tt),l(n,le),l(le,ye),l(ye,st),l(le,lt),l(le,be),l(be,Y),l(Y,at),l(n,nt),l(n,ae),l(ae,Ve),l(Ve,ot),l(ae,rt),l(ae,ce);for(let H=0;H<L.length;H+=1)L[H]&&L[H].m(ce,null);l(n,it),l(n,ne),Ge(K,ne,null),l(ne,ct),Ge(Q,ne,null),C(i,Ae,k),R&&R.m(i,k),C(i,ve,k),C(i,fe,k),l(fe,ft),C(i,Ce,k);for(let H=0;H<j.length;H+=1)j[H]&&j[H].m(i,k);C(i,ge,k),Z=!0,dt||(kt=wt(a,"click",s[8]),dt=!0)},p(i,[k]){if((!Z||k&1)&&d!==(d=i[0].label+"")&&F(v,d),(!Z||k&1)&&E!==(E=i[0].iiif_url+"")&&F(g,E),(!Z||k&1)&&B!==(B=i[0].id+"")&&F(q,B),(!Z||k&1)&&Ee!==(Ee=new Date(i[0].created*1e3)+"")&&F(Pe,Ee),(!Z||k&2)&&xe!==(xe=i[1]?"Connected":"Disconnected")&&F(Se,xe),(!Z||k&2&&je!==(je="px-2 inline-flex text-xs leading-5 font-semibold rounded-full "+(i[1]?"bg-green-100":"bg-red-100")+" text-"+(i[1]?"green-800":"red-800")))&&o(ie,"class",je),(!Z||k&1&&ze!==(ze="/viewer/?config=../data/"+i[0].id+"/config.json"))&&o(X,"href",ze),(!Z||k&1&&Ne!==(Ne="/data/"+i[0].id))&&o(Y,"href",Ne),k&33){we=i[5];let I;for(I=0;I<we.length;I+=1){const N=Wt(i,we,I);L[I]?L[I].p(N,k):(L[I]=qt(N),L[I].c(),L[I].m(ce,null))}for(;I<L.length;I+=1)L[I].d(1);L.length=we.length}const H={};k&4&&(H.loading=i[2].all),k&524288&&(H.$$scope={dirty:k,ctx:i}),K.$set(H);const ke={};if(k&4&&(ke.loading=i[2].zip),k&524288&&(ke.$$scope={dirty:k,ctx:i}),Q.$set(ke),i[3]?R?R.p(i,k):(R=Jt(i),R.c(),R.m(ve.parentNode,ve)):R&&(R.d(1),R=null),k&529){de=i[4];let I;for(I=0;I<de.length;I+=1){const N=Gt(i,de,I);j[I]?(j[I].p(N,k),oe(j[I],1)):(j[I]=Xt(N),j[I].c(),oe(j[I],1),j[I].m(ge.parentNode,ge))}for(is(),I=de.length;I<j.length;I+=1)Yt(I);ns()}},i(i){if(!Z){oe(K.$$.fragment,i),oe(Q.$$.fragment,i);for(let k=0;k<de.length;k+=1)oe(j[k]);Z=!0}},o(i){pe(K.$$.fragment,i),pe(Q.$$.fragment,i),j=j.filter(Boolean);for(let k=0;k<j.length;k+=1)pe(j[k]);Z=!1},d(i){i&&f(e),i&&f(p),i&&f(n),ht(L,i),We(K),We(Q),i&&f(Ae),R&&R.d(i),i&&f(ve),i&&f(fe),i&&f(Ce),ht(j,i),i&&f(ge),dt=!1,kt()}}}const Is={id:"test",label:"Disconnected Instance",iiif_url:"http://localhost:5000/instances/test",status:"ok"};async function zs({params:s,fetch:e,session:t,stuff:a}){try{const r=await $e("get",`/instances/${s.id}`);return{status:r.status,props:{instance:r.ok&&await r.json()}}}catch(r){return{status:r.status,props:{error:r.message,instance:Is}}}}function xs(s,e,t){let a;os(s,fs,E=>t(4,a=E));let{instance:r}=e,c=!1,u={all:!1,zip:!1},d=!1,v=["collection","images","features","similarity","metadata","spritesheets","zip"],p=null;function n(){console.log("connection to websocket"),p&&p.close();const E=window.location.protocol==="https:"?"wss:":"ws:";p=new WebSocket(`${E}//${window.location.host}/api/instances/${r.id}/ws`),p.onopen=g=>{console.log("eventSource.onopen",g),t(1,c=!0)},p.onerror=g=>{console.log("eventSource.onerror",g),t(1,c=!1)},p.onclose=g=>{console.log("eventSource.onclose",g),t(1,c=!1)},p.onmessage=g=>{const w=JSON.parse(g.data);w.type!="ping"&&console.log(w),w.task&&t(3,d=w)}}const b=setInterval(()=>{c||n()},2e3);rs(()=>{console.log("It's destroyed"),t(1,c=!1),p.close(),clearInterval(b)});const P=async()=>{t(2,u={all:!0,zip:!1});const g=await(await $e("POST","/instances/generate",null,{instance_id:r.id})).json();console.log(g),t(2,u={all:!1,zip:!1}),t(0,r=g)},U=async()=>{t(2,u={all:!1,zip:!0}),await(await $e("POST","/instances/steps/zip",null,{instance_id:r.id})).json();const g=`/data/${r.id}/project.zip`;var w=document.createElement("a");w.href=g,w.setAttribute("download","project.zip"),w.click(),t(2,u={all:!1,zip:!1})},M=async()=>{p.close(),(await(await $e("DELETE",`/instances/${r.id}`)).json()).status=="deleted"&&(cs(),ds(mt?mt:"/"))};function O({detail:{name:E}}){console.log("formCompleted",E),r&&t(0,r[E]=!0,r)}return console.log("base",mt),s.$$set=E=>{"instance"in E&&t(0,r=E.instance)},s.$$.update=()=>{s.$$.dirty&1&&(console.log(r),t(3,d=!1),t(1,c=!1),n())},[r,c,u,d,a,v,P,U,M,O]}class Ns extends bt{constructor(e){super(),vt(this,e,xs,Es,gt,{instance:0})}}export{Ns as default,zs as load};
