import{S as Be,i as Ce,s as Me,e as l,t as D,k,c as n,a as i,h as N,d as a,m as I,b as s,f as je,g as R,H as e,j as K,W as se,O as G,X as ae,E as xe,T as Le,w as Ke,x as Qe,y as $e,q as et,o as tt,B as st,Y as It}from"../../chunks/index-ce9f2381.js";import{b as Ee,d as wt,a as Dt,p as Nt}from"../../chunks/api-a139c5d6.js";import{g as Pt}from"../../chunks/navigation-0e6511d1.js";import"../../chunks/singletons-d1fb5791.js";function xt(o){let r,c,p,t,d=o[0].completed+"",m,V,P=o[0].size+"",b,E,g,h,U=parseInt(o[0].progress*100)+"",C,A,u,_,S;return{c(){r=l("div"),c=l("div"),p=l("div"),t=l("span"),m=D(d),V=D("/"),b=D(P),E=k(),g=l("div"),h=l("span"),C=D(U),A=D("%"),u=k(),_=l("div"),S=l("div"),this.h()},l(v){r=n(v,"DIV",{class:!0});var y=i(r);c=n(y,"DIV",{class:!0});var q=i(c);p=n(q,"DIV",{});var w=i(p);t=n(w,"SPAN",{class:!0});var j=i(t);m=N(j,d),V=N(j,"/"),b=N(j,P),j.forEach(a),w.forEach(a),E=I(q),g=n(q,"DIV",{class:!0});var T=i(g);h=n(T,"SPAN",{class:!0});var x=i(h);C=N(x,U),A=N(x,"%"),x.forEach(a),T.forEach(a),q.forEach(a),u=I(y),_=n(y,"DIV",{class:!0});var L=i(_);S=n(L,"DIV",{style:!0,class:!0}),i(S).forEach(a),L.forEach(a),y.forEach(a),this.h()},h(){s(t,"class","text-xs font-semibold inline-block py-1 px-2 uppercase rounded-full text-green-600 bg-green-200"),s(h,"class","text-xs font-semibold inline-block text-green-600"),s(g,"class","text-right"),s(c,"class","flex mb-2 items-center justify-between"),je(S,"width",parseInt(o[0].progress*100)+"%"),s(S,"class","shadow-none flex flex-col text-center whitespace-nowrap text-white justify-center bg-green-500"),s(_,"class","overflow-hidden h-2 mb-4 text-xs flex rounded bg-green-200"),s(r,"class","relative mt-2")},m(v,y){R(v,r,y),e(r,c),e(c,p),e(p,t),e(t,m),e(t,V),e(t,b),e(c,E),e(c,g),e(g,h),e(h,C),e(h,A),e(r,u),e(r,_),e(_,S)},p(v,y){y&1&&d!==(d=v[0].completed+"")&&K(m,d),y&1&&P!==(P=v[0].size+"")&&K(b,P),y&1&&U!==(U=parseInt(v[0].progress*100)+"")&&K(C,U),y&1&&je(S,"width",parseInt(v[0].progress*100)+"%")},d(v){v&&a(r)}}}function St(o){let r,c,p,t,d,m,V,P,b,E,g,h,U,C,A,u,_,S,v,y,q,w,j,T,x,L,O,H,J,z=o[0]&&xt(o);return{c(){r=l("h1"),c=D("Collection"),p=k(),t=l("div"),d=l("label"),m=l("span"),V=D("Manifests"),P=k(),b=l("span"),E=D(Et),g=k(),h=l("label"),U=l("span"),C=D("Worker"),A=k(),u=l("input"),_=k(),S=l("label"),v=l("span"),y=D("Crawl depth"),q=k(),w=l("input"),j=k(),z&&z.c(),T=k(),x=l("button"),L=D("Crawl Collection"),this.h()},l(B){r=n(B,"H1",{class:!0});var F=i(r);c=N(F,"Collection"),F.forEach(a),p=I(B),t=n(B,"DIV",{class:!0});var W=i(t);d=n(W,"LABEL",{class:!0});var le=i(d);m=n(le,"SPAN",{class:!0});var Q=i(m);V=N(Q,"Manifests"),Q.forEach(a),P=I(le),b=n(le,"SPAN",{});var ne=i(b);E=N(ne,Et),ne.forEach(a),le.forEach(a),g=I(W),h=n(W,"LABEL",{class:!0});var re=i(h);U=n(re,"SPAN",{class:!0});var _e=i(U);C=N(_e,"Worker"),_e.forEach(a),A=I(re),u=n(re,"INPUT",{type:!0,min:!0,max:!0,class:!0}),re.forEach(a),_=I(W),S=n(W,"LABEL",{class:!0});var $=i(S);v=n($,"SPAN",{class:!0});var te=i(v);y=N(te,"Crawl depth"),te.forEach(a),q=I($),w=n($,"INPUT",{type:!0,min:!0,max:!0,class:!0}),$.forEach(a),j=I(W),z&&z.l(W),T=I(W),x=n(W,"BUTTON",{class:!0});var oe=i(x);L=N(oe,"Crawl Collection"),oe.forEach(a),W.forEach(a),this.h()},h(){s(r,"class","mt-6"),s(m,"class","w-32"),s(d,"class","flex items-center pb-2 mb-2 text-sm space-x-12 md:space-x-24 justify-between border-b border-gray-200 dark:border-slate-600"),s(U,"class","w-32"),s(u,"type","number"),s(u,"min","1"),s(u,"max","1000"),s(u,"class","rounded-lg flex-auto p-2 mr-1 border-2 border-gray-300"),u.required=!0,s(h,"class","flex items-center pb-2 mb-2 text-sm space-x-12 md:space-x-24 justify-between border-b border-gray-200 dark:border-slate-600"),s(v,"class","w-32"),s(w,"type","number"),s(w,"min","0"),s(w,"max","1000"),s(w,"class","rounded-lg flex-auto p-2 mr-1 border-2 border-gray-300"),w.required=!0,s(S,"class","flex items-center pb-2 mb-2 text-sm space-x-12 md:space-x-24 justify-between border-b border-gray-200 dark:border-slate-600"),s(x,"class","py-2 px-3 w-40 bg-cyan-500 text-white text-sm font-semibold rounded-md shadow-lg hover:shadow-cyan-500/50 focus:outline-none"),s(t,"class",O="flex shadow-xl rounded-xl p-8 bg-white dark:bg-slate-800 flex-col mt-4 "+(o[3]&&"grayscale pointer-events-none"))},m(B,F){R(B,r,F),e(r,c),R(B,p,F),R(B,t,F),e(t,d),e(d,m),e(m,V),e(d,P),e(d,b),e(b,E),e(t,g),e(t,h),e(h,U),e(U,C),e(h,A),e(h,u),se(u,o[2]),e(t,_),e(t,S),e(S,v),e(v,y),e(S,q),e(S,w),se(w,o[1]),e(t,j),z&&z.m(t,null),e(t,T),e(t,x),e(x,L),H||(J=[G(u,"input",o[6]),G(w,"input",o[7]),G(x,"click",o[4])],H=!0)},p(B,[F]){F&4&&ae(u.value)!==B[2]&&se(u,B[2]),F&2&&ae(w.value)!==B[1]&&se(w,B[1]),B[0]?z?z.p(B,F):(z=xt(B),z.c(),z.m(t,T)):z&&(z.d(1),z=null),F&8&&O!==(O="flex shadow-xl rounded-xl p-8 bg-white dark:bg-slate-800 flex-col mt-4 "+(B[3]&&"grayscale pointer-events-none"))&&s(t,"class",O)},i:xe,o:xe,d(B){B&&a(r),B&&a(p),B&&a(t),z&&z.d(),H=!1,Le(J)}}}let Et=0;function Tt(o,r,c){let{instance:p}=r,{progress:t={queue:0,progress:0,completed:0,size:0}}=r,d=0,m=4,V=!1;const P=async()=>{c(3,V=!0);const h=await(await Ee("POST","instances/crawlCollection",null,{instance_id:p.id,worker:m,depth:d})).json();console.log(h),c(3,V=!1)};function b(){m=ae(this.value),c(2,m)}function E(){d=ae(this.value),c(1,d)}return o.$$set=g=>{"instance"in g&&c(5,p=g.instance),"progress"in g&&c(0,t=g.progress)},[t,d,m,V,P,p,b,E]}class At extends Be{constructor(r){super(),Ce(this,r,Tt,St,Me,{instance:5,progress:0})}}function yt(o){let r,c,p,t,d=o[0].completed+"",m,V,P=o[0].size+"",b,E,g,h,U=parseInt(o[0].progress*100)+"",C,A,u,_,S;return{c(){r=l("div"),c=l("div"),p=l("div"),t=l("span"),m=D(d),V=D("/"),b=D(P),E=k(),g=l("div"),h=l("span"),C=D(U),A=D("%"),u=k(),_=l("div"),S=l("div"),this.h()},l(v){r=n(v,"DIV",{class:!0});var y=i(r);c=n(y,"DIV",{class:!0});var q=i(c);p=n(q,"DIV",{});var w=i(p);t=n(w,"SPAN",{class:!0});var j=i(t);m=N(j,d),V=N(j,"/"),b=N(j,P),j.forEach(a),w.forEach(a),E=I(q),g=n(q,"DIV",{class:!0});var T=i(g);h=n(T,"SPAN",{class:!0});var x=i(h);C=N(x,U),A=N(x,"%"),x.forEach(a),T.forEach(a),q.forEach(a),u=I(y),_=n(y,"DIV",{class:!0});var L=i(_);S=n(L,"DIV",{style:!0,class:!0}),i(S).forEach(a),L.forEach(a),y.forEach(a),this.h()},h(){s(t,"class","text-xs font-semibold inline-block py-1 px-2 uppercase rounded-full text-green-600 bg-green-200"),s(h,"class","text-xs font-semibold inline-block text-green-600"),s(g,"class","text-right"),s(c,"class","flex mb-2 items-center justify-between"),je(S,"width",parseInt(o[0].progress*100)+"%"),s(S,"class","shadow-none flex flex-col text-center whitespace-nowrap text-white justify-center bg-green-500"),s(_,"class","overflow-hidden h-2 mb-4 text-xs flex rounded bg-green-200"),s(r,"class","relative mt-2")},m(v,y){R(v,r,y),e(r,c),e(c,p),e(p,t),e(t,m),e(t,V),e(t,b),e(c,E),e(c,g),e(g,h),e(h,C),e(h,A),e(r,u),e(r,_),e(_,S)},p(v,y){y&1&&d!==(d=v[0].completed+"")&&K(m,d),y&1&&P!==(P=v[0].size+"")&&K(b,P),y&1&&U!==(U=parseInt(v[0].progress*100)+"")&&K(C,U),y&1&&je(S,"width",parseInt(v[0].progress*100)+"%")},d(v){v&&a(r)}}}function Vt(o){let r,c,p,t,d,m,V,P,b,E,g,h,U,C,A,u,_,S,v,y,q,w,j,T=o[0]&&yt(o);return{c(){r=l("h1"),c=D("Images"),p=k(),t=l("div"),d=l("label"),m=l("span"),V=D("Images"),P=k(),b=l("span"),E=D(kt),g=k(),h=l("label"),U=l("span"),C=D("Worker"),A=k(),u=l("input"),_=k(),T&&T.c(),S=k(),v=l("button"),y=D("Crawl Images"),this.h()},l(x){r=n(x,"H1",{class:!0});var L=i(r);c=N(L,"Images"),L.forEach(a),p=I(x),t=n(x,"DIV",{class:!0});var O=i(t);d=n(O,"LABEL",{class:!0});var H=i(d);m=n(H,"SPAN",{class:!0});var J=i(m);V=N(J,"Images"),J.forEach(a),P=I(H),b=n(H,"SPAN",{});var z=i(b);E=N(z,kt),z.forEach(a),H.forEach(a),g=I(O),h=n(O,"LABEL",{class:!0});var B=i(h);U=n(B,"SPAN",{class:!0});var F=i(U);C=N(F,"Worker"),F.forEach(a),A=I(B),u=n(B,"INPUT",{type:!0,min:!0,max:!0,class:!0}),B.forEach(a),_=I(O),T&&T.l(O),S=I(O),v=n(O,"BUTTON",{class:!0});var W=i(v);y=N(W,"Crawl Images"),W.forEach(a),O.forEach(a),this.h()},h(){s(r,"class","mt-6"),s(m,"class","w-32"),s(d,"class","flex items-center pb-2 mb-2 text-sm space-x-12 md:space-x-24 justify-between border-b border-gray-200 dark:border-slate-600"),s(U,"class","w-32"),s(u,"type","number"),s(u,"min","1"),s(u,"max","1000"),s(u,"class","rounded-lg flex-auto p-2 mr-1 border-2 border-gray-300"),u.required=!0,s(h,"class","flex items-center pb-2 mb-2 text-sm space-x-12 md:space-x-24 justify-between border-b border-gray-200 dark:border-slate-600"),s(v,"class","py-2 px-3 w-40 bg-cyan-500 text-white text-sm font-semibold rounded-md shadow-lg hover:shadow-cyan-500/50 focus:outline-none"),s(t,"class",q="flex shadow-xl rounded-xl p-8 bg-white dark:bg-slate-800 flex-col mt-4 "+(o[2]&&"grayscale pointer-events-none"))},m(x,L){R(x,r,L),e(r,c),R(x,p,L),R(x,t,L),e(t,d),e(d,m),e(m,V),e(d,P),e(d,b),e(b,E),e(t,g),e(t,h),e(h,U),e(U,C),e(h,A),e(h,u),se(u,o[1]),e(t,_),T&&T.m(t,null),e(t,S),e(t,v),e(v,y),w||(j=[G(u,"input",o[5]),G(v,"click",o[3])],w=!0)},p(x,[L]){L&2&&ae(u.value)!==x[1]&&se(u,x[1]),x[0]?T?T.p(x,L):(T=yt(x),T.c(),T.m(t,S)):T&&(T.d(1),T=null),L&4&&q!==(q="flex shadow-xl rounded-xl p-8 bg-white dark:bg-slate-800 flex-col mt-4 "+(x[2]&&"grayscale pointer-events-none"))&&s(t,"class",q)},i:xe,o:xe,d(x){x&&a(r),x&&a(p),x&&a(t),T&&T.d(),w=!1,Le(j)}}}let kt=0;function Ut(o,r,c){let{instance:p}=r,{progress:t={queue:0,progress:0,completed:0,size:0}}=r,d=4,m=!1;const V=async()=>{c(2,m=!0);const E=await(await Ee("POST","instances/crawlImages",null,{instance_id:p.id,worker:d})).json();console.log(E),c(2,m=!1)};function P(){d=ae(this.value),c(1,d)}return o.$$set=b=>{"instance"in b&&c(4,p=b.instance),"progress"in b&&c(0,t=b.progress)},[t,d,m,V,p,P]}class jt extends Be{constructor(r){super(),Ce(this,r,Ut,Vt,Me,{instance:4,progress:0})}}function Bt(o){let r,c,p,t,d,m,V,P,b,E,g,h,U,C,A,u,_,S,v,y,q;return{c(){r=l("h1"),c=D("UMAP"),p=k(),t=l("div"),d=l("label"),m=l("span"),V=D("Neighbours"),P=k(),b=l("input"),E=k(),g=l("label"),h=l("span"),U=D("Min Distance"),C=k(),A=l("input"),u=k(),_=l("button"),S=D("Run Umap"),this.h()},l(w){r=n(w,"H1",{class:!0});var j=i(r);c=N(j,"UMAP"),j.forEach(a),p=I(w),t=n(w,"DIV",{class:!0});var T=i(t);d=n(T,"LABEL",{class:!0});var x=i(d);m=n(x,"SPAN",{class:!0});var L=i(m);V=N(L,"Neighbours"),L.forEach(a),P=I(x),b=n(x,"INPUT",{type:!0,min:!0,max:!0,name:!0,id:!0,class:!0}),x.forEach(a),E=I(T),g=n(T,"LABEL",{class:!0});var O=i(g);h=n(O,"SPAN",{class:!0});var H=i(h);U=N(H,"Min Distance"),H.forEach(a),C=I(O),A=n(O,"INPUT",{type:!0,min:!0,max:!0,name:!0,id:!0,class:!0}),O.forEach(a),u=I(T),_=n(T,"BUTTON",{class:!0});var J=i(_);S=N(J,"Run Umap"),J.forEach(a),T.forEach(a),this.h()},h(){s(r,"class","mt-6"),s(m,"class","w-32"),s(b,"type","number"),s(b,"min","1"),s(b,"max","200"),s(b,"name","neighbours"),s(b,"id","neighbours"),s(b,"class","rounded-lg flex-auto p-2 mr-1 border-2 border-gray-300"),b.required=!0,s(d,"class","flex items-center pb-2 mb-2 text-sm space-x-12 md:space-x-24 justify-between border-b border-gray-200 dark:border-slate-600"),s(h,"class","w-32"),s(A,"type","number"),s(A,"min","0"),s(A,"max","1"),s(A,"name","neighbours"),s(A,"id","neighbours"),s(A,"class","rounded-lg flex-auto p-2 mr-1 border-2 border-gray-300"),A.required=!0,s(g,"class","flex items-center pb-2 mb-2 text-sm space-x-12 md:space-x-24 justify-between border-b border-gray-200 dark:border-slate-600"),s(_,"class","py-2 px-3 w-40 bg-cyan-500 text-white text-sm font-semibold rounded-md shadow-lg hover:shadow-cyan-500/50 focus:outline-none"),s(t,"class",v="flex shadow-xl rounded-xl p-8 bg-white dark:bg-slate-800 flex-col mt-4 "+(o[2]&&"grayscale pointer-events-none"))},m(w,j){R(w,r,j),e(r,c),R(w,p,j),R(w,t,j),e(t,d),e(d,m),e(m,V),e(d,P),e(d,b),se(b,o[0]),e(t,E),e(t,g),e(g,h),e(h,U),e(g,C),e(g,A),se(A,o[1]),e(t,u),e(t,_),e(_,S),y||(q=[G(b,"input",o[5]),G(A,"input",o[6]),G(_,"click",o[3])],y=!0)},p(w,[j]){j&1&&ae(b.value)!==w[0]&&se(b,w[0]),j&2&&ae(A.value)!==w[1]&&se(A,w[1]),j&4&&v!==(v="flex shadow-xl rounded-xl p-8 bg-white dark:bg-slate-800 flex-col mt-4 "+(w[2]&&"grayscale pointer-events-none"))&&s(t,"class",v)},i:xe,o:xe,d(w){w&&a(r),w&&a(p),w&&a(t),y=!1,Le(q)}}}function Ct(o,r,c){let{instance:p}=r,t=15,d=.2,m=!1;const V=async()=>{c(2,m=!0);const g=await(await Ee("POST","instances/makeUmap",null,{instance_id:p.id,n_neighbors:t,min_distance:d})).json();console.log(g),c(2,m=!1)};function P(){t=ae(this.value),c(0,t)}function b(){d=ae(this.value),c(1,d)}return o.$$set=E=>{"instance"in E&&c(4,p=E.instance)},[t,d,m,V,p,P,b]}class Mt extends Be{constructor(r){super(),Ce(this,r,Ct,Bt,Me,{instance:4})}}function Lt(o){let r,c,p=o[0].label+"",t,d,m,V=o[0].status+"",P,b,E,g,h,U,C,A,u=o[0].iiif_url+"",_,S,v,y,q,w,j,T=o[0].id+"",x,L,O,H,J,z,B,F=new Date(o[0].created*1e3)+"",W,le,Q,ne,re,_e,$,te,oe=o[1]?"Connected":"Disconnected",ye,ke,Ie,fe,Z,pe,Oe,qe,me,ze,Fe,be,Re,We,he,He,Ze,ve,Ge,Je,ge,Xe,De,Ne,ie,Pe,ce,Se,de,X,Ye,at;return ie=new At({props:{progress:o[3],instance:o[0]}}),ce=new jt({props:{progress:o[4],instance:o[0]}}),de=new Mt({props:{instance:o[0]}}),{c(){r=l("div"),c=l("h1"),t=D(p),d=k(),m=l("span"),P=D(V),b=k(),E=l("div"),g=l("div"),h=l("p"),U=D("Manifest URL"),C=k(),A=l("div"),_=D(u),S=k(),v=l("div"),y=l("p"),q=D("Id"),w=k(),j=l("div"),x=D(T),L=k(),O=l("div"),H=l("p"),J=D("Created"),z=k(),B=l("div"),W=D(F),le=k(),Q=l("div"),ne=l("p"),re=D("Socket"),_e=k(),$=l("div"),te=l("span"),ye=D(oe),Ie=k(),fe=l("div"),Z=l("div"),pe=l("button"),Oe=D("Make Spritesheets"),qe=k(),me=l("button"),ze=D("Make Metadata"),Fe=k(),be=l("button"),Re=D("Make Features"),We=k(),he=l("button"),He=D("Run All"),Ze=k(),ve=l("button"),Ge=D("Download Zip"),Je=k(),ge=l("button"),Xe=D("Delete"),Ne=k(),Ke(ie.$$.fragment),Pe=k(),Ke(ce.$$.fragment),Se=k(),Ke(de.$$.fragment),this.h()},l(f){r=n(f,"DIV",{class:!0});var M=i(r);c=n(M,"H1",{});var ue=i(c);t=N(ue,p),d=I(ue),m=n(ue,"SPAN",{class:!0});var we=i(m);P=N(we,V),we.forEach(a),ue.forEach(a),M.forEach(a),b=I(f),E=n(f,"DIV",{class:!0});var ee=i(E);g=n(ee,"DIV",{class:!0});var Te=i(g);h=n(Te,"P",{});var lt=i(h);U=N(lt,"Manifest URL"),lt.forEach(a),C=I(Te),A=n(Te,"DIV",{class:!0});var nt=i(A);_=N(nt,u),nt.forEach(a),Te.forEach(a),S=I(ee),v=n(ee,"DIV",{class:!0});var Ae=i(v);y=n(Ae,"P",{});var rt=i(y);q=N(rt,"Id"),rt.forEach(a),w=I(Ae),j=n(Ae,"DIV",{class:!0});var ot=i(j);x=N(ot,T),ot.forEach(a),Ae.forEach(a),L=I(ee),O=n(ee,"DIV",{class:!0});var Ve=i(O);H=n(Ve,"P",{});var it=i(H);J=N(it,"Created"),it.forEach(a),z=I(Ve),B=n(Ve,"DIV",{class:!0});var ct=i(B);W=N(ct,F),ct.forEach(a),Ve.forEach(a),le=I(ee),Q=n(ee,"DIV",{class:!0});var Ue=i(Q);ne=n(Ue,"P",{});var dt=i(ne);re=N(dt,"Socket"),dt.forEach(a),_e=I(Ue),$=n(Ue,"DIV",{class:!0});var ut=i($);te=n(ut,"SPAN",{class:!0});var ft=i(te);ye=N(ft,oe),ft.forEach(a),ut.forEach(a),Ue.forEach(a),ee.forEach(a),Ie=I(f),fe=n(f,"DIV",{class:!0});var pt=i(fe);Z=n(pt,"DIV",{class:!0});var Y=i(Z);pe=n(Y,"BUTTON",{class:!0});var mt=i(pe);Oe=N(mt,"Make Spritesheets"),mt.forEach(a),qe=I(Y),me=n(Y,"BUTTON",{class:!0});var bt=i(me);ze=N(bt,"Make Metadata"),bt.forEach(a),Fe=I(Y),be=n(Y,"BUTTON",{class:!0});var ht=i(be);Re=N(ht,"Make Features"),ht.forEach(a),We=I(Y),he=n(Y,"BUTTON",{class:!0});var vt=i(he);He=N(vt,"Run All"),vt.forEach(a),Ze=I(Y),ve=n(Y,"BUTTON",{class:!0});var gt=i(ve);Ge=N(gt,"Download Zip"),gt.forEach(a),Je=I(Y),ge=n(Y,"BUTTON",{class:!0});var _t=i(ge);Xe=N(_t,"Delete"),_t.forEach(a),Y.forEach(a),pt.forEach(a),Ne=I(f),Qe(ie.$$.fragment,f),Pe=I(f),Qe(ce.$$.fragment,f),Se=I(f),Qe(de.$$.fragment,f),this.h()},h(){s(m,"class","px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-green-100 text-green-800"),s(r,"class","relative "),s(A,"class","flex items-end text-xs"),s(g,"class","flex items-center pb-2 mb-2 text-sm space-x-12 md:space-x-24 justify-between border-b border-gray-200 dark:border-slate-600"),s(j,"class","flex items-end text-xs"),s(v,"class","flex items-center pb-2 mb-2 text-sm space-x-12 md:space-x-24 justify-between border-b border-gray-200 dark:border-slate-600"),s(B,"class","flex items-end text-xs"),s(O,"class","flex items-center pb-2 mb-2 text-sm space-x-12 md:space-x-24 justify-between border-b border-gray-200 dark:border-slate-600"),s(te,"class",ke="px-2 inline-flex text-xs leading-5 font-semibold rounded-full "+(o[1]?"bg-green-100":"bg-red-100")+" text-"+(o[1]?"green-800":"red-800")),s($,"class","flex items-end text-xs"),s(Q,"class","flex items-center pb-2 mb-2 text-sm space-x-12 md:space-x-24 justify-between border-b border-gray-200 dark:border-slate-600"),s(E,"class","flex shadow-xl rounded-xl p-8 bg-white dark:bg-slate-800 flex-col mt-7"),s(pe,"class","py-2 px-3 w-40 bg-cyan-500 text-white text-sm font-semibold rounded-md shadow-lg hover:shadow-cyan-500/50 focus:outline-none"),s(me,"class","py-2 px-3 w-40 bg-cyan-500 text-white text-sm font-semibold rounded-md shadow-lg hover:shadow-cyan-500/50 focus:outline-none"),s(be,"class","py-2 px-3 w-40 bg-cyan-500 text-white text-sm font-semibold rounded-md shadow-lg hover:shadow-cyan-500/50 focus:outline-none"),s(he,"class","py-2 px-3 w-40 bg-cyan-500 text-white text-sm font-semibold rounded-md shadow-lg hover:shadow-cyan-500/50 focus:outline-none"),s(ve,"class","py-2 px-3 w-40 bg-cyan-500 text-white text-sm font-semibold rounded-md shadow-lg hover:shadow-cyan-500/50 focus:outline-none"),s(ge,"class","py-2 px-3 w-32 bg-red-500 text-white text-sm font-semibold rounded-md shadow-lg hover:shadow-red-500/50 focus:outline-none"),s(Z,"class",De="grid gap-4 grid-cols-4 "+(o[2]&&"grayscale pointer-events-none")),s(fe,"class","disabled:opacity-75 shadow-xl rounded-xl p-8 bg-white dark:bg-slate-800 mt-7")},m(f,M){R(f,r,M),e(r,c),e(c,t),e(c,d),e(c,m),e(m,P),R(f,b,M),R(f,E,M),e(E,g),e(g,h),e(h,U),e(g,C),e(g,A),e(A,_),e(E,S),e(E,v),e(v,y),e(y,q),e(v,w),e(v,j),e(j,x),e(E,L),e(E,O),e(O,H),e(H,J),e(O,z),e(O,B),e(B,W),e(E,le),e(E,Q),e(Q,ne),e(ne,re),e(Q,_e),e(Q,$),e($,te),e(te,ye),R(f,Ie,M),R(f,fe,M),e(fe,Z),e(Z,pe),e(pe,Oe),e(Z,qe),e(Z,me),e(me,ze),e(Z,Fe),e(Z,be),e(be,Re),e(Z,We),e(Z,he),e(he,He),e(Z,Ze),e(Z,ve),e(ve,Ge),e(Z,Je),e(Z,ge),e(ge,Xe),R(f,Ne,M),$e(ie,f,M),R(f,Pe,M),$e(ce,f,M),R(f,Se,M),$e(de,f,M),X=!0,Ye||(at=[G(pe,"click",o[5]),G(me,"click",o[6]),G(be,"click",o[7]),G(he,"click",o[8]),G(ve,"click",o[9]),G(ge,"click",o[10])],Ye=!0)},p(f,[M]){(!X||M&1)&&p!==(p=f[0].label+"")&&K(t,p),(!X||M&1)&&V!==(V=f[0].status+"")&&K(P,V),(!X||M&1)&&u!==(u=f[0].iiif_url+"")&&K(_,u),(!X||M&1)&&T!==(T=f[0].id+"")&&K(x,T),(!X||M&1)&&F!==(F=new Date(f[0].created*1e3)+"")&&K(W,F),(!X||M&2)&&oe!==(oe=f[1]?"Connected":"Disconnected")&&K(ye,oe),(!X||M&2&&ke!==(ke="px-2 inline-flex text-xs leading-5 font-semibold rounded-full "+(f[1]?"bg-green-100":"bg-red-100")+" text-"+(f[1]?"green-800":"red-800")))&&s(te,"class",ke),(!X||M&4&&De!==(De="grid gap-4 grid-cols-4 "+(f[2]&&"grayscale pointer-events-none")))&&s(Z,"class",De);const ue={};M&8&&(ue.progress=f[3]),M&1&&(ue.instance=f[0]),ie.$set(ue);const we={};M&16&&(we.progress=f[4]),M&1&&(we.instance=f[0]),ce.$set(we);const ee={};M&1&&(ee.instance=f[0]),de.$set(ee)},i(f){X||(et(ie.$$.fragment,f),et(ce.$$.fragment,f),et(de.$$.fragment,f),X=!0)},o(f){tt(ie.$$.fragment,f),tt(ce.$$.fragment,f),tt(de.$$.fragment,f),X=!1},d(f){f&&a(r),f&&a(b),f&&a(E),f&&a(Ie),f&&a(fe),f&&a(Ne),st(ie,f),f&&a(Pe),st(ce,f),f&&a(Se),st(de,f),Ye=!1,Le(at)}}}const Ot={id:"test",label:"Test Instance",iiif_url:"http://localhost:5000/instances/test",status:"ok"};async function Ht({params:o,fetch:r,session:c,stuff:p}){try{const t=await Ee("get",`instances/${o.id}`);return{status:t.status,props:{instance:t.ok&&await t.json()}}}catch(t){return{status:t.status,props:{error:t.message,instance:Ot}}}}function qt(o,r,c){let{instance:p}=r,t=!1,d=!1,m=null,V=null;const P=new WebSocket(`ws://${wt}:${Dt}/instances/${p.id}/ws`);P.onopen=u=>{console.log("eventSource.onopen",u),c(1,t=!0)},P.onerror=u=>{console.log("eventSource.onerror",u),c(1,t=!1)},P.onmessage=u=>{const _=JSON.parse(u.data);_.type!="ping"&&console.log(_),_.task&&_.task==="crawlCollection"&&c(3,m=_),_.task&&_.task==="crawlImages"&&c(4,V=_)},It(()=>{console.log("It's destroyed"),P.close()});const b=async()=>{await C("makeSpritesheets")},E=async()=>{await C("makeMetadata")},g=async()=>{await C("makeFeatures")},h=async()=>{await C("run")},U=async()=>{await C("makeZip");const u=`${Nt}://${wt}:8000/${p.id}/project.zip`;var _=document.createElement("a");_.href=u,_.setAttribute("download","project.zip"),_.click()},C=async u=>{c(2,d=!0);const S=await(await Ee("GET",`instances/${p.id}/${u}`)).json();return console.log(S),c(2,d=!1),S},A=async()=>{P.close();const u=await Ee("DELETE",`instances/${p.id}`);await u.json(),u.ok&&Pt("/")};return o.$$set=u=>{"instance"in u&&c(0,p=u.instance)},o.$$.update=()=>{o.$$.dirty&1&&console.log(p)},[p,t,d,m,V,b,E,g,h,U,A]}class Zt extends Be{constructor(r){super(),Ce(this,r,qt,Lt,Me,{instance:0})}}export{Zt as default,Ht as load};
