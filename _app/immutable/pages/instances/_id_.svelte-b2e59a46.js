import{S as De,i as Pe,s as Ne,e as i,t as P,k,c,a as d,h as N,d as l,m as I,b as s,f as Qe,g as H,H as e,j as K,W as $,O as W,X as Z,E as ae,T as Ve,w as je,x as Ue,y as Le,q as Be,o as ze,B as Oe,Y as Bt}from"../../chunks/index-ce9f2381.js";import{b as ve,p as pt,d as et,c as mt,a as zt}from"../../chunks/api-c29a56c8.js";import{g as Ot}from"../../chunks/navigation-0e6511d1.js";import{b as Rt}from"../../chunks/paths-396f020f.js";import"../../chunks/singletons-d1fb5791.js";function Tt(o){let t,a,b,f,n=o[0].completed+"",p,S,x=o[0].size+"",r,E,m,g,V=parseInt(o[0].progress*100)+"",y,w,h,_,A;return{c(){t=i("div"),a=i("div"),b=i("div"),f=i("span"),p=P(n),S=P("/"),r=P(x),E=k(),m=i("div"),g=i("span"),y=P(V),w=P("%"),h=k(),_=i("div"),A=i("div"),this.h()},l(v){t=c(v,"DIV",{class:!0});var D=d(t);a=c(D,"DIV",{class:!0});var O=d(a);b=c(O,"DIV",{});var T=d(b);f=c(T,"SPAN",{class:!0});var j=d(f);p=N(j,n),S=N(j,"/"),r=N(j,x),j.forEach(l),T.forEach(l),E=I(O),m=c(O,"DIV",{class:!0});var L=d(m);g=c(L,"SPAN",{class:!0});var U=d(g);y=N(U,V),w=N(U,"%"),U.forEach(l),L.forEach(l),O.forEach(l),h=I(D),_=c(D,"DIV",{class:!0});var z=d(_);A=c(z,"DIV",{style:!0,class:!0}),d(A).forEach(l),z.forEach(l),D.forEach(l),this.h()},h(){s(f,"class","text-xs font-semibold inline-block py-1 px-2 uppercase rounded-full text-green-600 bg-green-200"),s(g,"class","text-xs font-semibold inline-block text-green-600"),s(m,"class","text-right"),s(a,"class","flex mb-2 items-center justify-between"),Qe(A,"width",parseInt(o[0].progress*100)+"%"),s(A,"class","shadow-none flex flex-col text-center whitespace-nowrap text-white justify-center bg-green-500"),s(_,"class","overflow-hidden h-2 mb-4 text-xs flex rounded bg-green-200"),s(t,"class","relative mt-2")},m(v,D){H(v,t,D),e(t,a),e(a,b),e(b,f),e(f,p),e(f,S),e(f,r),e(a,E),e(a,m),e(m,g),e(g,y),e(g,w),e(t,h),e(t,_),e(_,A)},p(v,D){D&1&&n!==(n=v[0].completed+"")&&K(p,n),D&1&&x!==(x=v[0].size+"")&&K(r,x),D&1&&V!==(V=parseInt(v[0].progress*100)+"")&&K(y,V),D&1&&Qe(A,"width",parseInt(v[0].progress*100)+"%")},d(v){v&&l(t)}}}function Mt(o){let t,a,b,f,n,p,S,x,r,E,m,g,V,y,w,h,_,A,v,D,O,T,j,L,U,z,q,F,G,C=o[0]&&Tt(o);return{c(){t=i("div"),a=i("h1"),b=P("Collection"),f=k(),n=i("label"),p=i("span"),S=P("Manifests"),x=k(),r=i("span"),E=P(jt),m=k(),g=i("label"),V=i("span"),y=P("Worker"),w=k(),h=i("input"),_=k(),A=i("label"),v=i("span"),D=P("Crawl depth"),O=k(),T=i("input"),j=k(),C&&C.c(),L=k(),U=i("button"),z=P("Run"),this.h()},l(M){t=c(M,"DIV",{class:!0});var R=d(t);a=c(R,"H1",{class:!0});var te=d(a);b=N(te,"Collection"),te.forEach(l),f=I(R),n=c(R,"LABEL",{class:!0});var ne=d(n);p=c(ne,"SPAN",{class:!0});var Q=d(p);S=N(Q,"Manifests"),Q.forEach(l),x=I(ne),r=c(ne,"SPAN",{});var re=d(r);E=N(re,jt),re.forEach(l),ne.forEach(l),m=I(R),g=c(R,"LABEL",{class:!0});var oe=d(g);V=c(oe,"SPAN",{class:!0});var ke=d(V);y=N(ke,"Worker"),ke.forEach(l),w=I(oe),h=c(oe,"INPUT",{type:!0,min:!0,max:!0,class:!0}),oe.forEach(l),_=I(R),A=c(R,"LABEL",{class:!0});var ee=d(A);v=c(ee,"SPAN",{class:!0});var se=d(v);D=N(se,"Crawl depth"),se.forEach(l),O=I(ee),T=c(ee,"INPUT",{type:!0,min:!0,max:!0,class:!0}),ee.forEach(l),j=I(R),C&&C.l(R),L=I(R),U=c(R,"BUTTON",{class:!0});var ie=d(U);z=N(ie,"Run"),ie.forEach(l),R.forEach(l),this.h()},h(){s(a,"class","mb-6"),s(p,"class","w-32"),s(n,"class","flex items-center pb-2 mb-2 text-sm space-x-12 md:space-x-24 justify-between border-b border-gray-200 dark:border-slate-600"),s(V,"class","w-32"),s(h,"type","number"),s(h,"min","1"),s(h,"max","1000"),s(h,"class","rounded-lg flex-auto p-2 mr-1 border-2 border-gray-300"),h.required=!0,s(g,"class","flex items-center pb-2 mb-2 text-sm space-x-12 md:space-x-24 justify-between border-b border-gray-200 dark:border-slate-600"),s(v,"class","w-32"),s(T,"type","number"),s(T,"min","0"),s(T,"max","1000"),s(T,"class","rounded-lg flex-auto p-2 mr-1 border-2 border-gray-300"),T.required=!0,s(A,"class","flex items-center pb-2 mb-2 text-sm space-x-12 md:space-x-24 justify-between border-b border-gray-200 dark:border-slate-600"),s(U,"class","py-2 px-3 w-40 self-end bg-cyan-500 text-white text-sm font-semibold rounded-md shadow-lg hover:shadow-cyan-500/50 focus:outline-none"),s(t,"class",q="flex shadow-xl rounded-xl p-8 bg-white dark:bg-slate-800 flex-col mt-4 "+(o[3]&&"grayscale pointer-events-none"))},m(M,R){H(M,t,R),e(t,a),e(a,b),e(t,f),e(t,n),e(n,p),e(p,S),e(n,x),e(n,r),e(r,E),e(t,m),e(t,g),e(g,V),e(V,y),e(g,w),e(g,h),$(h,o[2]),e(t,_),e(t,A),e(A,v),e(v,D),e(A,O),e(A,T),$(T,o[1]),e(t,j),C&&C.m(t,null),e(t,L),e(t,U),e(U,z),F||(G=[W(h,"input",o[6]),W(T,"input",o[7]),W(U,"click",o[4])],F=!0)},p(M,[R]){R&4&&Z(h.value)!==M[2]&&$(h,M[2]),R&2&&Z(T.value)!==M[1]&&$(T,M[1]),M[0]?C?C.p(M,R):(C=Tt(M),C.c(),C.m(t,L)):C&&(C.d(1),C=null),R&8&&q!==(q="flex shadow-xl rounded-xl p-8 bg-white dark:bg-slate-800 flex-col mt-4 "+(M[3]&&"grayscale pointer-events-none"))&&s(t,"class",q)},i:ae,o:ae,d(M){M&&l(t),C&&C.d(),F=!1,Ve(G)}}}let jt=0;function Ct(o,t,a){let{instance:b}=t,{progress:f={queue:0,progress:0,completed:0,size:0}}=t,n=0,p=4,S=!1;const x=async()=>{a(3,S=!0);const g=await(await ve("POST","instances/crawlCollection",null,{instance_id:b.id,worker:p,depth:n})).json();console.log(g),a(3,S=!1)};function r(){p=Z(this.value),a(2,p)}function E(){n=Z(this.value),a(1,n)}return o.$$set=m=>{"instance"in m&&a(5,b=m.instance),"progress"in m&&a(0,f=m.progress)},[f,n,p,S,x,b,r,E]}class qt extends De{constructor(t){super(),Pe(this,t,Ct,Mt,Ne,{instance:5,progress:0})}}function Ut(o){let t,a,b,f,n=o[0].completed+"",p,S,x=o[0].size+"",r,E,m,g,V=parseInt(o[0].progress*100)+"",y,w,h,_,A;return{c(){t=i("div"),a=i("div"),b=i("div"),f=i("span"),p=P(n),S=P("/"),r=P(x),E=k(),m=i("div"),g=i("span"),y=P(V),w=P("%"),h=k(),_=i("div"),A=i("div"),this.h()},l(v){t=c(v,"DIV",{class:!0});var D=d(t);a=c(D,"DIV",{class:!0});var O=d(a);b=c(O,"DIV",{});var T=d(b);f=c(T,"SPAN",{class:!0});var j=d(f);p=N(j,n),S=N(j,"/"),r=N(j,x),j.forEach(l),T.forEach(l),E=I(O),m=c(O,"DIV",{class:!0});var L=d(m);g=c(L,"SPAN",{class:!0});var U=d(g);y=N(U,V),w=N(U,"%"),U.forEach(l),L.forEach(l),O.forEach(l),h=I(D),_=c(D,"DIV",{class:!0});var z=d(_);A=c(z,"DIV",{style:!0,class:!0}),d(A).forEach(l),z.forEach(l),D.forEach(l),this.h()},h(){s(f,"class","text-xs font-semibold inline-block py-1 px-2 uppercase rounded-full text-green-600 bg-green-200"),s(g,"class","text-xs font-semibold inline-block text-green-600"),s(m,"class","text-right"),s(a,"class","flex mb-2 items-center justify-between"),Qe(A,"width",parseInt(o[0].progress*100)+"%"),s(A,"class","shadow-none flex flex-col text-center whitespace-nowrap text-white justify-center bg-green-500"),s(_,"class","overflow-hidden h-2 mb-4 text-xs flex rounded bg-green-200"),s(t,"class","relative mt-2")},m(v,D){H(v,t,D),e(t,a),e(a,b),e(b,f),e(f,p),e(f,S),e(f,r),e(a,E),e(a,m),e(m,g),e(g,y),e(g,w),e(t,h),e(t,_),e(_,A)},p(v,D){D&1&&n!==(n=v[0].completed+"")&&K(p,n),D&1&&x!==(x=v[0].size+"")&&K(r,x),D&1&&V!==(V=parseInt(v[0].progress*100)+"")&&K(y,V),D&1&&Qe(A,"width",parseInt(v[0].progress*100)+"%")},d(v){v&&l(t)}}}function Ft(o){let t,a,b,f,n,p,S,x,r,E,m,g,V,y,w,h,_,A,v,D,O,T,j,L=o[0]&&Ut(o);return{c(){t=i("div"),a=i("h1"),b=P("Images"),f=k(),n=i("label"),p=i("span"),S=P("Images"),x=k(),r=i("span"),E=P(Lt),m=k(),g=i("label"),V=i("span"),y=P("Worker"),w=k(),h=i("input"),_=k(),L&&L.c(),A=k(),v=i("button"),D=P("Run"),this.h()},l(U){t=c(U,"DIV",{class:!0});var z=d(t);a=c(z,"H1",{class:!0});var q=d(a);b=N(q,"Images"),q.forEach(l),f=I(z),n=c(z,"LABEL",{class:!0});var F=d(n);p=c(F,"SPAN",{class:!0});var G=d(p);S=N(G,"Images"),G.forEach(l),x=I(F),r=c(F,"SPAN",{});var C=d(r);E=N(C,Lt),C.forEach(l),F.forEach(l),m=I(z),g=c(z,"LABEL",{class:!0});var M=d(g);V=c(M,"SPAN",{class:!0});var R=d(V);y=N(R,"Worker"),R.forEach(l),w=I(M),h=c(M,"INPUT",{type:!0,min:!0,max:!0,class:!0}),M.forEach(l),_=I(z),L&&L.l(z),A=I(z),v=c(z,"BUTTON",{class:!0});var te=d(v);D=N(te,"Run"),te.forEach(l),z.forEach(l),this.h()},h(){s(a,"class","mb-6"),s(p,"class","w-32"),s(n,"class","flex items-center pb-2 mb-2 text-sm space-x-12 md:space-x-24 justify-between border-b border-gray-200 dark:border-slate-600"),s(V,"class","w-32"),s(h,"type","number"),s(h,"min","1"),s(h,"max","1000"),s(h,"class","rounded-lg flex-auto p-2 mr-1 border-2 border-gray-300"),h.required=!0,s(g,"class","flex items-center pb-2 mb-2 text-sm space-x-12 md:space-x-24 justify-between border-b border-gray-200 dark:border-slate-600"),s(v,"class","py-2 px-3 w-40 self-end bg-cyan-500 text-white text-sm font-semibold rounded-md shadow-lg hover:shadow-cyan-500/50 focus:outline-none"),s(t,"class",O="flex shadow-xl rounded-xl p-8 bg-white dark:bg-slate-800 flex-col mt-4 "+(o[2]&&"grayscale pointer-events-none"))},m(U,z){H(U,t,z),e(t,a),e(a,b),e(t,f),e(t,n),e(n,p),e(p,S),e(n,x),e(n,r),e(r,E),e(t,m),e(t,g),e(g,V),e(V,y),e(g,w),e(g,h),$(h,o[1]),e(t,_),L&&L.m(t,null),e(t,A),e(t,v),e(v,D),T||(j=[W(h,"input",o[5]),W(v,"click",o[3])],T=!0)},p(U,[z]){z&2&&Z(h.value)!==U[1]&&$(h,U[1]),U[0]?L?L.p(U,z):(L=Ut(U),L.c(),L.m(t,A)):L&&(L.d(1),L=null),z&4&&O!==(O="flex shadow-xl rounded-xl p-8 bg-white dark:bg-slate-800 flex-col mt-4 "+(U[2]&&"grayscale pointer-events-none"))&&s(t,"class",O)},i:ae,o:ae,d(U){U&&l(t),L&&L.d(),T=!1,Ve(j)}}}let Lt=0;function Ht(o,t,a){let{instance:b}=t,{progress:f={queue:0,progress:0,completed:0,size:0}}=t,n=4,p=!1;const S=async()=>{a(2,p=!0);const E=await(await ve("POST","instances/crawlImages",null,{instance_id:b.id,worker:n})).json();console.log(E),a(2,p=!1)};function x(){n=Z(this.value),a(1,n)}return o.$$set=r=>{"instance"in r&&a(4,b=r.instance),"progress"in r&&a(0,f=r.progress)},[f,n,p,S,b,x]}class Wt extends De{constructor(t){super(),Pe(this,t,Ht,Ft,Ne,{instance:4,progress:0})}}function $t(o){let t,a,b,f,n,p,S,x,r,E,m,g,V,y,w,h,_,A,v,D,O;return{c(){t=i("div"),a=i("h1"),b=P("UMAP"),f=k(),n=i("label"),p=i("span"),S=P("Neighbours"),x=k(),r=i("input"),E=k(),m=i("label"),g=i("span"),V=P("Min Distance"),y=k(),w=i("input"),h=k(),_=i("button"),A=P("Run"),this.h()},l(T){t=c(T,"DIV",{class:!0});var j=d(t);a=c(j,"H1",{class:!0});var L=d(a);b=N(L,"UMAP"),L.forEach(l),f=I(j),n=c(j,"LABEL",{class:!0});var U=d(n);p=c(U,"SPAN",{class:!0});var z=d(p);S=N(z,"Neighbours"),z.forEach(l),x=I(U),r=c(U,"INPUT",{type:!0,min:!0,max:!0,name:!0,id:!0,class:!0}),U.forEach(l),E=I(j),m=c(j,"LABEL",{class:!0});var q=d(m);g=c(q,"SPAN",{class:!0});var F=d(g);V=N(F,"Min Distance"),F.forEach(l),y=I(q),w=c(q,"INPUT",{type:!0,min:!0,max:!0,name:!0,id:!0,class:!0}),q.forEach(l),h=I(j),_=c(j,"BUTTON",{class:!0});var G=d(_);A=N(G,"Run"),G.forEach(l),j.forEach(l),this.h()},h(){s(a,"class","mb-4"),s(p,"class","w-32"),s(r,"type","number"),s(r,"min","1"),s(r,"max","200"),s(r,"name","neighbours"),s(r,"id","neighbours"),s(r,"class","rounded-lg flex-auto p-2 mr-1 border-2 border-gray-300"),r.required=!0,s(n,"class","flex items-center pb-2 mb-2 text-sm space-x-12 md:space-x-24 justify-between border-b border-gray-200 dark:border-slate-600"),s(g,"class","w-32"),s(w,"type","number"),s(w,"min","0"),s(w,"max","1"),s(w,"name","neighbours"),s(w,"id","neighbours"),s(w,"class","rounded-lg flex-auto p-2 mr-1 border-2 border-gray-300"),w.required=!0,s(m,"class","flex items-center pb-2 mb-2 text-sm space-x-12 md:space-x-24 justify-between border-b border-gray-200 dark:border-slate-600"),s(_,"class","py-2 px-3 w-40 self-end bg-cyan-500 text-white text-sm font-semibold rounded-md shadow-lg hover:shadow-cyan-500/50 focus:outline-none"),s(t,"class",v="flex shadow-xl rounded-xl p-8 bg-white dark:bg-slate-800 flex-col mt-4 "+(o[2]&&"grayscale pointer-events-none"))},m(T,j){H(T,t,j),e(t,a),e(a,b),e(t,f),e(t,n),e(n,p),e(p,S),e(n,x),e(n,r),$(r,o[0]),e(t,E),e(t,m),e(m,g),e(g,V),e(m,y),e(m,w),$(w,o[1]),e(t,h),e(t,_),e(_,A),D||(O=[W(r,"input",o[5]),W(w,"input",o[6]),W(_,"click",o[3])],D=!0)},p(T,[j]){j&1&&Z(r.value)!==T[0]&&$(r,T[0]),j&2&&Z(w.value)!==T[1]&&$(w,T[1]),j&4&&v!==(v="flex shadow-xl rounded-xl p-8 bg-white dark:bg-slate-800 flex-col mt-4 "+(T[2]&&"grayscale pointer-events-none"))&&s(t,"class",v)},i:ae,o:ae,d(T){T&&l(t),D=!1,Ve(O)}}}function Zt(o,t,a){let{instance:b}=t,f=15,n=.2,p=!1;const S=async()=>{a(2,p=!0);const m=await(await ve("POST","instances/makeUmap",null,{instance_id:b.id,n_neighbors:f,min_distance:n})).json();console.log(m),a(2,p=!1)};function x(){f=Z(this.value),a(0,f)}function r(){n=Z(this.value),a(1,n)}return o.$$set=E=>{"instance"in E&&a(4,b=E.instance)},[f,n,p,S,b,x,r]}class Jt extends De{constructor(t){super(),Pe(this,t,Zt,$t,Ne,{instance:4})}}function Xt(o){let t,a,b,f,n,p,S,x,r,E,m,g,V,y,w;return{c(){t=i("div"),a=i("h1"),b=P("Feature Extraction"),f=k(),n=i("label"),p=i("span"),S=P("batchSize"),x=k(),r=i("input"),E=k(),m=i("button"),g=P("Run"),this.h()},l(h){t=c(h,"DIV",{class:!0});var _=d(t);a=c(_,"H1",{class:!0});var A=d(a);b=N(A,"Feature Extraction"),A.forEach(l),f=I(_),n=c(_,"LABEL",{class:!0});var v=d(n);p=c(v,"SPAN",{class:!0});var D=d(p);S=N(D,"batchSize"),D.forEach(l),x=I(v),r=c(v,"INPUT",{type:!0,min:!0,max:!0,name:!0,id:!0,class:!0}),v.forEach(l),E=I(_),m=c(_,"BUTTON",{class:!0});var O=d(m);g=N(O,"Run"),O.forEach(l),_.forEach(l),this.h()},h(){s(a,"class","mb-4"),s(p,"class","w-32"),s(r,"type","number"),s(r,"min","1"),s(r,"max","1024"),s(r,"name","batchSize"),s(r,"id","batchSize"),s(r,"class","rounded-lg flex-auto p-2 mr-1 border-2 border-gray-300"),r.required=!0,s(n,"class","flex items-center pb-2 mb-2 text-sm space-x-12 md:space-x-24 justify-between border-b border-gray-200 dark:border-slate-600"),s(m,"class","py-2 px-3 w-40 self-end bg-cyan-500 text-white text-sm font-semibold rounded-md shadow-lg hover:shadow-cyan-500/50 focus:outline-none"),s(t,"class",V="flex shadow-xl rounded-xl p-8 bg-white dark:bg-slate-800 flex-col mt-4 "+(o[1]&&"grayscale pointer-events-none"))},m(h,_){H(h,t,_),e(t,a),e(a,b),e(t,f),e(t,n),e(n,p),e(p,S),e(n,x),e(n,r),$(r,o[0]),e(t,E),e(t,m),e(m,g),y||(w=[W(r,"input",o[4]),W(m,"click",o[2])],y=!0)},p(h,[_]){_&1&&Z(r.value)!==h[0]&&$(r,h[0]),_&2&&V!==(V="flex shadow-xl rounded-xl p-8 bg-white dark:bg-slate-800 flex-col mt-4 "+(h[1]&&"grayscale pointer-events-none"))&&s(t,"class",V)},i:ae,o:ae,d(h){h&&l(t),y=!1,Ve(w)}}}function Yt(o,t,a){let{instance:b}=t,f=64,n=!1;const p=async()=>{a(1,n=!0);const r=await(await ve("POST","instances/makeFeatures",null,{instance_id:b.id,batchSize:f})).json();console.log(r),a(1,n=!1)};function S(){f=Z(this.value),a(0,f)}return o.$$set=x=>{"instance"in x&&a(3,b=x.instance)},[f,n,p,b,S]}class Gt extends De{constructor(t){super(),Pe(this,t,Yt,Xt,Ne,{instance:3})}}function Kt(o){let t,a,b,f,n,p,S,x,r,E,m,g,V,y,w;return{c(){t=i("div"),a=i("h1"),b=P("Spritesheets"),f=k(),n=i("label"),p=i("span"),S=P("spriteSize"),x=k(),r=i("input"),E=k(),m=i("button"),g=P("Run"),this.h()},l(h){t=c(h,"DIV",{class:!0});var _=d(t);a=c(_,"H1",{class:!0});var A=d(a);b=N(A,"Spritesheets"),A.forEach(l),f=I(_),n=c(_,"LABEL",{class:!0});var v=d(n);p=c(v,"SPAN",{class:!0});var D=d(p);S=N(D,"spriteSize"),D.forEach(l),x=I(v),r=c(v,"INPUT",{type:!0,min:!0,max:!0,name:!0,id:!0,class:!0}),v.forEach(l),E=I(_),m=c(_,"BUTTON",{class:!0});var O=d(m);g=N(O,"Run"),O.forEach(l),_.forEach(l),this.h()},h(){s(a,"class","mb-6"),s(p,"class","w-32"),s(r,"type","number"),s(r,"min","1"),s(r,"max","512"),s(r,"name","spriteSize"),s(r,"id","spriteSize"),s(r,"class","rounded-lg flex-auto p-2 mr-1 border-2 border-gray-300"),r.required=!0,s(n,"class","grayscale pointer-events-none flex items-center pb-2 mb-2 text-sm space-x-12 md:space-x-24 justify-between border-b border-gray-200 dark:border-slate-600"),s(m,"class","py-2 px-3 w-40 self-end bg-cyan-500 text-white text-sm font-semibold rounded-md shadow-lg hover:shadow-cyan-500/50 focus:outline-none"),s(t,"class",V="flex shadow-xl rounded-xl p-8 bg-white dark:bg-slate-800 flex-col mt-4 "+(o[1]&&"grayscale pointer-events-none"))},m(h,_){H(h,t,_),e(t,a),e(a,b),e(t,f),e(t,n),e(n,p),e(p,S),e(n,x),e(n,r),$(r,o[0]),e(t,E),e(t,m),e(m,g),y||(w=[W(r,"input",o[4]),W(m,"click",o[2])],y=!0)},p(h,[_]){_&1&&Z(r.value)!==h[0]&&$(r,h[0]),_&2&&V!==(V="flex shadow-xl rounded-xl p-8 bg-white dark:bg-slate-800 flex-col mt-4 "+(h[1]&&"grayscale pointer-events-none"))&&s(t,"class",V)},i:ae,o:ae,d(h){h&&l(t),y=!1,Ve(w)}}}function Qt(o,t,a){let{instance:b}=t,f=128,n=!1;const p=async()=>{a(1,n=!0);const r=await(await ve("POST","instances/makeSpritesheets",null,{instance_id:b.id})).json();console.log(r),a(1,n=!1)};function S(){f=Z(this.value),a(0,f)}return o.$$set=x=>{"instance"in x&&a(3,b=x.instance)},[f,n,p,b,S]}class es extends De{constructor(t){super(),Pe(this,t,Qt,Kt,Ne,{instance:3})}}function ts(o){let t,a,b=o[0].label+"",f,n,p,S=o[0].status+"",x,r,E,m,g,V,y,w,h=o[0].iiif_url+"",_,A,v,D,O,T,j,L=o[0].id+"",U,z,q,F,G,C,M,R=new Date(o[0].created*1e3)+"",te,ne,Q,re,oe,ke,ee,se,ie=o[1]?"Connected":"Disconnected",Re,Me,tt,ce,Ae,st,at,Ie,le,lt,Ce,qe,ge,J,_e,nt,rt,we,ot,it,xe,ct,dt,Ee,ut,Fe,He,de,We,ue,$e,fe,Ze,pe,Je,me,X,ft,bt;return de=new qt({props:{progress:o[3],instance:o[0]}}),ue=new Wt({props:{progress:o[4],instance:o[0]}}),fe=new es({props:{instance:o[0]}}),pe=new Gt({props:{instance:o[0]}}),me=new Jt({props:{instance:o[0]}}),{c(){t=i("div"),a=i("h1"),f=P(b),n=k(),p=i("span"),x=P(S),r=k(),E=i("div"),m=i("div"),g=i("p"),V=P("Manifest URL"),y=k(),w=i("div"),_=P(h),A=k(),v=i("div"),D=i("p"),O=P("Id"),T=k(),j=i("div"),U=P(L),z=k(),q=i("div"),F=i("p"),G=P("Created"),C=k(),M=i("div"),te=P(R),ne=k(),Q=i("div"),re=i("p"),oe=P("Socket"),ke=k(),ee=i("div"),se=i("span"),Re=P(ie),tt=k(),ce=i("div"),Ae=i("p"),st=P("Vikus Viewer"),at=k(),Ie=i("div"),le=i("a"),lt=P("Open"),qe=k(),ge=i("div"),J=i("div"),_e=i("button"),nt=P("Run All"),rt=k(),we=i("button"),ot=P("Download Zip"),it=k(),xe=i("button"),ct=P("Make Metadata"),dt=k(),Ee=i("button"),ut=P("Delete"),He=k(),je(de.$$.fragment),We=k(),je(ue.$$.fragment),$e=k(),je(fe.$$.fragment),Ze=k(),je(pe.$$.fragment),Je=k(),je(me.$$.fragment),this.h()},l(u){t=c(u,"DIV",{class:!0});var B=d(t);a=c(B,"H1",{});var be=d(a);f=N(be,b),n=I(be),p=c(be,"SPAN",{class:!0});var Se=d(p);x=N(Se,S),Se.forEach(l),be.forEach(l),B.forEach(l),r=I(u),E=c(u,"DIV",{class:!0});var Y=d(E);m=c(Y,"DIV",{class:!0});var ye=d(m);g=c(ye,"P",{});var Te=d(g);V=N(Te,"Manifest URL"),Te.forEach(l),y=I(ye),w=c(ye,"DIV",{class:!0});var ht=d(w);_=N(ht,h),ht.forEach(l),ye.forEach(l),A=I(Y),v=c(Y,"DIV",{class:!0});var Xe=d(v);D=c(Xe,"P",{});var vt=d(D);O=N(vt,"Id"),vt.forEach(l),T=I(Xe),j=c(Xe,"DIV",{class:!0});var gt=d(j);U=N(gt,L),gt.forEach(l),Xe.forEach(l),z=I(Y),q=c(Y,"DIV",{class:!0});var Ye=d(q);F=c(Ye,"P",{});var _t=d(F);G=N(_t,"Created"),_t.forEach(l),C=I(Ye),M=c(Ye,"DIV",{class:!0});var wt=d(M);te=N(wt,R),wt.forEach(l),Ye.forEach(l),ne=I(Y),Q=c(Y,"DIV",{class:!0});var Ge=d(Q);re=c(Ge,"P",{});var xt=d(re);oe=N(xt,"Socket"),xt.forEach(l),ke=I(Ge),ee=c(Ge,"DIV",{class:!0});var Et=d(ee);se=c(Et,"SPAN",{class:!0});var yt=d(se);Re=N(yt,ie),yt.forEach(l),Et.forEach(l),Ge.forEach(l),tt=I(Y),ce=c(Y,"DIV",{class:!0});var Ke=d(ce);Ae=c(Ke,"P",{});var kt=d(Ae);st=N(kt,"Vikus Viewer"),kt.forEach(l),at=I(Ke),Ie=c(Ke,"DIV",{class:!0});var It=d(Ie);le=c(It,"A",{target:!0,class:!0,href:!0});var St=d(le);lt=N(St,"Open"),St.forEach(l),It.forEach(l),Ke.forEach(l),Y.forEach(l),qe=I(u),ge=c(u,"DIV",{class:!0});var Dt=d(ge);J=c(Dt,"DIV",{class:!0});var he=d(J);_e=c(he,"BUTTON",{class:!0});var Pt=d(_e);nt=N(Pt,"Run All"),Pt.forEach(l),rt=I(he),we=c(he,"BUTTON",{class:!0});var Nt=d(we);ot=N(Nt,"Download Zip"),Nt.forEach(l),it=I(he),xe=c(he,"BUTTON",{class:!0});var Vt=d(xe);ct=N(Vt,"Make Metadata"),Vt.forEach(l),dt=I(he),Ee=c(he,"BUTTON",{class:!0});var At=d(Ee);ut=N(At,"Delete"),At.forEach(l),he.forEach(l),Dt.forEach(l),He=I(u),Ue(de.$$.fragment,u),We=I(u),Ue(ue.$$.fragment,u),$e=I(u),Ue(fe.$$.fragment,u),Ze=I(u),Ue(pe.$$.fragment,u),Je=I(u),Ue(me.$$.fragment,u),this.h()},h(){s(p,"class","px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-green-100 text-green-800"),s(t,"class","relative "),s(w,"class","flex items-end text-xs"),s(m,"class","flex items-center pb-2 mb-2 text-sm space-x-12 md:space-x-24 justify-between border-b border-gray-200 dark:border-slate-600"),s(j,"class","flex items-end text-xs"),s(v,"class","flex items-center pb-2 mb-2 text-sm space-x-12 md:space-x-24 justify-between border-b border-gray-200 dark:border-slate-600"),s(M,"class","flex items-end text-xs"),s(q,"class","flex items-center pb-2 mb-2 text-sm space-x-12 md:space-x-24 justify-between border-b border-gray-200 dark:border-slate-600"),s(se,"class",Me="px-2 inline-flex text-xs leading-5 font-semibold rounded-full "+(o[1]?"bg-green-100":"bg-red-100")+" text-"+(o[1]?"green-800":"red-800")),s(ee,"class","flex items-end text-xs"),s(Q,"class","flex items-center pb-2 mb-2 text-sm space-x-12 md:space-x-24 justify-between border-b border-gray-200 dark:border-slate-600"),s(le,"target","_blank"),s(le,"class","font-semibold rounded-full px-2 bg-blue-100"),s(le,"href",Ce=pt+"://"+et+":"+mt+"/viewer/?config=../data/"+o[0].id+"/config.json"),s(Ie,"class","flex items-end text-xs"),s(ce,"class","flex items-center pb-2 mb-2 text-sm space-x-12 md:space-x-24 justify-between border-b border-gray-200 dark:border-slate-600"),s(E,"class","flex shadow-xl rounded-xl p-8 bg-white dark:bg-slate-800 flex-col mt-7"),s(_e,"class","py-2 px-3 w-40 bg-cyan-500 text-white text-sm font-semibold rounded-md shadow-lg hover:shadow-cyan-500/50 focus:outline-none"),s(we,"class","py-2 px-3 w-40 bg-cyan-500 text-white text-sm font-semibold rounded-md shadow-lg hover:shadow-cyan-500/50 focus:outline-none"),s(xe,"class","py-2 px-3 w-40 bg-cyan-500 text-white text-sm font-semibold rounded-md shadow-lg hover:shadow-cyan-500/50 focus:outline-none"),s(Ee,"class","py-2 px-3 w-32 bg-red-500 text-white text-sm font-semibold rounded-md shadow-lg hover:shadow-red-500/50 focus:outline-none"),s(J,"class",Fe="grid gap-4 grid-cols-4 "+(o[2]&&"grayscale pointer-events-none")),s(ge,"class","disabled:opacity-75 shadow-xl rounded-xl p-8 bg-white dark:bg-slate-800 mt-7")},m(u,B){H(u,t,B),e(t,a),e(a,f),e(a,n),e(a,p),e(p,x),H(u,r,B),H(u,E,B),e(E,m),e(m,g),e(g,V),e(m,y),e(m,w),e(w,_),e(E,A),e(E,v),e(v,D),e(D,O),e(v,T),e(v,j),e(j,U),e(E,z),e(E,q),e(q,F),e(F,G),e(q,C),e(q,M),e(M,te),e(E,ne),e(E,Q),e(Q,re),e(re,oe),e(Q,ke),e(Q,ee),e(ee,se),e(se,Re),e(E,tt),e(E,ce),e(ce,Ae),e(Ae,st),e(ce,at),e(ce,Ie),e(Ie,le),e(le,lt),H(u,qe,B),H(u,ge,B),e(ge,J),e(J,_e),e(_e,nt),e(J,rt),e(J,we),e(we,ot),e(J,it),e(J,xe),e(xe,ct),e(J,dt),e(J,Ee),e(Ee,ut),H(u,He,B),Le(de,u,B),H(u,We,B),Le(ue,u,B),H(u,$e,B),Le(fe,u,B),H(u,Ze,B),Le(pe,u,B),H(u,Je,B),Le(me,u,B),X=!0,ft||(bt=[W(_e,"click",o[5]),W(we,"click",o[6]),W(xe,"click",o[9]),W(Ee,"click",o[8])],ft=!0)},p(u,[B]){(!X||B&1)&&b!==(b=u[0].label+"")&&K(f,b),(!X||B&1)&&S!==(S=u[0].status+"")&&K(x,S),(!X||B&1)&&h!==(h=u[0].iiif_url+"")&&K(_,h),(!X||B&1)&&L!==(L=u[0].id+"")&&K(U,L),(!X||B&1)&&R!==(R=new Date(u[0].created*1e3)+"")&&K(te,R),(!X||B&2)&&ie!==(ie=u[1]?"Connected":"Disconnected")&&K(Re,ie),(!X||B&2&&Me!==(Me="px-2 inline-flex text-xs leading-5 font-semibold rounded-full "+(u[1]?"bg-green-100":"bg-red-100")+" text-"+(u[1]?"green-800":"red-800")))&&s(se,"class",Me),(!X||B&1&&Ce!==(Ce=pt+"://"+et+":"+mt+"/viewer/?config=../data/"+u[0].id+"/config.json"))&&s(le,"href",Ce),(!X||B&4&&Fe!==(Fe="grid gap-4 grid-cols-4 "+(u[2]&&"grayscale pointer-events-none")))&&s(J,"class",Fe);const be={};B&8&&(be.progress=u[3]),B&1&&(be.instance=u[0]),de.$set(be);const Se={};B&16&&(Se.progress=u[4]),B&1&&(Se.instance=u[0]),ue.$set(Se);const Y={};B&1&&(Y.instance=u[0]),fe.$set(Y);const ye={};B&1&&(ye.instance=u[0]),pe.$set(ye);const Te={};B&1&&(Te.instance=u[0]),me.$set(Te)},i(u){X||(Be(de.$$.fragment,u),Be(ue.$$.fragment,u),Be(fe.$$.fragment,u),Be(pe.$$.fragment,u),Be(me.$$.fragment,u),X=!0)},o(u){ze(de.$$.fragment,u),ze(ue.$$.fragment,u),ze(fe.$$.fragment,u),ze(pe.$$.fragment,u),ze(me.$$.fragment,u),X=!1},d(u){u&&l(t),u&&l(r),u&&l(E),u&&l(qe),u&&l(ge),u&&l(He),Oe(de,u),u&&l(We),Oe(ue,u),u&&l($e),Oe(fe,u),u&&l(Ze),Oe(pe,u),u&&l(Je),Oe(me,u),ft=!1,Ve(bt)}}}const ss={id:"test",label:"Test Instance",iiif_url:"http://localhost:5000/instances/test",status:"ok"};async function cs({params:o,fetch:t,session:a,stuff:b}){try{const f=await ve("get",`instances/${o.id}`);return{status:f.status,props:{instance:f.ok&&await f.json()}}}catch(f){return{status:f.status,props:{error:f.message,instance:ss}}}}function as(o,t,a){let{instance:b}=t,f=!1,n=!1,p=null,S=null;const x=new WebSocket(`ws://${et}:${zt}/instances/${b.id}/ws`);x.onopen=y=>{console.log("eventSource.onopen",y),a(1,f=!0)},x.onerror=y=>{console.log("eventSource.onerror",y),a(1,f=!1)},x.onmessage=y=>{const w=JSON.parse(y.data);w.type!="ping"&&console.log(w),w.task&&w.task==="crawlCollection"&&a(3,p=w),w.task&&w.task==="crawlImages"&&a(4,S=w)},Bt(()=>{console.log("It's destroyed"),x.close()});const r=async()=>{await m("run")},E=async()=>{await m("makeZip");const y=`${pt}://${et}:${mt}/data/${b.id}/project.zip`;var w=document.createElement("a");w.href=y,w.setAttribute("download","project.zip"),w.click()},m=async y=>{a(2,n=!0);const h=await(await ve("POST",`instances/${y}`,null,{instance_id:b.id})).json();return console.log(h),a(2,n=!1),h},g=async()=>{x.close();const y=await ve("DELETE",`instances/${b.id}`);await y.json(),y.ok&&Ot(Rt)},V=()=>m("makeMetadata");return o.$$set=y=>{"instance"in y&&a(0,b=y.instance)},o.$$.update=()=>{o.$$.dirty&1&&console.log(b)},[b,f,n,p,S,r,E,m,g,V]}class ds extends De{constructor(t){super(),Pe(this,t,as,ts,Ne,{instance:0})}}export{ds as default,cs as load};
